2026-02-13 15:38:57,038 - retention_system - INFO - Configuration loaded successfully
2026-02-13 15:38:57,039 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 15:38:57,039 - retention_system - INFO - Version: 1.0.0
2026-02-13 15:38:57,041 - retention_system - INFO - Starting: Data Validation
2026-02-13 15:38:57,116 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 15:38:58,065 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 15:38:58,065 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 15:38:58,918 - retention_system - INFO - 
================================================================================
2026-02-13 15:38:58,919 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 15:38:58,919 - retention_system - INFO - ================================================================================
2026-02-13 15:38:58,919 - retention_system - INFO - Total Checks: 16
2026-02-13 15:38:58,926 - retention_system - INFO -   - Errors: 0
2026-02-13 15:38:58,926 - retention_system - INFO -   - Warnings: 5
2026-02-13 15:38:58,927 - retention_system - INFO - ================================================================================

2026-02-13 15:38:58,934 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 15:38:58,940 - retention_system - INFO - Completed: Data Validation in 1.90 seconds
2026-02-13 15:38:58,941 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 15:38:58,941 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 15:38:59,004 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 15:38:59,974 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 15:38:59,975 - retention_system - INFO - ================================================================================
2026-02-13 15:38:59,975 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 15:38:59,975 - retention_system - INFO - ================================================================================
2026-02-13 15:38:59,975 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 15:39:00,240 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 15:39:00,241 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 15:39:00,292 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 15:39:00,294 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 15:39:00,389 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 15:39:00,390 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 15:39:00,941 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 15:39:00,941 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 15:39:00,942 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 15:39:01,165 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 15:39:01,166 - retention_system - INFO - 
================================================================================
2026-02-13 15:39:01,166 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 15:39:01,167 - retention_system - INFO - ================================================================================
2026-02-13 15:39:01,167 - retention_system - INFO - Initial rows: 541,909
2026-02-13 15:39:01,167 - retention_system - INFO - Final rows: 163,246
2026-02-13 15:39:01,167 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 15:39:01,168 - retention_system - INFO - 
Breakdown:
2026-02-13 15:39:01,168 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 15:39:01,168 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 15:39:01,168 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 15:39:01,169 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 15:39:01,169 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 15:39:01,169 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 15:39:01,169 - retention_system - INFO - 
Data characteristics:
2026-02-13 15:39:01,170 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 15:39:01,170 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 15:39:01,170 - retention_system - INFO - ================================================================================

2026-02-13 15:39:01,347 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 15:39:01,349 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 15:39:01,352 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 15:39:01,352 - retention_system - INFO - Completed: Data Cleaning in 2.41 seconds
2026-02-13 15:39:01,353 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 15:39:01,354 - retention_system - INFO - Generating snapshot dates...
2026-02-13 15:39:01,357 - retention_system - ERROR - Error generating snapshots: Invalid frequency: M. Failed to parse with error message: ValueError("'M' is no longer supported for offsets. Please use 'ME' instead.")
2026-02-13 15:39:01,358 - retention_system - INFO - Creating single snapshot using max date
2026-02-13 15:39:01,360 - retention_system - INFO - 
Processing snapshot 1/1: 2011-12-10
2026-02-13 15:39:01,360 - retention_system - INFO - ================================================================================
2026-02-13 15:39:01,361 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-12-10
2026-02-13 15:39:01,361 - retention_system - INFO - ================================================================================
2026-02-13 15:39:01,387 - retention_system - INFO - Observation window: 2011-06-13 to 2011-12-10
2026-02-13 15:39:01,387 - retention_system - INFO - Transactions in window: 72,418
2026-02-13 15:39:01,389 - retention_system - INFO - Unique customers: 1,914
2026-02-13 15:39:01,390 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 15:39:01,426 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 15:39:02,455 - retention_system - INFO - Completed: Feature Engineering in 1.10 seconds
2026-02-13 15:51:13,637 - retention_system - INFO - Configuration loaded successfully
2026-02-13 15:51:13,638 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 15:51:13,638 - retention_system - INFO - Version: 1.0.0
2026-02-13 15:51:13,639 - retention_system - INFO - Starting: Data Validation
2026-02-13 15:51:13,713 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 15:51:14,785 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 15:51:14,786 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 15:51:14,786 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 15:51:14,797 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 15:51:14,798 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 15:51:14,800 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 15:51:14,801 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 15:51:14,987 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 15:51:14,992 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 15:51:14,997 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 15:51:15,004 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 15:51:15,006 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 15:51:15,025 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 15:51:15,138 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 15:51:15,388 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 15:51:15,390 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 15:51:15,403 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 15:51:15,516 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 15:51:15,517 - retention_system - INFO - 
================================================================================
2026-02-13 15:51:15,517 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 15:51:15,518 - retention_system - INFO - ================================================================================
2026-02-13 15:51:15,518 - retention_system - INFO - Total Checks: 16
2026-02-13 15:51:15,518 - retention_system - INFO - Passed: 11 ✓
2026-02-13 15:51:15,518 - retention_system - INFO - Failed: 5 ✗
2026-02-13 15:51:15,518 - retention_system - INFO -   - Errors: 0
2026-02-13 15:51:15,519 - retention_system - INFO -   - Warnings: 5
2026-02-13 15:51:15,519 - retention_system - INFO - ================================================================================

2026-02-13 15:51:15,522 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 15:51:15,523 - retention_system - INFO - ✓ Data validation passed
2026-02-13 15:51:15,524 - retention_system - INFO - Completed: Data Validation in 1.88 seconds
2026-02-13 15:51:15,527 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 15:51:15,527 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 15:51:15,594 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 15:51:16,769 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 15:51:16,769 - retention_system - INFO - ================================================================================
2026-02-13 15:51:16,769 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 15:51:16,770 - retention_system - INFO - ================================================================================
2026-02-13 15:51:16,770 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 15:51:16,894 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 15:51:17,106 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 15:51:17,117 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 15:51:17,118 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 15:51:17,125 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 15:51:17,127 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 15:51:17,162 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 15:51:17,162 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 15:51:17,163 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 15:51:17,202 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 15:51:17,275 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 15:51:17,276 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 15:51:17,277 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 15:51:17,326 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 15:51:17,889 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 15:51:17,893 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 15:51:17,893 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 15:51:17,895 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 15:51:17,898 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 15:51:17,951 - retention_system - INFO - ✓ Extracted date components
2026-02-13 15:51:18,109 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 15:51:18,110 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 15:51:18,111 - retention_system - INFO - 
================================================================================
2026-02-13 15:51:18,111 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 15:51:18,112 - retention_system - INFO - ================================================================================
2026-02-13 15:51:18,112 - retention_system - INFO - Initial rows: 541,909
2026-02-13 15:51:18,112 - retention_system - INFO - Final rows: 163,246
2026-02-13 15:51:18,112 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 15:51:18,113 - retention_system - INFO - 
Breakdown:
2026-02-13 15:51:18,113 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 15:51:18,113 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 15:51:18,114 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 15:51:18,114 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 15:51:18,114 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 15:51:18,114 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 15:51:18,115 - retention_system - INFO - 
Data characteristics:
2026-02-13 15:51:18,115 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 15:51:18,115 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 15:51:18,116 - retention_system - INFO - ================================================================================

2026-02-13 15:51:18,295 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 15:51:18,298 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 15:51:18,300 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 15:51:18,300 - retention_system - INFO - Completed: Data Cleaning in 2.77 seconds
2026-02-13 15:51:18,302 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 15:51:18,303 - retention_system - INFO - Generating snapshot dates...
2026-02-13 15:51:18,306 - retention_system - ERROR - Error generating snapshots: Invalid frequency: M. Failed to parse with error message: ValueError("'M' is no longer supported for offsets. Please use 'ME' instead.")
2026-02-13 15:51:18,307 - retention_system - INFO - Creating single snapshot using max date
2026-02-13 15:51:18,308 - retention_system - INFO - 
Processing snapshot 1/1: 2011-12-10
2026-02-13 15:51:18,309 - retention_system - INFO - ================================================================================
2026-02-13 15:51:18,309 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-12-10
2026-02-13 15:51:18,309 - retention_system - INFO - ================================================================================
2026-02-13 15:51:18,335 - retention_system - INFO - Observation window: 2011-06-13 to 2011-12-10
2026-02-13 15:51:18,335 - retention_system - INFO - Transactions in window: 72,418
2026-02-13 15:51:18,337 - retention_system - INFO - Unique customers: 1,914
2026-02-13 15:51:18,338 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 15:51:18,366 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 15:51:18,367 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 15:51:22,144 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 15:51:22,150 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 15:51:22,209 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 15:51:22,210 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 15:51:22,891 - retention_system - INFO - Completed: Feature Engineering in 4.59 seconds
2026-02-13 16:07:44,043 - retention_system - INFO - Configuration loaded successfully
2026-02-13 16:07:44,044 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 16:07:44,045 - retention_system - INFO - Version: 1.0.0
2026-02-13 16:07:44,046 - retention_system - INFO - Starting: Data Validation
2026-02-13 16:07:44,153 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:07:45,105 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 16:07:45,106 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 16:07:45,106 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 16:07:45,115 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 16:07:45,117 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 16:07:45,119 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 16:07:45,122 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 16:07:45,287 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 16:07:45,291 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 16:07:45,295 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 16:07:45,302 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 16:07:45,305 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 16:07:45,324 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 16:07:45,451 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 16:07:45,642 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 16:07:45,644 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 16:07:45,663 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 16:07:45,750 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 16:07:45,750 - retention_system - INFO - 
================================================================================
2026-02-13 16:07:45,751 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 16:07:45,751 - retention_system - INFO - ================================================================================
2026-02-13 16:07:45,752 - retention_system - INFO - Total Checks: 16
2026-02-13 16:07:45,752 - retention_system - INFO - Passed: 11 ✓
2026-02-13 16:07:45,753 - retention_system - INFO - Failed: 5 ✗
2026-02-13 16:07:45,753 - retention_system - INFO -   - Errors: 0
2026-02-13 16:07:45,753 - retention_system - INFO -   - Warnings: 5
2026-02-13 16:07:45,754 - retention_system - INFO - ================================================================================

2026-02-13 16:07:45,757 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 16:07:45,758 - retention_system - INFO - ✓ Data validation passed
2026-02-13 16:07:45,759 - retention_system - INFO - Completed: Data Validation in 1.71 seconds
2026-02-13 16:07:45,760 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 16:07:45,760 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 16:07:45,821 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:07:46,737 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 16:07:46,738 - retention_system - INFO - ================================================================================
2026-02-13 16:07:46,738 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 16:07:46,739 - retention_system - INFO - ================================================================================
2026-02-13 16:07:46,739 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 16:07:46,814 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 16:07:46,965 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 16:07:46,974 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 16:07:46,975 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 16:07:46,982 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 16:07:46,984 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 16:07:47,014 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 16:07:47,014 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 16:07:47,015 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 16:07:47,043 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 16:07:47,096 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 16:07:47,096 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 16:07:47,097 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 16:07:47,136 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 16:07:47,604 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 16:07:47,607 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 16:07:47,608 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 16:07:47,609 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 16:07:47,614 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 16:07:47,659 - retention_system - INFO - ✓ Extracted date components
2026-02-13 16:07:47,821 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 16:07:47,821 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 16:07:47,822 - retention_system - INFO - 
================================================================================
2026-02-13 16:07:47,822 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 16:07:47,822 - retention_system - INFO - ================================================================================
2026-02-13 16:07:47,823 - retention_system - INFO - Initial rows: 541,909
2026-02-13 16:07:47,823 - retention_system - INFO - Final rows: 163,246
2026-02-13 16:07:47,823 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 16:07:47,823 - retention_system - INFO - 
Breakdown:
2026-02-13 16:07:47,824 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 16:07:47,824 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 16:07:47,824 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 16:07:47,824 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 16:07:47,825 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 16:07:47,825 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 16:07:47,825 - retention_system - INFO - 
Data characteristics:
2026-02-13 16:07:47,825 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 16:07:47,825 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 16:07:47,826 - retention_system - INFO - ================================================================================

2026-02-13 16:07:48,022 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 16:07:48,024 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 16:07:48,026 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 16:07:48,027 - retention_system - INFO - Completed: Data Cleaning in 2.27 seconds
2026-02-13 16:07:48,028 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 16:07:48,029 - retention_system - INFO - Generating snapshot dates...
2026-02-13 16:07:48,031 - retention_system - ERROR - Error generating snapshots: Invalid frequency: M. Failed to parse with error message: ValueError("'M' is no longer supported for offsets. Please use 'ME' instead.")
2026-02-13 16:07:48,032 - retention_system - INFO - Creating single snapshot using max date
2026-02-13 16:07:48,034 - retention_system - INFO - 
Processing snapshot 1/1: 2011-12-10
2026-02-13 16:07:48,034 - retention_system - INFO - ================================================================================
2026-02-13 16:07:48,035 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-12-10
2026-02-13 16:07:48,035 - retention_system - INFO - ================================================================================
2026-02-13 16:07:48,059 - retention_system - INFO - Observation window: 2011-06-13 to 2011-12-10
2026-02-13 16:07:48,059 - retention_system - INFO - Transactions in window: 72,418
2026-02-13 16:07:48,062 - retention_system - INFO - Unique customers: 1,914
2026-02-13 16:07:48,062 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 16:07:48,091 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 16:07:48,092 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 16:07:50,837 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 16:07:50,842 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 16:07:50,903 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 16:07:50,904 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 16:07:51,395 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 16:07:51,396 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 16:07:53,182 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 16:07:53,270 - retention_system - INFO - 
✓ Created 36 features for 72,418 customers
2026-02-13 16:07:53,273 - retention_system - INFO - 
✓ Total feature rows: 72,418
2026-02-13 16:07:53,274 - retention_system - INFO - ✓ Total features: 36
2026-02-13 16:07:53,274 - retention_system - INFO - Completed: Feature Engineering in 5.25 seconds
2026-02-13 16:07:53,275 - retention_system - INFO - Starting: Feature Store Creation
2026-02-13 16:07:53,305 - retention_system - INFO - Completed: Feature Store Creation in 0.03 seconds
2026-02-13 16:11:40,321 - retention_system - INFO - Configuration loaded successfully
2026-02-13 16:11:40,321 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 16:11:40,322 - retention_system - INFO - Version: 1.0.0
2026-02-13 16:11:40,323 - retention_system - INFO - Starting: Data Validation
2026-02-13 16:11:40,402 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:11:41,795 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 16:11:41,796 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 16:11:41,797 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 16:11:41,811 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 16:11:41,813 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 16:11:41,815 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 16:11:41,818 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 16:11:42,001 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 16:11:42,005 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 16:11:42,010 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 16:11:42,017 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 16:11:42,019 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 16:11:42,036 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 16:11:42,136 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 16:11:42,306 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 16:11:42,308 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 16:11:42,318 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 16:11:42,404 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 16:11:42,404 - retention_system - INFO - 
================================================================================
2026-02-13 16:11:42,405 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 16:11:42,405 - retention_system - INFO - ================================================================================
2026-02-13 16:11:42,405 - retention_system - INFO - Total Checks: 16
2026-02-13 16:11:42,405 - retention_system - INFO - Passed: 11 ✓
2026-02-13 16:11:42,406 - retention_system - INFO - Failed: 5 ✗
2026-02-13 16:11:42,406 - retention_system - INFO -   - Errors: 0
2026-02-13 16:11:42,406 - retention_system - INFO -   - Warnings: 5
2026-02-13 16:11:42,406 - retention_system - INFO - ================================================================================

2026-02-13 16:11:42,410 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 16:11:42,410 - retention_system - INFO - ✓ Data validation passed
2026-02-13 16:11:42,411 - retention_system - INFO - Completed: Data Validation in 2.09 seconds
2026-02-13 16:11:42,412 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 16:11:42,412 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 16:11:42,473 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:11:43,416 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 16:11:43,417 - retention_system - INFO - ================================================================================
2026-02-13 16:11:43,417 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 16:11:43,417 - retention_system - INFO - ================================================================================
2026-02-13 16:11:43,418 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 16:11:43,492 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 16:11:43,644 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 16:11:43,654 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 16:11:43,654 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 16:11:43,660 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 16:11:43,662 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 16:11:43,690 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 16:11:43,690 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 16:11:43,691 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 16:11:43,720 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 16:11:43,776 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 16:11:43,777 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 16:11:43,778 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 16:11:43,817 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 16:11:44,252 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 16:11:44,256 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 16:11:44,256 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 16:11:44,257 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 16:11:44,262 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 16:11:44,308 - retention_system - INFO - ✓ Extracted date components
2026-02-13 16:11:44,453 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 16:11:44,454 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 16:11:44,455 - retention_system - INFO - 
================================================================================
2026-02-13 16:11:44,455 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 16:11:44,455 - retention_system - INFO - ================================================================================
2026-02-13 16:11:44,455 - retention_system - INFO - Initial rows: 541,909
2026-02-13 16:11:44,456 - retention_system - INFO - Final rows: 163,246
2026-02-13 16:11:44,456 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 16:11:44,456 - retention_system - INFO - 
Breakdown:
2026-02-13 16:11:44,456 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 16:11:44,457 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 16:11:44,457 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 16:11:44,457 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 16:11:44,457 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 16:11:44,458 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 16:11:44,458 - retention_system - INFO - 
Data characteristics:
2026-02-13 16:11:44,458 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 16:11:44,458 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 16:11:44,458 - retention_system - INFO - ================================================================================

2026-02-13 16:11:44,620 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 16:11:44,621 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 16:11:44,622 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 16:11:44,624 - retention_system - INFO - Completed: Data Cleaning in 2.21 seconds
2026-02-13 16:11:44,625 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 16:11:44,625 - retention_system - INFO - Generating snapshot dates...
2026-02-13 16:11:44,627 - retention_system - ERROR - Error generating snapshots: Invalid frequency: M. Failed to parse with error message: ValueError("'M' is no longer supported for offsets. Please use 'ME' instead.")
2026-02-13 16:11:44,628 - retention_system - INFO - Creating single snapshot using max date
2026-02-13 16:11:44,630 - retention_system - INFO - 
Processing snapshot 1/1: 2011-12-10
2026-02-13 16:11:44,630 - retention_system - INFO - ================================================================================
2026-02-13 16:11:44,630 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-12-10
2026-02-13 16:11:44,631 - retention_system - INFO - ================================================================================
2026-02-13 16:11:44,655 - retention_system - INFO - Observation window: 2011-06-13 to 2011-12-10
2026-02-13 16:11:44,655 - retention_system - INFO - Transactions in window: 72,418
2026-02-13 16:11:44,658 - retention_system - INFO - Unique customers: 1,914
2026-02-13 16:11:44,659 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 16:11:44,685 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 16:11:44,685 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 16:11:45,638 - retention_system - INFO - Completed: Feature Engineering in 1.01 seconds
2026-02-13 16:12:19,162 - retention_system - INFO - Configuration loaded successfully
2026-02-13 16:12:19,164 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 16:12:19,164 - retention_system - INFO - Version: 1.0.0
2026-02-13 16:12:19,165 - retention_system - INFO - Starting: Data Validation
2026-02-13 16:12:19,268 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:12:20,120 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 16:12:20,121 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 16:12:20,121 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 16:12:20,241 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 16:12:20,266 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 16:12:20,266 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 16:12:20,267 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 16:12:20,405 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 16:12:20,411 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 16:12:20,419 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 16:12:20,579 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 16:12:20,583 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 16:12:20,623 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 16:12:20,800 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 16:12:21,073 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 16:12:21,076 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 16:12:21,093 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 16:12:21,177 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 16:12:21,179 - retention_system - INFO - 
================================================================================
2026-02-13 16:12:21,179 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 16:12:21,180 - retention_system - INFO - ================================================================================
2026-02-13 16:12:21,181 - retention_system - INFO - Total Checks: 16
2026-02-13 16:12:21,181 - retention_system - INFO - Passed: 11 ✓
2026-02-13 16:12:21,181 - retention_system - INFO - Failed: 5 ✗
2026-02-13 16:12:21,182 - retention_system - INFO -   - Errors: 0
2026-02-13 16:12:21,182 - retention_system - INFO -   - Warnings: 5
2026-02-13 16:12:21,182 - retention_system - INFO - ================================================================================

2026-02-13 16:12:21,188 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 16:12:21,189 - retention_system - INFO - ✓ Data validation passed
2026-02-13 16:12:21,189 - retention_system - INFO - Completed: Data Validation in 2.02 seconds
2026-02-13 16:12:21,192 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 16:12:21,192 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 16:12:21,285 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:12:22,304 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 16:12:22,307 - retention_system - INFO - ================================================================================
2026-02-13 16:12:22,310 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 16:12:22,326 - retention_system - INFO - ================================================================================
2026-02-13 16:12:22,342 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 16:12:22,525 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 16:12:22,988 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 16:12:23,064 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 16:12:23,066 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 16:12:23,148 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 16:12:23,150 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 16:12:23,240 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 16:12:23,241 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 16:12:23,246 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 16:12:23,321 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 16:12:23,432 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 16:12:23,433 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 16:12:23,441 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 16:12:23,547 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 16:12:23,933 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 16:12:23,939 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 16:12:23,940 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 16:12:23,947 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 16:12:23,966 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 16:12:24,059 - retention_system - INFO - ✓ Extracted date components
2026-02-13 16:12:24,065 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 16:12:24,066 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 16:12:24,071 - retention_system - INFO - 
================================================================================
2026-02-13 16:12:24,071 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 16:12:24,073 - retention_system - INFO - ================================================================================
2026-02-13 16:12:24,073 - retention_system - INFO - Initial rows: 541,909
2026-02-13 16:12:24,074 - retention_system - INFO - Final rows: 163,246
2026-02-13 16:12:24,075 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 16:12:24,075 - retention_system - INFO - 
Breakdown:
2026-02-13 16:12:24,075 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 16:12:24,076 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 16:12:24,076 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 16:12:24,076 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 16:12:24,077 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 16:12:24,077 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 16:12:24,077 - retention_system - INFO - 
Data characteristics:
2026-02-13 16:12:24,078 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 16:12:24,078 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 16:12:24,079 - retention_system - INFO - ================================================================================

2026-02-13 16:12:24,082 - retention_system - INFO - Completed: Data Cleaning in 2.89 seconds
2026-02-13 16:13:41,359 - retention_system - INFO - Configuration loaded successfully
2026-02-13 16:13:41,360 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 16:13:41,361 - retention_system - INFO - Version: 1.0.0
2026-02-13 16:13:41,362 - retention_system - INFO - Starting: Data Validation
2026-02-13 16:13:41,430 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:13:42,055 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 16:13:42,056 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 16:13:42,056 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 16:13:42,161 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 16:13:42,185 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 16:13:42,186 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 16:13:42,186 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 16:13:42,293 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 16:13:42,300 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 16:13:42,308 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 16:13:42,425 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 16:13:42,427 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 16:13:42,450 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 16:13:42,573 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 16:13:42,700 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 16:13:42,702 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 16:13:42,713 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 16:13:42,770 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 16:13:42,771 - retention_system - INFO - 
================================================================================
2026-02-13 16:13:42,772 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 16:13:42,772 - retention_system - INFO - ================================================================================
2026-02-13 16:13:42,772 - retention_system - INFO - Total Checks: 16
2026-02-13 16:13:42,773 - retention_system - INFO - Passed: 11 ✓
2026-02-13 16:13:42,773 - retention_system - INFO - Failed: 5 ✗
2026-02-13 16:13:42,773 - retention_system - INFO -   - Errors: 0
2026-02-13 16:13:42,774 - retention_system - INFO -   - Warnings: 5
2026-02-13 16:13:42,774 - retention_system - INFO - ================================================================================

2026-02-13 16:13:42,777 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 16:13:42,777 - retention_system - INFO - ✓ Data validation passed
2026-02-13 16:13:42,777 - retention_system - INFO - Completed: Data Validation in 1.42 seconds
2026-02-13 16:13:42,779 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 16:13:42,779 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 16:13:42,845 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 16:13:43,490 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 16:13:43,490 - retention_system - INFO - ================================================================================
2026-02-13 16:13:43,491 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 16:13:43,491 - retention_system - INFO - ================================================================================
2026-02-13 16:13:43,491 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 16:13:43,565 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 16:13:43,815 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 16:13:43,840 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 16:13:43,841 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 16:13:43,881 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 16:13:43,882 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 16:13:43,927 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 16:13:43,928 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 16:13:43,930 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 16:13:43,964 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 16:13:44,012 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 16:13:44,013 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 16:13:44,016 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 16:13:44,060 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 16:13:44,310 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 16:13:44,313 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 16:13:44,314 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 16:13:44,317 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 16:13:44,324 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 16:13:44,383 - retention_system - INFO - ✓ Extracted date components
2026-02-13 16:13:44,390 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 16:13:44,391 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 16:13:44,394 - retention_system - INFO - 
================================================================================
2026-02-13 16:13:44,394 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 16:13:44,395 - retention_system - INFO - ================================================================================
2026-02-13 16:13:44,395 - retention_system - INFO - Initial rows: 541,909
2026-02-13 16:13:44,395 - retention_system - INFO - Final rows: 163,246
2026-02-13 16:13:44,396 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 16:13:44,396 - retention_system - INFO - 
Breakdown:
2026-02-13 16:13:44,396 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 16:13:44,396 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 16:13:44,397 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 16:13:44,397 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 16:13:44,397 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 16:13:44,398 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 16:13:44,398 - retention_system - INFO - 
Data characteristics:
2026-02-13 16:13:44,398 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 16:13:44,398 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 16:13:44,399 - retention_system - INFO - ================================================================================

2026-02-13 16:13:45,059 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 16:13:45,068 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 16:13:45,070 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 16:13:45,070 - retention_system - INFO - Completed: Data Cleaning in 2.29 seconds
2026-02-13 16:13:45,072 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 16:13:45,072 - retention_system - INFO - Generating snapshot dates...
2026-02-13 16:13:45,089 - retention_system - INFO - Generated 14 snapshot dates
2026-02-13 16:13:45,090 - retention_system - INFO - First snapshot: 2010-07-31
2026-02-13 16:13:45,091 - retention_system - INFO - Last snapshot: 2011-08-31
2026-02-13 16:13:45,091 - retention_system - INFO - 
Processing snapshot 1/14: 2010-07-31
2026-02-13 16:13:45,092 - retention_system - INFO - ================================================================================
2026-02-13 16:13:45,093 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-07-31
2026-02-13 16:13:45,093 - retention_system - INFO - ================================================================================
2026-02-13 16:13:45,104 - retention_system - INFO - Observation window: 2010-02-01 to 2010-07-31
2026-02-13 16:13:45,104 - retention_system - INFO - Transactions in window: 8,592
2026-02-13 16:13:45,105 - retention_system - INFO - Unique customers: 352
2026-02-13 16:13:45,106 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 16:13:45,135 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 16:13:45,136 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 16:13:45,369 - retention_system - INFO - Completed: Feature Engineering in 0.30 seconds
2026-02-13 17:09:08,052 - retention_system - INFO - Configuration loaded successfully
2026-02-13 17:09:08,053 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 17:09:08,054 - retention_system - INFO - Version: 1.0.0
2026-02-13 17:09:08,055 - retention_system - INFO - Starting: Data Validation
2026-02-13 17:09:08,135 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 17:09:08,880 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 17:09:08,880 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 17:09:08,881 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 17:09:08,994 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 17:09:09,033 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 17:09:09,035 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 17:09:09,036 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 17:09:09,174 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 17:09:09,178 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 17:09:09,185 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 17:09:09,299 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 17:09:09,301 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 17:09:09,324 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 17:09:09,464 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 17:09:09,602 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 17:09:09,605 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 17:09:09,617 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 17:09:09,685 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 17:09:09,685 - retention_system - INFO - 
================================================================================
2026-02-13 17:09:09,686 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 17:09:09,686 - retention_system - INFO - ================================================================================
2026-02-13 17:09:09,686 - retention_system - INFO - Total Checks: 16
2026-02-13 17:09:09,687 - retention_system - INFO - Passed: 11 ✓
2026-02-13 17:09:09,687 - retention_system - INFO - Failed: 5 ✗
2026-02-13 17:09:09,687 - retention_system - INFO -   - Errors: 0
2026-02-13 17:09:09,688 - retention_system - INFO -   - Warnings: 5
2026-02-13 17:09:09,688 - retention_system - INFO - ================================================================================

2026-02-13 17:09:09,692 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 17:09:09,692 - retention_system - INFO - ✓ Data validation passed
2026-02-13 17:09:09,693 - retention_system - INFO - Completed: Data Validation in 1.64 seconds
2026-02-13 17:09:09,695 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 17:09:09,696 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 17:09:09,767 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 17:09:10,521 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 17:09:10,521 - retention_system - INFO - ================================================================================
2026-02-13 17:09:10,522 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 17:09:10,522 - retention_system - INFO - ================================================================================
2026-02-13 17:09:10,522 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 17:09:10,616 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 17:09:10,901 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 17:09:10,934 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 17:09:10,935 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 17:09:10,982 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 17:09:10,984 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 17:09:11,038 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 17:09:11,038 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 17:09:11,042 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 17:09:11,087 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 17:09:11,155 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 17:09:11,156 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 17:09:11,163 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 17:09:11,236 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 17:09:11,516 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 17:09:11,519 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 17:09:11,520 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 17:09:11,525 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 17:09:11,536 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 17:09:11,626 - retention_system - INFO - ✓ Extracted date components
2026-02-13 17:09:11,636 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 17:09:11,636 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 17:09:11,641 - retention_system - INFO - 
================================================================================
2026-02-13 17:09:11,642 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 17:09:11,642 - retention_system - INFO - ================================================================================
2026-02-13 17:09:11,643 - retention_system - INFO - Initial rows: 541,909
2026-02-13 17:09:11,643 - retention_system - INFO - Final rows: 163,246
2026-02-13 17:09:11,644 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 17:09:11,644 - retention_system - INFO - 
Breakdown:
2026-02-13 17:09:11,645 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 17:09:11,645 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 17:09:11,646 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 17:09:11,646 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 17:09:11,646 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 17:09:11,647 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 17:09:11,647 - retention_system - INFO - 
Data characteristics:
2026-02-13 17:09:11,648 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 17:09:11,649 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 17:09:11,649 - retention_system - INFO - ================================================================================

2026-02-13 17:09:11,911 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 17:09:11,924 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 17:09:11,926 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 17:09:11,927 - retention_system - INFO - Completed: Data Cleaning in 2.23 seconds
2026-02-13 17:09:11,928 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 17:09:11,929 - retention_system - INFO - Generating snapshot dates...
2026-02-13 17:09:11,935 - retention_system - INFO - Generated 14 snapshot dates
2026-02-13 17:09:11,935 - retention_system - INFO - First snapshot: 2010-07-31
2026-02-13 17:09:11,935 - retention_system - INFO - Last snapshot: 2011-08-31
2026-02-13 17:09:11,936 - retention_system - INFO - 
Processing snapshot 1/14: 2010-07-31
2026-02-13 17:09:11,936 - retention_system - INFO - ================================================================================
2026-02-13 17:09:11,936 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-07-31
2026-02-13 17:09:11,937 - retention_system - INFO - ================================================================================
2026-02-13 17:09:11,943 - retention_system - INFO - Observation window: 2010-02-01 to 2010-07-31
2026-02-13 17:09:11,944 - retention_system - INFO - Transactions in window: 8,592
2026-02-13 17:09:11,945 - retention_system - INFO - Unique customers: 352
2026-02-13 17:09:11,945 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 17:09:11,962 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 17:09:11,963 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 17:09:12,193 - retention_system - INFO - Completed: Feature Engineering in 0.27 seconds
2026-02-13 18:25:09,156 - retention_system - INFO - Configuration loaded successfully
2026-02-13 18:25:09,157 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 18:25:09,159 - retention_system - INFO - Version: 1.0.0
2026-02-13 18:25:09,161 - retention_system - INFO - Starting: Data Validation
2026-02-13 18:25:09,337 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 18:25:10,143 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 18:25:10,144 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 18:25:10,145 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 18:25:10,349 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 18:25:10,412 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 18:25:10,415 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 18:25:10,417 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 18:25:10,608 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 18:25:10,612 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 18:25:10,617 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 18:25:10,779 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 18:25:10,783 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 18:25:10,822 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 18:25:10,996 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 18:25:11,167 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 18:25:11,170 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 18:25:11,184 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 18:25:11,278 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 18:25:11,279 - retention_system - INFO - 
================================================================================
2026-02-13 18:25:11,280 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 18:25:11,281 - retention_system - INFO - ================================================================================
2026-02-13 18:25:11,282 - retention_system - INFO - Total Checks: 16
2026-02-13 18:25:11,283 - retention_system - INFO - Passed: 11 ✓
2026-02-13 18:25:11,283 - retention_system - INFO - Failed: 5 ✗
2026-02-13 18:25:11,284 - retention_system - INFO -   - Errors: 0
2026-02-13 18:25:11,285 - retention_system - INFO -   - Warnings: 5
2026-02-13 18:25:11,286 - retention_system - INFO - ================================================================================

2026-02-13 18:25:11,295 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 18:25:11,296 - retention_system - INFO - ✓ Data validation passed
2026-02-13 18:25:11,299 - retention_system - INFO - Completed: Data Validation in 2.14 seconds
2026-02-13 18:25:11,301 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 18:25:11,302 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 18:25:11,434 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 18:25:12,241 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 18:25:12,242 - retention_system - INFO - ================================================================================
2026-02-13 18:25:12,242 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 18:25:12,243 - retention_system - INFO - ================================================================================
2026-02-13 18:25:12,243 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 18:25:12,339 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 18:25:12,711 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 18:25:12,744 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 18:25:12,744 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 18:25:12,799 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 18:25:12,801 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 18:25:12,862 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 18:25:12,862 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 18:25:12,866 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 18:25:12,916 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 18:25:12,998 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 18:25:12,999 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 18:25:13,006 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 18:25:13,111 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 18:25:13,425 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 18:25:13,430 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 18:25:13,430 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 18:25:13,435 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 18:25:13,448 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 18:25:13,545 - retention_system - INFO - ✓ Extracted date components
2026-02-13 18:25:13,558 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 18:25:13,559 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 18:25:13,564 - retention_system - INFO - 
================================================================================
2026-02-13 18:25:13,565 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 18:25:13,566 - retention_system - INFO - ================================================================================
2026-02-13 18:25:13,567 - retention_system - INFO - Initial rows: 541,909
2026-02-13 18:25:13,568 - retention_system - INFO - Final rows: 163,246
2026-02-13 18:25:13,568 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 18:25:13,569 - retention_system - INFO - 
Breakdown:
2026-02-13 18:25:13,569 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 18:25:13,570 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 18:25:13,571 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 18:25:13,571 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 18:25:13,572 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 18:25:13,572 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 18:25:13,573 - retention_system - INFO - 
Data characteristics:
2026-02-13 18:25:13,574 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 18:25:13,575 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 18:25:13,575 - retention_system - INFO - ================================================================================

2026-02-13 18:25:14,038 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 18:25:14,048 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 18:25:14,050 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 18:25:14,050 - retention_system - INFO - Completed: Data Cleaning in 2.75 seconds
2026-02-13 18:25:14,052 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 18:25:14,052 - retention_system - INFO - Generating snapshot dates...
2026-02-13 18:25:14,052 - retention_system - INFO - Completed: Feature Engineering in 0.00 seconds
2026-02-13 18:26:28,034 - retention_system - INFO - Configuration loaded successfully
2026-02-13 18:26:28,035 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 18:26:28,035 - retention_system - INFO - Version: 1.0.0
2026-02-13 18:26:28,036 - retention_system - INFO - Starting: Data Validation
2026-02-13 18:26:28,147 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 18:26:29,465 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 18:26:29,466 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 18:26:29,466 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 18:26:29,630 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 18:26:29,670 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 18:26:29,671 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 18:26:29,672 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 18:26:29,805 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 18:26:29,809 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 18:26:29,814 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 18:26:29,964 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 18:26:29,968 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 18:26:29,994 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 18:26:30,130 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 18:26:30,269 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 18:26:30,271 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 18:26:30,283 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 18:26:30,355 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 18:26:30,355 - retention_system - INFO - 
================================================================================
2026-02-13 18:26:30,356 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 18:26:30,356 - retention_system - INFO - ================================================================================
2026-02-13 18:26:30,356 - retention_system - INFO - Total Checks: 16
2026-02-13 18:26:30,357 - retention_system - INFO - Passed: 11 ✓
2026-02-13 18:26:30,357 - retention_system - INFO - Failed: 5 ✗
2026-02-13 18:26:30,357 - retention_system - INFO -   - Errors: 0
2026-02-13 18:26:30,358 - retention_system - INFO -   - Warnings: 5
2026-02-13 18:26:30,358 - retention_system - INFO - ================================================================================

2026-02-13 18:26:30,362 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 18:26:30,362 - retention_system - INFO - ✓ Data validation passed
2026-02-13 18:26:30,363 - retention_system - INFO - Completed: Data Validation in 2.33 seconds
2026-02-13 18:26:30,364 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 18:26:30,365 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 18:26:30,445 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 18:26:31,214 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 18:26:31,215 - retention_system - INFO - ================================================================================
2026-02-13 18:26:31,215 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 18:26:31,215 - retention_system - INFO - ================================================================================
2026-02-13 18:26:31,215 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 18:26:31,318 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 18:26:31,672 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 18:26:31,705 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 18:26:31,706 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 18:26:31,757 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 18:26:31,758 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 18:26:31,809 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 18:26:31,809 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 18:26:31,813 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 18:26:31,856 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 18:26:31,918 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 18:26:31,918 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 18:26:31,922 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 18:26:31,990 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 18:26:32,380 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 18:26:32,385 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 18:26:32,386 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 18:26:32,389 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 18:26:32,397 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 18:26:32,471 - retention_system - INFO - ✓ Extracted date components
2026-02-13 18:26:32,478 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 18:26:32,478 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 18:26:32,481 - retention_system - INFO - 
================================================================================
2026-02-13 18:26:32,482 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 18:26:32,482 - retention_system - INFO - ================================================================================
2026-02-13 18:26:32,482 - retention_system - INFO - Initial rows: 541,909
2026-02-13 18:26:32,483 - retention_system - INFO - Final rows: 163,246
2026-02-13 18:26:32,483 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 18:26:32,483 - retention_system - INFO - 
Breakdown:
2026-02-13 18:26:32,484 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 18:26:32,484 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 18:26:32,484 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 18:26:32,485 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 18:26:32,485 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 18:26:32,485 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 18:26:32,485 - retention_system - INFO - 
Data characteristics:
2026-02-13 18:26:32,486 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 18:26:32,486 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 18:26:32,486 - retention_system - INFO - ================================================================================

2026-02-13 18:26:32,808 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 18:26:32,826 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 18:26:32,828 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 18:26:32,828 - retention_system - INFO - Completed: Data Cleaning in 2.46 seconds
2026-02-13 18:26:32,830 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 18:26:32,830 - retention_system - INFO - Generating snapshot dates...
2026-02-13 18:26:32,930 - retention_system - INFO - Generated 14 snapshot dates
2026-02-13 18:26:32,931 - retention_system - INFO - First snapshot: 2010-07-31
2026-02-13 18:26:32,931 - retention_system - INFO - Last snapshot: 2011-08-31
2026-02-13 18:26:32,932 - retention_system - INFO - 
Processing snapshot 1/14: 2010-07-31
2026-02-13 18:26:32,932 - retention_system - INFO - ================================================================================
2026-02-13 18:26:32,933 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-07-31
2026-02-13 18:26:32,933 - retention_system - INFO - ================================================================================
2026-02-13 18:26:32,944 - retention_system - INFO - Observation window: 2010-02-01 to 2010-07-31
2026-02-13 18:26:32,945 - retention_system - INFO - Transactions in window: 8,592
2026-02-13 18:26:32,946 - retention_system - INFO - Unique customers: 352
2026-02-13 18:26:32,947 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 18:26:32,975 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 18:26:32,976 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 18:26:33,208 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 18:26:33,210 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 18:26:33,210 - retention_system - INFO - Completed: Feature Engineering in 0.38 seconds
2026-02-13 21:22:26,367 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:22:26,368 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 21:22:26,368 - retention_system - INFO - Version: 1.0.0
2026-02-13 21:22:26,369 - retention_system - INFO - Starting: Data Validation
2026-02-13 21:22:26,442 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 21:22:27,056 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 21:22:27,056 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 21:22:27,056 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 21:22:27,164 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 21:22:27,191 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 21:22:27,192 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 21:22:27,193 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 21:22:27,319 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 21:22:27,323 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 21:22:27,328 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 21:22:27,432 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 21:22:27,434 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 21:22:27,457 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 21:22:27,576 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 21:22:27,690 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 21:22:27,692 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 21:22:27,702 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 21:22:27,761 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 21:22:27,761 - retention_system - INFO - 
================================================================================
2026-02-13 21:22:27,762 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 21:22:27,762 - retention_system - INFO - ================================================================================
2026-02-13 21:22:27,762 - retention_system - INFO - Total Checks: 16
2026-02-13 21:22:27,762 - retention_system - INFO - Passed: 11 ✓
2026-02-13 21:22:27,762 - retention_system - INFO - Failed: 5 ✗
2026-02-13 21:22:27,763 - retention_system - INFO -   - Errors: 0
2026-02-13 21:22:27,763 - retention_system - INFO -   - Warnings: 5
2026-02-13 21:22:27,763 - retention_system - INFO - ================================================================================

2026-02-13 21:22:27,767 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 21:22:27,767 - retention_system - INFO - ✓ Data validation passed
2026-02-13 21:22:27,767 - retention_system - INFO - Completed: Data Validation in 1.40 seconds
2026-02-13 21:22:27,769 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 21:22:27,769 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 21:22:27,848 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 21:22:28,502 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 21:22:28,502 - retention_system - INFO - ================================================================================
2026-02-13 21:22:28,503 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 21:22:28,503 - retention_system - INFO - ================================================================================
2026-02-13 21:22:28,503 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 21:22:28,572 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 21:22:28,812 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 21:22:28,845 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 21:22:28,847 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 21:22:28,894 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 21:22:28,895 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 21:22:28,943 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 21:22:28,943 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 21:22:28,946 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 21:22:28,982 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 21:22:29,025 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 21:22:29,026 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 21:22:29,029 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 21:22:29,076 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 21:22:29,368 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 21:22:29,371 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 21:22:29,371 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 21:22:29,374 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 21:22:29,383 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 21:22:29,437 - retention_system - INFO - ✓ Extracted date components
2026-02-13 21:22:29,444 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 21:22:29,444 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 21:22:29,447 - retention_system - INFO - 
================================================================================
2026-02-13 21:22:29,448 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 21:22:29,448 - retention_system - INFO - ================================================================================
2026-02-13 21:22:29,448 - retention_system - INFO - Initial rows: 541,909
2026-02-13 21:22:29,448 - retention_system - INFO - Final rows: 163,246
2026-02-13 21:22:29,449 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 21:22:29,449 - retention_system - INFO - 
Breakdown:
2026-02-13 21:22:29,449 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 21:22:29,450 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 21:22:29,450 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 21:22:29,451 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 21:22:29,451 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 21:22:29,451 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 21:22:29,452 - retention_system - INFO - 
Data characteristics:
2026-02-13 21:22:29,453 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 21:22:29,453 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 21:22:29,453 - retention_system - INFO - ================================================================================

2026-02-13 21:22:29,908 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 21:22:29,919 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 21:22:29,920 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 21:22:29,921 - retention_system - INFO - Completed: Data Cleaning in 2.15 seconds
2026-02-13 21:22:29,922 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 21:22:29,922 - retention_system - INFO - Generating snapshot dates...
2026-02-13 21:22:29,927 - retention_system - INFO - Generated 14 snapshot dates
2026-02-13 21:22:29,927 - retention_system - INFO - First snapshot: 2010-07-31
2026-02-13 21:22:29,928 - retention_system - INFO - Last snapshot: 2011-08-31
2026-02-13 21:22:29,928 - retention_system - INFO - 
Processing snapshot 1/14: 2010-07-31
2026-02-13 21:22:29,928 - retention_system - INFO - ================================================================================
2026-02-13 21:22:29,929 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-07-31
2026-02-13 21:22:29,929 - retention_system - INFO - ================================================================================
2026-02-13 21:22:29,935 - retention_system - INFO - Observation window: 2010-02-01 to 2010-07-31
2026-02-13 21:22:29,936 - retention_system - INFO - Transactions in window: 8,592
2026-02-13 21:22:29,936 - retention_system - INFO - Unique customers: 352
2026-02-13 21:22:29,936 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:22:29,956 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:22:29,957 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:22:30,156 - retention_system - INFO - Completed: Feature Engineering in 0.23 seconds
2026-02-13 21:28:56,128 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:28:56,129 - retention_system - INFO - Project: Customer Retention Intelligence System
2026-02-13 21:28:56,129 - retention_system - INFO - Version: 1.0.0
2026-02-13 21:28:56,130 - retention_system - INFO - Starting: Data Validation
2026-02-13 21:28:56,204 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 21:28:56,914 - retention_system - INFO - Loaded raw data: 541,909 rows, 8 columns
2026-02-13 21:28:56,914 - retention_system - INFO - Starting comprehensive data validation...
2026-02-13 21:28:56,915 - retention_system - INFO - ✓ Schema Validation: All 8 required columns present
2026-02-13 21:28:57,008 - retention_system - WARNING - ⚠️  Completeness - CustomerID: 24.93% missing (threshold: 5.0%)
2026-02-13 21:28:57,029 - retention_system - INFO - ✓ Overall Completeness: Average missing: 3.15%
2026-02-13 21:28:57,030 - retention_system - INFO - ✓ Data Type - Quantity: Quantity is numeric-compatible
2026-02-13 21:28:57,030 - retention_system - INFO - ✓ Data Type - UnitPrice: UnitPrice is numeric-compatible
2026-02-13 21:28:57,127 - retention_system - INFO - ✓ Data Type - InvoiceDate: InvoiceDate is datetime-compatible
2026-02-13 21:28:57,131 - retention_system - WARNING - ⚠️  Value Range - UnitPrice: Negative: 2, Zero: 2,515, Valid: 539,388
2026-02-13 21:28:57,135 - retention_system - INFO - ✓ Value Range - Quantity: Out of range: 0, Zero: 0
2026-02-13 21:28:57,223 - retention_system - INFO - ✓ Business Rule - Cancellations: Found 9,288 cancellations (1.71%)
2026-02-13 21:28:57,225 - retention_system - INFO - ✓ Business Rule - Returns: Found 10,624 returns (1.96%)
2026-02-13 21:28:57,250 - retention_system - INFO - ✓ Business Rule - Revenue Distribution: Positive: 530,104, Negative: 9,290, Zero: 2,515
2026-02-13 21:28:57,364 - retention_system - WARNING - ⚠️  Duplicate Records: Found 20,378 duplicate rows (3.76%)
2026-02-13 21:28:57,479 - retention_system - WARNING - ⚠️  Date Range Validation: Date range: 2010-01-12 to 2011-12-10 (697 days)
2026-02-13 21:28:57,481 - retention_system - WARNING - ⚠️  Date Completeness: Found 308,950 null dates
2026-02-13 21:28:57,490 - retention_system - INFO - ✓ Customer Data: Unique customers: 4,372, Null CustomerID: 135,080 (24.93%)
2026-02-13 21:28:57,546 - retention_system - INFO - ✓ Customer Transaction Count: 79 customers with < 2 transactions
2026-02-13 21:28:57,546 - retention_system - INFO - 
================================================================================
2026-02-13 21:28:57,547 - retention_system - INFO - VALIDATION SUMMARY
2026-02-13 21:28:57,547 - retention_system - INFO - ================================================================================
2026-02-13 21:28:57,548 - retention_system - INFO - Total Checks: 16
2026-02-13 21:28:57,548 - retention_system - INFO - Passed: 11 ✓
2026-02-13 21:28:57,548 - retention_system - INFO - Failed: 5 ✗
2026-02-13 21:28:57,548 - retention_system - INFO -   - Errors: 0
2026-02-13 21:28:57,549 - retention_system - INFO -   - Warnings: 5
2026-02-13 21:28:57,549 - retention_system - INFO - ================================================================================

2026-02-13 21:28:57,552 - retention_system - INFO - Validation report saved to: outputs\validation_report.csv
2026-02-13 21:28:57,552 - retention_system - INFO - ✓ Data validation passed
2026-02-13 21:28:57,553 - retention_system - INFO - Completed: Data Validation in 1.42 seconds
2026-02-13 21:28:57,554 - retention_system - INFO - Starting: Data Cleaning
2026-02-13 21:28:57,555 - retention_system - INFO - Loading raw data from: data\raw\online_retail.csv
2026-02-13 21:28:57,609 - retention_system - WARNING - UTF-8 encoding failed, trying ISO-8859-1
2026-02-13 21:28:58,188 - retention_system - INFO - Loaded 541,909 rows, 8 columns
2026-02-13 21:28:58,188 - retention_system - INFO - ================================================================================
2026-02-13 21:28:58,188 - retention_system - INFO - STARTING DATA CLEANING PIPELINE
2026-02-13 21:28:58,189 - retention_system - INFO - ================================================================================
2026-02-13 21:28:58,189 - retention_system - INFO - 
--- Stage 1: Structural Cleaning ---
2026-02-13 21:28:58,271 - retention_system - INFO - ✓ Removed 135,080 rows with null CustomerID
2026-02-13 21:28:58,506 - retention_system - INFO - ✓ Removed 234,047 rows with unparseable dates
2026-02-13 21:28:58,532 - retention_system - INFO - Stage 1 complete: Removed 369,127 rows (68.12%)
2026-02-13 21:28:58,533 - retention_system - INFO - 
--- Stage 2: Business Logic Cleaning ---
2026-02-13 21:28:58,567 - retention_system - INFO - ✓ Flagged 4,133 cancellations
2026-02-13 21:28:58,568 - retention_system - INFO - ✓ Flagged 4,133 returns (negative quantity)
2026-02-13 21:28:58,608 - retention_system - INFO - ✓ Removed 18 rows with UnitPrice < 0.01
2026-02-13 21:28:58,609 - retention_system - INFO - Stage 2 complete: Removed 18 rows (0.01%)
2026-02-13 21:28:58,613 - retention_system - INFO - 
--- Stage 3: Outlier Detection ---
2026-02-13 21:28:58,640 - retention_system - INFO - ✓ Removed 1,715 price outliers (>14.95)
2026-02-13 21:28:58,686 - retention_system - INFO - ✓ Removed 7,698 quantity outliers (IQR method)
2026-02-13 21:28:58,687 - retention_system - INFO - Stage 3 complete: Removed 9,413 rows (5.45%)
2026-02-13 21:28:58,690 - retention_system - INFO - 
--- Stage 4: Customer-Level Validation ---
2026-02-13 21:28:58,727 - retention_system - INFO - ✓ Removed 105 customers with < 2 transactions
2026-02-13 21:28:58,973 - retention_system - INFO - ⚠️  Flagged 70 customers with >80.0% return rate
2026-02-13 21:28:58,977 - retention_system - INFO - Stage 4 complete: Removed 105 rows (0.06%)
2026-02-13 21:28:58,977 - retention_system - INFO - Final customer count: 2,933 (removed 105)
2026-02-13 21:28:58,980 - retention_system - INFO - 
--- Stage 5: Feature Creation ---
2026-02-13 21:28:58,986 - retention_system - INFO - ✓ Created Revenue feature
2026-02-13 21:28:59,036 - retention_system - INFO - ✓ Extracted date components
2026-02-13 21:28:59,042 - retention_system - INFO - ✓ Classified transaction types
2026-02-13 21:28:59,043 - retention_system - INFO - Final feature count: 20 columns
2026-02-13 21:28:59,046 - retention_system - INFO - 
================================================================================
2026-02-13 21:28:59,047 - retention_system - INFO - DATA CLEANING SUMMARY
2026-02-13 21:28:59,047 - retention_system - INFO - ================================================================================
2026-02-13 21:28:59,047 - retention_system - INFO - Initial rows: 541,909
2026-02-13 21:28:59,047 - retention_system - INFO - Final rows: 163,246
2026-02-13 21:28:59,048 - retention_system - INFO - Rows removed: 378,663 (69.88%)
2026-02-13 21:28:59,048 - retention_system - INFO - 
Breakdown:
2026-02-13 21:28:59,048 - retention_system - INFO -   - Null CustomerID: 135,080
2026-02-13 21:28:59,049 - retention_system - INFO -   - Invalid prices: 18
2026-02-13 21:28:59,049 - retention_system - INFO -   - Zero quantity: 0
2026-02-13 21:28:59,049 - retention_system - INFO -   - Price outliers: 1,715
2026-02-13 21:28:59,050 - retention_system - INFO -   - Quantity outliers: 7,698
2026-02-13 21:28:59,050 - retention_system - INFO -   - Min transaction filter: 105 customers
2026-02-13 21:28:59,050 - retention_system - INFO - 
Data characteristics:
2026-02-13 21:28:59,051 - retention_system - INFO -   - Cancellations flagged: 4,133
2026-02-13 21:28:59,051 - retention_system - INFO -   - Returns flagged: 4,133
2026-02-13 21:28:59,051 - retention_system - INFO - ================================================================================

2026-02-13 21:28:59,268 - retention_system - INFO - Saved cleaned data to: data\processed\cleaned_data.parquet
2026-02-13 21:28:59,282 - retention_system - INFO - Cleaned data saved to: data\processed\cleaned_data.parquet
2026-02-13 21:28:59,284 - retention_system - INFO - Cleaning statistics saved to: outputs\cleaning_stats.json
2026-02-13 21:28:59,285 - retention_system - INFO - Completed: Data Cleaning in 1.73 seconds
2026-02-13 21:28:59,285 - retention_system - INFO - Starting: Feature Engineering
2026-02-13 21:28:59,286 - retention_system - INFO - Generating snapshot dates...
2026-02-13 21:28:59,288 - retention_system - INFO - Generated 14 snapshot dates
2026-02-13 21:28:59,288 - retention_system - INFO - First snapshot: 2010-07-31
2026-02-13 21:28:59,288 - retention_system - INFO - Last snapshot: 2011-08-31
2026-02-13 21:28:59,289 - retention_system - INFO - 
Processing snapshot 1/14: 2010-07-31
2026-02-13 21:28:59,289 - retention_system - INFO - ================================================================================
2026-02-13 21:28:59,289 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-07-31
2026-02-13 21:28:59,290 - retention_system - INFO - ================================================================================
2026-02-13 21:28:59,299 - retention_system - INFO - Observation window: 2010-02-01 to 2010-07-31
2026-02-13 21:28:59,299 - retention_system - INFO - Transactions in window: 8,592
2026-02-13 21:28:59,300 - retention_system - INFO - Unique customers: 352
2026-02-13 21:28:59,301 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:28:59,319 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:28:59,320 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:28:59,814 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:28:59,815 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:28:59,841 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:28:59,842 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:28:59,848 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:28:59,848 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:07,093 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:07,098 - retention_system - INFO - 
✓ Created 36 features for 352 customers
2026-02-13 21:29:07,099 - retention_system - INFO - 
Processing snapshot 2/14: 2010-08-31
2026-02-13 21:29:07,100 - retention_system - INFO - ================================================================================
2026-02-13 21:29:07,101 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-08-31
2026-02-13 21:29:07,101 - retention_system - INFO - ================================================================================
2026-02-13 21:29:07,109 - retention_system - INFO - Observation window: 2010-03-04 to 2010-08-31
2026-02-13 21:29:07,109 - retention_system - INFO - Transactions in window: 8,609
2026-02-13 21:29:07,110 - retention_system - INFO - Unique customers: 350
2026-02-13 21:29:07,111 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:07,133 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:07,134 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:07,523 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:07,524 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:07,545 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:07,545 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:07,549 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:07,549 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:07,625 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:07,627 - retention_system - INFO - 
✓ Created 36 features for 350 customers
2026-02-13 21:29:07,629 - retention_system - INFO - 
Processing snapshot 3/14: 2010-09-30
2026-02-13 21:29:07,629 - retention_system - INFO - ================================================================================
2026-02-13 21:29:07,630 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-09-30
2026-02-13 21:29:07,630 - retention_system - INFO - ================================================================================
2026-02-13 21:29:07,639 - retention_system - INFO - Observation window: 2010-04-03 to 2010-09-30
2026-02-13 21:29:07,640 - retention_system - INFO - Transactions in window: 9,328
2026-02-13 21:29:07,641 - retention_system - INFO - Unique customers: 403
2026-02-13 21:29:07,641 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:07,657 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:07,657 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:08,035 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:08,036 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:08,052 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:08,052 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:08,056 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:08,056 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:08,117 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:08,120 - retention_system - INFO - 
✓ Created 36 features for 403 customers
2026-02-13 21:29:08,121 - retention_system - INFO - 
Processing snapshot 4/14: 2010-10-31
2026-02-13 21:29:08,122 - retention_system - INFO - ================================================================================
2026-02-13 21:29:08,122 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-10-31
2026-02-13 21:29:08,122 - retention_system - INFO - ================================================================================
2026-02-13 21:29:08,128 - retention_system - INFO - Observation window: 2010-05-04 to 2010-10-31
2026-02-13 21:29:08,129 - retention_system - INFO - Transactions in window: 10,692
2026-02-13 21:29:08,129 - retention_system - INFO - Unique customers: 445
2026-02-13 21:29:08,130 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:08,142 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:08,143 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:08,516 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:08,518 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:08,537 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:08,537 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:08,540 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:08,540 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:08,613 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:08,618 - retention_system - INFO - 
✓ Created 36 features for 445 customers
2026-02-13 21:29:08,620 - retention_system - INFO - 
Processing snapshot 5/14: 2010-11-30
2026-02-13 21:29:08,620 - retention_system - INFO - ================================================================================
2026-02-13 21:29:08,621 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-11-30
2026-02-13 21:29:08,622 - retention_system - INFO - ================================================================================
2026-02-13 21:29:08,628 - retention_system - INFO - Observation window: 2010-06-03 to 2010-11-30
2026-02-13 21:29:08,628 - retention_system - INFO - Transactions in window: 8,031
2026-02-13 21:29:08,629 - retention_system - INFO - Unique customers: 387
2026-02-13 21:29:08,630 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:08,644 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:08,644 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:08,959 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:08,960 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:08,971 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:08,971 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:08,974 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:08,975 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:09,035 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:09,038 - retention_system - INFO - 
✓ Created 36 features for 387 customers
2026-02-13 21:29:09,039 - retention_system - INFO - 
Processing snapshot 6/14: 2010-12-31
2026-02-13 21:29:09,039 - retention_system - INFO - ================================================================================
2026-02-13 21:29:09,039 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2010-12-31
2026-02-13 21:29:09,040 - retention_system - INFO - ================================================================================
2026-02-13 21:29:09,044 - retention_system - INFO - Observation window: 2010-07-04 to 2010-12-31
2026-02-13 21:29:09,044 - retention_system - INFO - Transactions in window: 7,526
2026-02-13 21:29:09,045 - retention_system - INFO - Unique customers: 353
2026-02-13 21:29:09,045 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:09,058 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:09,059 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:09,354 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:09,355 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:09,369 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:09,370 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:09,374 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:09,374 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:09,419 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:09,422 - retention_system - INFO - 
✓ Created 36 features for 353 customers
2026-02-13 21:29:09,423 - retention_system - INFO - 
Processing snapshot 7/14: 2011-01-31
2026-02-13 21:29:09,423 - retention_system - INFO - ================================================================================
2026-02-13 21:29:09,423 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-01-31
2026-02-13 21:29:09,424 - retention_system - INFO - ================================================================================
2026-02-13 21:29:09,435 - retention_system - INFO - Observation window: 2010-08-04 to 2011-01-31
2026-02-13 21:29:09,436 - retention_system - INFO - Transactions in window: 17,753
2026-02-13 21:29:09,437 - retention_system - INFO - Unique customers: 721
2026-02-13 21:29:09,437 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:09,449 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:09,450 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:10,010 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:10,013 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:10,036 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:10,037 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:10,040 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:10,040 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:10,173 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:10,175 - retention_system - INFO - 
✓ Created 36 features for 721 customers
2026-02-13 21:29:10,176 - retention_system - INFO - 
Processing snapshot 8/14: 2011-02-28
2026-02-13 21:29:10,176 - retention_system - INFO - ================================================================================
2026-02-13 21:29:10,177 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-02-28
2026-02-13 21:29:10,177 - retention_system - INFO - ================================================================================
2026-02-13 21:29:10,191 - retention_system - INFO - Observation window: 2010-09-01 to 2011-02-28
2026-02-13 21:29:10,192 - retention_system - INFO - Transactions in window: 25,675
2026-02-13 21:29:10,193 - retention_system - INFO - Unique customers: 947
2026-02-13 21:29:10,193 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:10,206 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:10,207 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:11,020 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:11,024 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:11,054 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:11,054 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:11,058 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:11,058 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:11,291 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:11,294 - retention_system - INFO - 
✓ Created 36 features for 947 customers
2026-02-13 21:29:11,296 - retention_system - INFO - 
Processing snapshot 9/14: 2011-03-31
2026-02-13 21:29:11,296 - retention_system - INFO - ================================================================================
2026-02-13 21:29:11,297 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-03-31
2026-02-13 21:29:11,297 - retention_system - INFO - ================================================================================
2026-02-13 21:29:11,311 - retention_system - INFO - Observation window: 2010-10-02 to 2011-03-31
2026-02-13 21:29:11,312 - retention_system - INFO - Transactions in window: 33,255
2026-02-13 21:29:11,313 - retention_system - INFO - Unique customers: 1,121
2026-02-13 21:29:11,313 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:11,326 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:11,326 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:12,223 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:12,226 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:12,251 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:12,252 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:12,255 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:12,256 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:12,542 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:12,546 - retention_system - INFO - 
✓ Created 36 features for 1,121 customers
2026-02-13 21:29:12,548 - retention_system - INFO - 
Processing snapshot 10/14: 2011-04-30
2026-02-13 21:29:12,548 - retention_system - INFO - ================================================================================
2026-02-13 21:29:12,548 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-04-30
2026-02-13 21:29:12,549 - retention_system - INFO - ================================================================================
2026-02-13 21:29:12,572 - retention_system - INFO - Observation window: 2010-11-01 to 2011-04-30
2026-02-13 21:29:12,572 - retention_system - INFO - Transactions in window: 46,202
2026-02-13 21:29:12,574 - retention_system - INFO - Unique customers: 1,388
2026-02-13 21:29:12,574 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:12,591 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:12,591 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:13,766 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:13,772 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:13,819 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:13,819 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:13,822 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:13,823 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:14,232 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:14,236 - retention_system - INFO - 
✓ Created 36 features for 1,388 customers
2026-02-13 21:29:14,238 - retention_system - INFO - 
Processing snapshot 11/14: 2011-05-31
2026-02-13 21:29:14,238 - retention_system - INFO - ================================================================================
2026-02-13 21:29:14,239 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-05-31
2026-02-13 21:29:14,239 - retention_system - INFO - ================================================================================
2026-02-13 21:29:14,283 - retention_system - INFO - Observation window: 2010-12-02 to 2011-05-31
2026-02-13 21:29:14,283 - retention_system - INFO - Transactions in window: 59,214
2026-02-13 21:29:14,285 - retention_system - INFO - Unique customers: 1,630
2026-02-13 21:29:14,285 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:14,312 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:14,313 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:15,635 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:15,642 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:15,686 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:15,687 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:15,690 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:15,690 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:16,234 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:16,238 - retention_system - INFO - 
✓ Created 36 features for 1,630 customers
2026-02-13 21:29:16,241 - retention_system - INFO - 
Processing snapshot 12/14: 2011-06-30
2026-02-13 21:29:16,241 - retention_system - INFO - ================================================================================
2026-02-13 21:29:16,242 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-06-30
2026-02-13 21:29:16,242 - retention_system - INFO - ================================================================================
2026-02-13 21:29:16,271 - retention_system - INFO - Observation window: 2011-01-01 to 2011-06-30
2026-02-13 21:29:16,271 - retention_system - INFO - Transactions in window: 73,931
2026-02-13 21:29:16,272 - retention_system - INFO - Unique customers: 1,887
2026-02-13 21:29:16,273 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:16,294 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:16,295 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:17,999 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:18,009 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:18,065 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:18,066 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:18,069 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:18,069 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:18,772 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:18,779 - retention_system - INFO - 
✓ Created 36 features for 1,887 customers
2026-02-13 21:29:18,782 - retention_system - INFO - 
Processing snapshot 13/14: 2011-07-31
2026-02-13 21:29:18,783 - retention_system - INFO - ================================================================================
2026-02-13 21:29:18,783 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-07-31
2026-02-13 21:29:18,784 - retention_system - INFO - ================================================================================
2026-02-13 21:29:18,836 - retention_system - INFO - Observation window: 2011-02-01 to 2011-07-31
2026-02-13 21:29:18,837 - retention_system - INFO - Transactions in window: 76,697
2026-02-13 21:29:18,840 - retention_system - INFO - Unique customers: 1,922
2026-02-13 21:29:18,841 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:18,868 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:18,869 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:20,616 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:20,625 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:20,686 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:20,689 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:20,692 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:20,692 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:21,448 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:21,454 - retention_system - INFO - 
✓ Created 36 features for 1,922 customers
2026-02-13 21:29:21,457 - retention_system - INFO - 
Processing snapshot 14/14: 2011-08-31
2026-02-13 21:29:21,457 - retention_system - INFO - ================================================================================
2026-02-13 21:29:21,457 - retention_system - INFO - FEATURE ENGINEERING FOR SNAPSHOT: 2011-08-31
2026-02-13 21:29:21,458 - retention_system - INFO - ================================================================================
2026-02-13 21:29:21,489 - retention_system - INFO - Observation window: 2011-03-04 to 2011-08-31
2026-02-13 21:29:21,489 - retention_system - INFO - Transactions in window: 78,812
2026-02-13 21:29:21,492 - retention_system - INFO - Unique customers: 1,937
2026-02-13 21:29:21,492 - retention_system - INFO - 
--- Computing RFM Features ---
2026-02-13 21:29:21,513 - retention_system - INFO -   ✓ RFM features: 7 features
2026-02-13 21:29:21,514 - retention_system - INFO - --- Computing Temporal Behavior Features ---
2026-02-13 21:29:23,249 - retention_system - INFO -   ✓ Temporal features: 13 features
2026-02-13 21:29:23,259 - retention_system - INFO - --- Computing Product Interaction Features ---
2026-02-13 21:29:23,321 - retention_system - INFO -   ✓ Product features: 5 features
2026-02-13 21:29:23,321 - retention_system - INFO - --- Computing Engagement Features ---
2026-02-13 21:29:23,325 - retention_system - INFO -   ✓ Engagement features: 4 features
2026-02-13 21:29:23,325 - retention_system - INFO - --- Computing Trend Features ---
2026-02-13 21:29:24,153 - retention_system - INFO -   ✓ Trend features: 4 features
2026-02-13 21:29:24,160 - retention_system - INFO - 
✓ Created 36 features for 1,937 customers
2026-02-13 21:29:24,174 - retention_system - INFO - 
✓ Total feature rows: 13,843
2026-02-13 21:29:24,174 - retention_system - INFO - ✓ Total features: 36
2026-02-13 21:29:24,174 - retention_system - INFO - Completed: Feature Engineering in 24.89 seconds
2026-02-13 21:29:24,175 - retention_system - INFO - Starting: Feature Store Creation
2026-02-13 21:29:24,247 - retention_system - INFO - Features saved to: data\features\customer_features.parquet
2026-02-13 21:29:24,251 - retention_system - INFO - Feature metadata saved to: data\features\feature_metadata.json
2026-02-13 21:29:24,253 - retention_system - INFO - Completed: Feature Store Creation in 0.08 seconds
2026-02-13 21:29:24,254 - retention_system - INFO - Starting: Temporal Validation
2026-02-13 21:29:24,254 - retention_system - INFO - Validating temporal consistency...
2026-02-13 21:29:24,256 - retention_system - INFO - ✓ All snapshot dates are valid
2026-02-13 21:29:24,263 - retention_system - INFO - ✓ Temporal consistency validated (sample check passed)
2026-02-13 21:29:24,263 - retention_system - INFO - Completed: Temporal Validation in 0.01 seconds
2026-02-13 21:29:24,265 - retention_system - INFO - ✓ Task 0.1: Project Setup & Configuration - COMPLETE
2026-02-13 21:29:24,265 - retention_system - INFO - ✓ Task 0.2: Data Validation & Quality Checks - COMPLETE
2026-02-13 21:29:24,265 - retention_system - INFO - ✓ Task 0.3: Data Cleaning Pipeline - COMPLETE
2026-02-13 21:29:24,266 - retention_system - INFO - ✓ Task 0.4: Feature Engineering Framework - COMPLETE
2026-02-13 21:29:24,266 - retention_system - INFO - ✓ Task 0.5: Feature Store Implementation - COMPLETE
2026-02-13 21:29:24,267 - retention_system - INFO - ✓ Task 0.6: Temporal Consistency Validation - COMPLETE
2026-02-13 21:29:24,267 - retention_system - INFO - 
================================================================================
2026-02-13 21:29:24,267 - retention_system - INFO - PILLAR 0 STATUS: 6/6 TASKS COMPLETE ✓
2026-02-13 21:29:24,268 - retention_system - INFO - ================================================================================
2026-02-13 21:29:24,268 - retention_system - INFO - 
Output files created:
2026-02-13 21:29:24,269 - retention_system - INFO -   1. Validation report: outputs\validation_report.csv
2026-02-13 21:29:24,270 - retention_system - INFO -   2. Cleaned data: data\processed\cleaned_data.parquet
2026-02-13 21:29:24,271 - retention_system - INFO -   3. Cleaning stats: outputs\cleaning_stats.json
2026-02-13 21:29:24,272 - retention_system - INFO -   4. Feature store: data\features\customer_features.parquet
2026-02-13 21:29:24,272 - retention_system - INFO -   5. Feature metadata: data\features\feature_metadata.json
2026-02-13 21:29:24,273 - retention_system - INFO - 
Next steps:
2026-02-13 21:29:24,273 - retention_system - INFO -   → Proceed to Pillar 1: RFM Segmentation
2026-02-13 21:29:24,273 - retention_system - INFO -   → Run: python pillar_1_rfm.py
2026-02-13 21:30:22,964 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:30:22,965 - retention_system - INFO - Features path: data/features/customer_features.parquet
2026-02-13 21:30:22,966 - retention_system - INFO - Starting: Feature Loading
2026-02-13 21:30:23,464 - retention_system - INFO - Loaded features: 13,843 rows, 36 columns
2026-02-13 21:30:23,465 - retention_system - INFO - Latest snapshot: 2011-08-31
2026-02-13 21:30:23,466 - retention_system - INFO - Unique customers in latest snapshot: 1,937
2026-02-13 21:30:23,467 - retention_system - INFO - Completed: Feature Loading in 0.50 seconds
2026-02-13 21:30:23,468 - retention_system - INFO - Starting: Model Training
2026-02-13 21:30:23,468 - retention_system - INFO - Auto-selecting optimal K...
2026-02-13 21:30:23,468 - retention_system - INFO - ================================================================================
2026-02-13 21:30:23,468 - retention_system - INFO - FITTING RFM SEGMENTATION MODEL
2026-02-13 21:30:23,469 - retention_system - INFO - ================================================================================
2026-02-13 21:30:23,471 - retention_system - INFO - Using latest snapshot: 2011-08-31
2026-02-13 21:30:23,473 - retention_system - INFO - Selected 7 RFM features
2026-02-13 21:30:23,473 - retention_system - INFO - Customers: 1,937
2026-02-13 21:30:23,473 - retention_system - INFO - 
--- Standardizing Features ---
2026-02-13 21:30:23,480 - retention_system - INFO - 
--- Auto-Selecting Optimal K (range: (3, 8)) ---
2026-02-13 21:30:25,912 - retention_system - INFO - K=3: Inertia=8928.96, Silhouette=0.2800
2026-02-13 21:30:26,045 - retention_system - INFO - K=4: Inertia=7391.78, Silhouette=0.3262
2026-02-13 21:30:26,185 - retention_system - INFO - K=5: Inertia=6156.38, Silhouette=0.3464
2026-02-13 21:30:26,333 - retention_system - INFO - K=6: Inertia=5522.81, Silhouette=0.3371
2026-02-13 21:30:26,520 - retention_system - INFO - K=7: Inertia=4967.92, Silhouette=0.3366
2026-02-13 21:30:26,706 - retention_system - INFO - K=8: Inertia=4594.57, Silhouette=0.2800
2026-02-13 21:30:26,707 - retention_system - INFO - 
Elbow method suggests K=6
2026-02-13 21:30:26,708 - retention_system - INFO - Silhouette method suggests K=5
2026-02-13 21:30:26,708 - retention_system - INFO - Selected K = 5
2026-02-13 21:30:26,709 - retention_system - INFO - 
--- Fitting K-Means (K=5) ---
2026-02-13 21:30:26,889 - retention_system - INFO - Clustering metrics:
2026-02-13 21:30:26,889 - retention_system - INFO -   Silhouette Score: 0.3464 (higher is better, range: -1 to 1)
2026-02-13 21:30:26,889 - retention_system - INFO -   Davies-Bouldin Index: 0.9826 (lower is better)
2026-02-13 21:30:26,890 - retention_system - INFO -   Inertia: 6156.38
2026-02-13 21:30:26,890 - retention_system - INFO - 
--- Profiling Segments ---
2026-02-13 21:30:26,899 - retention_system - INFO - 
Segment Summary:
2026-02-13 21:30:26,900 - retention_system - INFO - 
Segment 0 - Hibernating:
2026-02-13 21:30:26,901 - retention_system - INFO -   Size: 713 (36.8%)
2026-02-13 21:30:26,901 - retention_system - INFO -   Avg Recency: 125.9 days
2026-02-13 21:30:26,901 - retention_system - INFO -   Avg Frequency: 26.0 transactions
2026-02-13 21:30:26,902 - retention_system - INFO -   Avg Monetary: $16.41
2026-02-13 21:30:26,902 - retention_system - INFO -   Total Revenue: $236,340.35
2026-02-13 21:30:26,903 - retention_system - INFO - 
Segment 1 - Need Attention:
2026-02-13 21:30:26,903 - retention_system - INFO -   Size: 884 (45.6%)
2026-02-13 21:30:26,903 - retention_system - INFO -   Avg Recency: 50.4 days
2026-02-13 21:30:26,903 - retention_system - INFO -   Avg Frequency: 24.2 transactions
2026-02-13 21:30:26,904 - retention_system - INFO -   Avg Monetary: $15.15
2026-02-13 21:30:26,904 - retention_system - INFO -   Total Revenue: $264,054.78
2026-02-13 21:30:26,905 - retention_system - INFO - 
Segment 2 - Promising:
2026-02-13 21:30:26,905 - retention_system - INFO -   Size: 10 (0.5%)
2026-02-13 21:30:26,906 - retention_system - INFO -   Avg Recency: 28.7 days
2026-02-13 21:30:26,906 - retention_system - INFO -   Avg Frequency: 653.0 transactions
2026-02-13 21:30:26,906 - retention_system - INFO -   Avg Monetary: $18.18
2026-02-13 21:30:26,907 - retention_system - INFO -   Total Revenue: $83,494.30
2026-02-13 21:30:26,907 - retention_system - INFO - 
Segment 3 - Promising:
2026-02-13 21:30:26,908 - retention_system - INFO -   Size: 319 (16.5%)
2026-02-13 21:30:26,908 - retention_system - INFO -   Avg Recency: 37.1 days
2026-02-13 21:30:26,909 - retention_system - INFO -   Avg Frequency: 98.0 transactions
2026-02-13 21:30:26,910 - retention_system - INFO -   Avg Monetary: $20.99
2026-02-13 21:30:26,911 - retention_system - INFO -   Total Revenue: $452,505.11
2026-02-13 21:30:26,912 - retention_system - INFO - 
Segment 4 - Lost/Churned:
2026-02-13 21:30:26,912 - retention_system - INFO -   Size: 11 (0.6%)
2026-02-13 21:30:26,913 - retention_system - INFO -   Avg Recency: 77.2 days
2026-02-13 21:30:26,913 - retention_system - INFO -   Avg Frequency: 93.4 transactions
2026-02-13 21:30:26,913 - retention_system - INFO -   Avg Monetary: $11.51
2026-02-13 21:30:26,914 - retention_system - INFO -   Total Revenue: $12,016.69
2026-02-13 21:30:26,918 - retention_system - INFO - 
Feature Importance for Segmentation:
2026-02-13 21:30:26,919 - retention_system - INFO -   purchase_frequency_per_month: 0.3068
2026-02-13 21:30:26,919 - retention_system - INFO -   engagement_score: 0.2553
2026-02-13 21:30:26,920 - retention_system - INFO -   rfm_monetary_total: 0.2233
2026-02-13 21:30:26,920 - retention_system - INFO -   rfm_frequency_count: 0.1934
2026-02-13 21:30:26,921 - retention_system - INFO -   days_since_first_purchase: 0.0114
2026-02-13 21:30:26,922 - retention_system - INFO -   rfm_recency_days: 0.0095
2026-02-13 21:30:26,923 - retention_system - INFO -   rfm_monetary_avg: 0.0004
2026-02-13 21:30:26,923 - retention_system - INFO - 
✓ RFM segmentation model trained successfully
2026-02-13 21:30:26,924 - retention_system - INFO - ✓ Model fitted with K=5 clusters
2026-02-13 21:30:26,924 - retention_system - INFO - Completed: Model Training in 3.46 seconds
2026-02-13 21:30:26,926 - retention_system - INFO - Starting: Segment Profiling
2026-02-13 21:30:26,926 - retention_system - INFO - 
Segment Profiles:
2026-02-13 21:30:26,933 - retention_system - INFO -  segment  size  size_pct  avg_recency  avg_frequency  avg_monetary  total_revenue  avg_engagement_score  avg_customer_age_days   segment_name
       0   713 36.809499   125.915849      26.032258     16.406505      236340.35              2.944642             143.294530    Hibernating
       1   884 45.637584    50.419683      24.227376     15.154522      264054.78              8.189046              64.248869 Need Attention
       2    10  0.516262    28.700000     653.000000     18.179699       83494.30            381.613317             163.600000      Promising
       3   319 16.468766    37.068966      98.047022     20.989284      452505.11             48.269376             143.156740      Promising
       4    11  0.567888    77.181818      93.363636     11.507462       12016.69             17.337441              79.454545   Lost/Churned
2026-02-13 21:30:26,934 - retention_system - INFO - 
Top 5 Most Important Features:
2026-02-13 21:30:26,935 - retention_system - INFO -                      feature  importance
purchase_frequency_per_month    0.306818
            engagement_score    0.255273
          rfm_monetary_total    0.223315
         rfm_frequency_count    0.193372
   days_since_first_purchase    0.011390
2026-02-13 21:30:26,949 - retention_system - INFO - 
✓ Assigned segments to 13,843 customer records
2026-02-13 21:30:27,025 - retention_system - INFO - Saved segment assignments to: outputs\segment_assignments.parquet
2026-02-13 21:30:27,026 - retention_system - INFO - Completed: Segment Profiling in 0.10 seconds
2026-02-13 21:30:27,027 - retention_system - INFO - Starting: Visualization Generation
2026-02-13 21:30:27,029 - retention_system - INFO - Creating segment visualization report...
2026-02-13 21:30:28,514 - retention_system - INFO - Saved segment distribution plot to: outputs\visualizations\rfm\segment_distribution.png
2026-02-13 21:30:29,031 - retention_system - INFO - Saved RFM heatmap to: outputs\visualizations\rfm\rfm_heatmap.png
2026-02-13 21:30:30,163 - retention_system - INFO - Saved 3D scatter plot to: outputs\visualizations\rfm\rfm_3d_scatter.png
2026-02-13 21:30:30,579 - retention_system - INFO - Saved revenue contribution plot to: outputs\visualizations\rfm\revenue_contribution.png
2026-02-13 21:30:30,947 - retention_system - INFO - Saved feature importance plot to: outputs\visualizations\rfm\feature_importance.png
2026-02-13 21:30:31,530 - retention_system - INFO - Saved segment comparison plot to: outputs\visualizations\rfm\segment_comparison_radar.png
2026-02-13 21:30:31,542 - retention_system - INFO - ✓ Visualization report saved to: outputs\visualizations\rfm
2026-02-13 21:30:31,542 - retention_system - INFO - ✓ Visualizations saved to: outputs\visualizations\rfm
2026-02-13 21:30:31,543 - retention_system - INFO - Completed: Visualization Generation in 4.52 seconds
2026-02-13 21:30:31,543 - retention_system - INFO - Starting: Strategy Generation
2026-02-13 21:30:31,545 - retention_system - INFO - Saved strategy recommendations to: outputs\segment_strategies.json
2026-02-13 21:30:31,546 - retention_system - INFO - 
================================================================================
2026-02-13 21:30:31,546 - retention_system - INFO - SEGMENT STRATEGIES SUMMARY
2026-02-13 21:30:31,546 - retention_system - INFO - ================================================================================
2026-02-13 21:30:31,547 - retention_system - INFO - 
Hibernating (713 customers, 36.8%)
2026-02-13 21:30:31,547 - retention_system - INFO -   Priority: Medium
2026-02-13 21:30:31,547 - retention_system - INFO -   Goal: Reactivation
2026-02-13 21:30:31,548 - retention_system - INFO -   Campaign: Reactivation campaigns, deep discounts
2026-02-13 21:30:31,548 - retention_system - INFO -   Budget: Medium (ROI-dependent)
2026-02-13 21:30:31,548 - retention_system - INFO -   Revenue: $236,340.35
2026-02-13 21:30:31,548 - retention_system - INFO - 
Need Attention (884 customers, 45.6%)
2026-02-13 21:30:31,549 - retention_system - INFO -   Priority: Medium
2026-02-13 21:30:31,549 - retention_system - INFO -   Goal: Prevent decline
2026-02-13 21:30:31,549 - retention_system - INFO -   Campaign: Engagement emails, moderate discounts
2026-02-13 21:30:31,549 - retention_system - INFO -   Budget: Low-Medium
2026-02-13 21:30:31,550 - retention_system - INFO -   Revenue: $264,054.78
2026-02-13 21:30:31,550 - retention_system - INFO - 
Promising (10 customers, 0.5%)
2026-02-13 21:30:31,550 - retention_system - INFO -   Priority: Medium-High
2026-02-13 21:30:31,551 - retention_system - INFO -   Goal: Accelerate to Champions
2026-02-13 21:30:31,551 - retention_system - INFO -   Campaign: Frequency incentives, cross-category offers
2026-02-13 21:30:31,551 - retention_system - INFO -   Budget: Medium
2026-02-13 21:30:31,551 - retention_system - INFO -   Revenue: $83,494.30
2026-02-13 21:30:31,552 - retention_system - INFO - 
Promising (319 customers, 16.5%)
2026-02-13 21:30:31,552 - retention_system - INFO -   Priority: Medium-High
2026-02-13 21:30:31,552 - retention_system - INFO -   Goal: Accelerate to Champions
2026-02-13 21:30:31,552 - retention_system - INFO -   Campaign: Frequency incentives, cross-category offers
2026-02-13 21:30:31,553 - retention_system - INFO -   Budget: Medium
2026-02-13 21:30:31,553 - retention_system - INFO -   Revenue: $452,505.11
2026-02-13 21:30:31,553 - retention_system - INFO - 
Lost/Churned (11 customers, 0.6%)
2026-02-13 21:30:31,553 - retention_system - INFO -   Priority: Low
2026-02-13 21:30:31,554 - retention_system - INFO -   Goal: Low-cost reactivation attempts
2026-02-13 21:30:31,554 - retention_system - INFO -   Campaign: Automated win-back (low cost)
2026-02-13 21:30:31,554 - retention_system - INFO -   Budget: Low (only high-CLV customers)
2026-02-13 21:30:31,554 - retention_system - INFO -   Revenue: $12,016.69
2026-02-13 21:30:31,554 - retention_system - INFO - Completed: Strategy Generation in 0.01 seconds
2026-02-13 21:30:31,555 - retention_system - INFO - Starting: Model Saving
2026-02-13 21:30:31,559 - retention_system - INFO - Model saved to: models\rfm_segmenter.pkl
2026-02-13 21:30:31,559 - retention_system - INFO - ✓ Model saved to: models\rfm_segmenter.pkl
2026-02-13 21:30:31,560 - retention_system - INFO - Completed: Model Saving in 0.00 seconds
2026-02-13 21:30:31,561 - retention_system - INFO - Starting: Export Generation
2026-02-13 21:30:31,567 - retention_system - INFO - Business summary saved to: outputs\segment_summary.csv
2026-02-13 21:30:31,568 - retention_system - INFO - Completed: Export Generation in 0.01 seconds
2026-02-13 21:30:31,569 - retention_system - INFO - ✓ Task 1.1: Feature Loading - COMPLETE
2026-02-13 21:30:31,570 - retention_system - INFO - ✓ Task 1.2: K-Means Segmentation Model - COMPLETE
2026-02-13 21:30:31,570 - retention_system - INFO - ✓ Task 1.3: Segment Profiling - COMPLETE
2026-02-13 21:30:31,570 - retention_system - INFO - ✓ Task 1.4: Visualizations - COMPLETE
2026-02-13 21:30:31,571 - retention_system - INFO - 
================================================================================
2026-02-13 21:30:31,571 - retention_system - INFO - PILLAR 1 STATUS: 4/4 TASKS COMPLETE ✓
2026-02-13 21:30:31,571 - retention_system - INFO - ================================================================================
2026-02-13 21:30:31,572 - retention_system - INFO - 
Key Results:
2026-02-13 21:30:31,572 - retention_system - INFO -   - Number of segments: 5
2026-02-13 21:30:31,572 - retention_system - INFO -   - Customers segmented: 1,937
2026-02-13 21:30:31,573 - retention_system - INFO -   - Silhouette score: 400.4414
2026-02-13 21:30:31,573 - retention_system - INFO - 
Output files created:
2026-02-13 21:30:31,574 - retention_system - INFO -   1. Segment assignments: outputs\segment_assignments.parquet
2026-02-13 21:30:31,574 - retention_system - INFO -   2. Segment strategies: outputs\segment_strategies.json
2026-02-13 21:30:31,575 - retention_system - INFO -   3. Business summary: outputs\segment_summary.csv
2026-02-13 21:30:31,576 - retention_system - INFO -   4. Visualizations: outputs\visualizations\rfm/ (6 plots)
2026-02-13 21:30:31,576 - retention_system - INFO -   5. Trained model: models\rfm_segmenter.pkl
2026-02-13 21:30:31,576 - retention_system - INFO - 
Top 3 Segments by Size:
2026-02-13 21:30:31,579 - retention_system - INFO -   Need Attention: 884 (45.6%)
2026-02-13 21:30:31,579 - retention_system - INFO -   Hibernating: 713 (36.8%)
2026-02-13 21:30:31,580 - retention_system - INFO -   Promising: 319 (16.5%)
2026-02-13 21:30:31,580 - retention_system - INFO - 
Top 3 Segments by Revenue:
2026-02-13 21:30:31,582 - retention_system - INFO -   Promising: $452,505.11
2026-02-13 21:30:31,582 - retention_system - INFO -   Need Attention: $264,054.78
2026-02-13 21:30:31,583 - retention_system - INFO -   Hibernating: $236,340.35
2026-02-13 21:30:31,583 - retention_system - INFO - 
================================================================================
2026-02-13 21:30:31,583 - retention_system - INFO - OVERALL PROGRESS: 10/18 TASKS COMPLETE (56%)
2026-02-13 21:30:31,584 - retention_system - INFO - ================================================================================
2026-02-13 21:30:31,584 - retention_system - INFO - Pillar 0: ✓ Complete (6/6 tasks)
2026-02-13 21:30:31,585 - retention_system - INFO - Pillar 1: ✓ Complete (4/4 tasks)
2026-02-13 21:30:31,585 - retention_system - INFO - Pillar 2: ⏳ Pending (0/4 tasks) - Churn Prediction
2026-02-13 21:30:31,585 - retention_system - INFO - Pillar 3: ⏳ Pending (0/3 tasks) - CLV Prediction
2026-02-13 21:30:31,586 - retention_system - INFO - Pillar 4: ⏳ Pending (0/3 tasks) - Revenue Optimization
2026-02-13 21:30:31,586 - retention_system - INFO - 
Next steps:
2026-02-13 21:30:31,586 - retention_system - INFO -   → Proceed to Pillar 2: Churn Prediction
2026-02-13 21:30:31,587 - retention_system - INFO -   → Run: python pillar_2_churn.py
2026-02-13 21:31:27,119 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:31:27,120 - retention_system - INFO - Starting: Churn Label Creation
2026-02-13 21:31:27,121 - retention_system - INFO - Loading cleaned data from: data/processed/cleaned_data.parquet
2026-02-13 21:31:27,239 - retention_system - INFO - Loaded 163,246 transactions
2026-02-13 21:31:27,239 - retention_system - INFO - Loading features from: data/features/customer_features.parquet
2026-02-13 21:31:27,252 - retention_system - INFO - Loaded 13,843 feature rows
2026-02-13 21:31:27,253 - retention_system - INFO - Found 14 snapshots in features
2026-02-13 21:31:27,254 - retention_system - INFO - Using last 6 snapshots for efficiency
2026-02-13 21:31:27,254 - retention_system - INFO - 
Processing snapshot 1/6: 2011-03-31
2026-02-13 21:31:27,254 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,254 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-03-31
2026-02-13 21:31:27,255 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,255 - retention_system - INFO - Observation window: 2010-10-02 to 2011-03-31
2026-02-13 21:31:27,256 - retention_system - INFO - Prediction window: 2011-03-31 to 2011-06-29
2026-02-13 21:31:27,282 - retention_system - INFO - Transactions in observation window: 33,255
2026-02-13 21:31:27,282 - retention_system - INFO - Transactions in prediction window: 43,444
2026-02-13 21:31:27,293 - retention_system - INFO - Customers in observation window: 1,121
2026-02-13 21:31:27,295 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:31:27,296 - retention_system - INFO -   Initial customers: 1,121
2026-02-13 21:31:27,297 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:31:27,298 - retention_system - INFO -   Removed (< 30 days tenure): 232
2026-02-13 21:31:27,298 - retention_system - INFO -   Eligible customers: 831
2026-02-13 21:31:27,298 - retention_system - INFO - Eligible customers (after filters): 831
2026-02-13 21:31:27,352 - retention_system - INFO - 
================================================================================
2026-02-13 21:31:27,352 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:31:27,352 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,353 - retention_system - INFO - Total customers: 831
2026-02-13 21:31:27,353 - retention_system - INFO - Churned: 465 (55.96%)
2026-02-13 21:31:27,353 - retention_system - INFO - Active: 366 (44.04%)
2026-02-13 21:31:27,353 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:31:27,353 - retention_system - INFO -   Avg recency: 65.7 days
2026-02-13 21:31:27,353 - retention_system - INFO -   Avg frequency: 28.0 transactions
2026-02-13 21:31:27,354 - retention_system - INFO -   Avg revenue: $378.30
2026-02-13 21:31:27,354 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:31:27,354 - retention_system - INFO -   Avg recency: 58.1 days
2026-02-13 21:31:27,354 - retention_system - INFO -   Avg frequency: 40.1 transactions
2026-02-13 21:31:27,354 - retention_system - INFO -   Avg revenue: $580.42
2026-02-13 21:31:27,354 - retention_system - INFO - ================================================================================

2026-02-13 21:31:27,355 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:31:27,357 - retention_system - INFO - 
Processing snapshot 2/6: 2011-04-30
2026-02-13 21:31:27,357 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,358 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-04-30
2026-02-13 21:31:27,358 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,358 - retention_system - INFO - Observation window: 2010-11-01 to 2011-04-30
2026-02-13 21:31:27,359 - retention_system - INFO - Prediction window: 2011-04-30 to 2011-07-29
2026-02-13 21:31:27,386 - retention_system - INFO - Transactions in observation window: 46,202
2026-02-13 21:31:27,386 - retention_system - INFO - Transactions in prediction window: 43,190
2026-02-13 21:31:27,393 - retention_system - INFO - Customers in observation window: 1,388
2026-02-13 21:31:27,394 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:31:27,395 - retention_system - INFO -   Initial customers: 1,388
2026-02-13 21:31:27,395 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:31:27,396 - retention_system - INFO -   Removed (< 30 days tenure): 282
2026-02-13 21:31:27,396 - retention_system - INFO -   Eligible customers: 1,048
2026-02-13 21:31:27,396 - retention_system - INFO - Eligible customers (after filters): 1,048
2026-02-13 21:31:27,457 - retention_system - INFO - 
================================================================================
2026-02-13 21:31:27,457 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:31:27,457 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,457 - retention_system - INFO - Total customers: 1,048
2026-02-13 21:31:27,458 - retention_system - INFO - Churned: 575 (54.87%)
2026-02-13 21:31:27,458 - retention_system - INFO - Active: 473 (45.13%)
2026-02-13 21:31:27,458 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:31:27,458 - retention_system - INFO -   Avg recency: 74.2 days
2026-02-13 21:31:27,458 - retention_system - INFO -   Avg frequency: 30.7 transactions
2026-02-13 21:31:27,459 - retention_system - INFO -   Avg revenue: $407.15
2026-02-13 21:31:27,459 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:31:27,459 - retention_system - INFO -   Avg recency: 62.6 days
2026-02-13 21:31:27,459 - retention_system - INFO -   Avg frequency: 42.9 transactions
2026-02-13 21:31:27,459 - retention_system - INFO -   Avg revenue: $635.35
2026-02-13 21:31:27,460 - retention_system - INFO - ================================================================================

2026-02-13 21:31:27,460 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:31:27,463 - retention_system - INFO - 
Processing snapshot 3/6: 2011-05-31
2026-02-13 21:31:27,463 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,464 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-05-31
2026-02-13 21:31:27,464 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,464 - retention_system - INFO - Observation window: 2010-12-02 to 2011-05-31
2026-02-13 21:31:27,464 - retention_system - INFO - Prediction window: 2011-05-31 to 2011-08-29
2026-02-13 21:31:27,489 - retention_system - INFO - Transactions in observation window: 59,214
2026-02-13 21:31:27,490 - retention_system - INFO - Transactions in prediction window: 43,787
2026-02-13 21:31:27,500 - retention_system - INFO - Customers in observation window: 1,630
2026-02-13 21:31:27,502 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:31:27,502 - retention_system - INFO -   Initial customers: 1,630
2026-02-13 21:31:27,502 - retention_system - INFO -   Removed (< 2 transactions): 52
2026-02-13 21:31:27,503 - retention_system - INFO -   Removed (< 30 days tenure): 234
2026-02-13 21:31:27,503 - retention_system - INFO -   Eligible customers: 1,344
2026-02-13 21:31:27,503 - retention_system - INFO - Eligible customers (after filters): 1,344
2026-02-13 21:31:27,565 - retention_system - INFO - 
================================================================================
2026-02-13 21:31:27,566 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:31:27,566 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,566 - retention_system - INFO - Total customers: 1,344
2026-02-13 21:31:27,566 - retention_system - INFO - Churned: 750 (55.80%)
2026-02-13 21:31:27,566 - retention_system - INFO - Active: 594 (44.20%)
2026-02-13 21:31:27,567 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:31:27,567 - retention_system - INFO -   Avg recency: 85.3 days
2026-02-13 21:31:27,567 - retention_system - INFO -   Avg frequency: 33.0 transactions
2026-02-13 21:31:27,567 - retention_system - INFO -   Avg revenue: $418.85
2026-02-13 21:31:27,567 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:31:27,568 - retention_system - INFO -   Avg recency: 69.1 days
2026-02-13 21:31:27,568 - retention_system - INFO -   Avg frequency: 49.0 transactions
2026-02-13 21:31:27,568 - retention_system - INFO -   Avg revenue: $726.46
2026-02-13 21:31:27,568 - retention_system - INFO - ================================================================================

2026-02-13 21:31:27,568 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:31:27,571 - retention_system - INFO - 
Processing snapshot 4/6: 2011-06-30
2026-02-13 21:31:27,572 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,572 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-06-30
2026-02-13 21:31:27,572 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,573 - retention_system - INFO - Observation window: 2011-01-01 to 2011-06-30
2026-02-13 21:31:27,573 - retention_system - INFO - Prediction window: 2011-06-30 to 2011-09-28
2026-02-13 21:31:27,604 - retention_system - INFO - Transactions in observation window: 73,931
2026-02-13 21:31:27,605 - retention_system - INFO - Transactions in prediction window: 38,417
2026-02-13 21:31:27,613 - retention_system - INFO - Customers in observation window: 1,887
2026-02-13 21:31:27,616 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:31:27,617 - retention_system - INFO -   Initial customers: 1,887
2026-02-13 21:31:27,617 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:31:27,617 - retention_system - INFO -   Removed (< 30 days tenure): 263
2026-02-13 21:31:27,617 - retention_system - INFO -   Eligible customers: 1,571
2026-02-13 21:31:27,617 - retention_system - INFO - Eligible customers (after filters): 1,571
2026-02-13 21:31:27,688 - retention_system - INFO - 
================================================================================
2026-02-13 21:31:27,689 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:31:27,689 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,689 - retention_system - INFO - Total customers: 1,571
2026-02-13 21:31:27,690 - retention_system - INFO - Churned: 945 (60.15%)
2026-02-13 21:31:27,690 - retention_system - INFO - Active: 626 (39.85%)
2026-02-13 21:31:27,690 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:31:27,690 - retention_system - INFO -   Avg recency: 91.6 days
2026-02-13 21:31:27,691 - retention_system - INFO -   Avg frequency: 32.7 transactions
2026-02-13 21:31:27,691 - retention_system - INFO -   Avg revenue: $430.26
2026-02-13 21:31:27,691 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:31:27,691 - retention_system - INFO -   Avg recency: 70.9 days
2026-02-13 21:31:27,692 - retention_system - INFO -   Avg frequency: 58.0 transactions
2026-02-13 21:31:27,692 - retention_system - INFO -   Avg revenue: $836.32
2026-02-13 21:31:27,692 - retention_system - INFO - ================================================================================

2026-02-13 21:31:27,692 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:31:27,698 - retention_system - INFO - 
Processing snapshot 5/6: 2011-07-31
2026-02-13 21:31:27,698 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,699 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-07-31
2026-02-13 21:31:27,699 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,699 - retention_system - INFO - Observation window: 2011-02-01 to 2011-07-31
2026-02-13 21:31:27,699 - retention_system - INFO - Prediction window: 2011-07-31 to 2011-10-29
2026-02-13 21:31:27,722 - retention_system - INFO - Transactions in observation window: 76,697
2026-02-13 21:31:27,723 - retention_system - INFO - Transactions in prediction window: 36,655
2026-02-13 21:31:27,733 - retention_system - INFO - Customers in observation window: 1,922
2026-02-13 21:31:27,735 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:31:27,735 - retention_system - INFO -   Initial customers: 1,922
2026-02-13 21:31:27,736 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:31:27,736 - retention_system - INFO -   Removed (< 30 days tenure): 228
2026-02-13 21:31:27,736 - retention_system - INFO -   Eligible customers: 1,641
2026-02-13 21:31:27,736 - retention_system - INFO - Eligible customers (after filters): 1,641
2026-02-13 21:31:27,822 - retention_system - INFO - 
================================================================================
2026-02-13 21:31:27,822 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:31:27,823 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,823 - retention_system - INFO - Total customers: 1,641
2026-02-13 21:31:27,823 - retention_system - INFO - Churned: 1,010 (61.55%)
2026-02-13 21:31:27,823 - retention_system - INFO - Active: 631 (38.45%)
2026-02-13 21:31:27,823 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:31:27,824 - retention_system - INFO -   Avg recency: 87.2 days
2026-02-13 21:31:27,824 - retention_system - INFO -   Avg frequency: 34.2 transactions
2026-02-13 21:31:27,824 - retention_system - INFO -   Avg revenue: $432.45
2026-02-13 21:31:27,824 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:31:27,825 - retention_system - INFO -   Avg recency: 69.5 days
2026-02-13 21:31:27,825 - retention_system - INFO -   Avg frequency: 57.4 transactions
2026-02-13 21:31:27,825 - retention_system - INFO -   Avg revenue: $828.48
2026-02-13 21:31:27,825 - retention_system - INFO - ================================================================================

2026-02-13 21:31:27,825 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:31:27,829 - retention_system - INFO - 
Processing snapshot 6/6: 2011-08-31
2026-02-13 21:31:27,829 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,830 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-08-31
2026-02-13 21:31:27,830 - retention_system - INFO - ================================================================================
2026-02-13 21:31:27,831 - retention_system - INFO - Observation window: 2011-03-04 to 2011-08-31
2026-02-13 21:31:27,831 - retention_system - INFO - Prediction window: 2011-08-31 to 2011-11-29
2026-02-13 21:31:27,856 - retention_system - INFO - Transactions in observation window: 78,812
2026-02-13 21:31:27,856 - retention_system - INFO - Transactions in prediction window: 35,891
2026-02-13 21:31:27,871 - retention_system - INFO - Customers in observation window: 1,937
2026-02-13 21:31:27,874 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:31:27,874 - retention_system - INFO -   Initial customers: 1,937
2026-02-13 21:31:27,874 - retention_system - INFO -   Removed (< 2 transactions): 50
2026-02-13 21:31:27,875 - retention_system - INFO -   Removed (< 30 days tenure): 198
2026-02-13 21:31:27,875 - retention_system - INFO -   Eligible customers: 1,689
2026-02-13 21:31:27,875 - retention_system - INFO - Eligible customers (after filters): 1,689
2026-02-13 21:31:28,030 - retention_system - INFO - 
================================================================================
2026-02-13 21:31:28,030 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:31:28,030 - retention_system - INFO - ================================================================================
2026-02-13 21:31:28,031 - retention_system - INFO - Total customers: 1,689
2026-02-13 21:31:28,031 - retention_system - INFO - Churned: 1,055 (62.46%)
2026-02-13 21:31:28,031 - retention_system - INFO - Active: 634 (37.54%)
2026-02-13 21:31:28,031 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:31:28,031 - retention_system - INFO -   Avg recency: 88.3 days
2026-02-13 21:31:28,032 - retention_system - INFO -   Avg frequency: 35.3 transactions
2026-02-13 21:31:28,032 - retention_system - INFO -   Avg revenue: $435.74
2026-02-13 21:31:28,032 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:31:28,032 - retention_system - INFO -   Avg recency: 70.5 days
2026-02-13 21:31:28,032 - retention_system - INFO -   Avg frequency: 58.1 transactions
2026-02-13 21:31:28,032 - retention_system - INFO -   Avg revenue: $825.98
2026-02-13 21:31:28,033 - retention_system - INFO - ================================================================================

2026-02-13 21:31:28,033 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:31:28,037 - retention_system - INFO - 
✓ Created labels for 6 snapshots
2026-02-13 21:31:28,037 - retention_system - INFO - Total label rows: 8,124
2026-02-13 21:31:28,037 - retention_system - INFO - 
✓ Created 8,124 labels across 6 snapshots
2026-02-13 21:31:28,038 - retention_system - INFO - Overall churn rate: 59.08%
2026-02-13 21:31:28,050 - retention_system - INFO - Saved labels to: outputs\churn_labels.parquet
2026-02-13 21:31:28,054 - retention_system - INFO - Saved statistics to: outputs\churn_label_statistics.csv
2026-02-13 21:31:28,054 - retention_system - INFO - Completed: Churn Label Creation in 0.93 seconds
2026-02-13 21:31:28,055 - retention_system - INFO - Starting: Data Preparation
2026-02-13 21:31:28,055 - retention_system - INFO - ================================================================================
2026-02-13 21:31:28,055 - retention_system - INFO - PREPARING DATA FOR CHURN PREDICTION
2026-02-13 21:31:28,056 - retention_system - INFO - ================================================================================
2026-02-13 21:31:28,061 - retention_system - INFO - Completed: Data Preparation in 0.01 seconds
2026-02-13 21:34:48,541 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:34:48,542 - retention_system - INFO - Starting: Churn Label Creation
2026-02-13 21:34:48,543 - retention_system - INFO - Loading cleaned data from: data/processed/cleaned_data.parquet
2026-02-13 21:34:48,641 - retention_system - INFO - Loaded 163,246 transactions
2026-02-13 21:34:48,641 - retention_system - INFO - Loading features from: data/features/customer_features.parquet
2026-02-13 21:34:48,650 - retention_system - INFO - Loaded 13,843 feature rows
2026-02-13 21:34:48,652 - retention_system - INFO - Found 14 snapshots in features
2026-02-13 21:34:48,652 - retention_system - INFO - Using last 6 snapshots for efficiency
2026-02-13 21:34:48,652 - retention_system - INFO - 
Processing snapshot 1/6: 2011-03-31
2026-02-13 21:34:48,653 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,653 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-03-31
2026-02-13 21:34:48,653 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,653 - retention_system - INFO - Observation window: 2010-10-02 to 2011-03-31
2026-02-13 21:34:48,654 - retention_system - INFO - Prediction window: 2011-03-31 to 2011-06-29
2026-02-13 21:34:48,672 - retention_system - INFO - Transactions in observation window: 33,255
2026-02-13 21:34:48,672 - retention_system - INFO - Transactions in prediction window: 43,444
2026-02-13 21:34:48,679 - retention_system - INFO - Customers in observation window: 1,121
2026-02-13 21:34:48,680 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:34:48,681 - retention_system - INFO -   Initial customers: 1,121
2026-02-13 21:34:48,681 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:34:48,681 - retention_system - INFO -   Removed (< 30 days tenure): 232
2026-02-13 21:34:48,681 - retention_system - INFO -   Eligible customers: 831
2026-02-13 21:34:48,682 - retention_system - INFO - Eligible customers (after filters): 831
2026-02-13 21:34:48,720 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:48,721 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:34:48,721 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,721 - retention_system - INFO - Total customers: 831
2026-02-13 21:34:48,721 - retention_system - INFO - Churned: 465 (55.96%)
2026-02-13 21:34:48,722 - retention_system - INFO - Active: 366 (44.04%)
2026-02-13 21:34:48,722 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:34:48,722 - retention_system - INFO -   Avg recency: 65.7 days
2026-02-13 21:34:48,722 - retention_system - INFO -   Avg frequency: 28.0 transactions
2026-02-13 21:34:48,722 - retention_system - INFO -   Avg revenue: $378.30
2026-02-13 21:34:48,722 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:34:48,723 - retention_system - INFO -   Avg recency: 58.1 days
2026-02-13 21:34:48,723 - retention_system - INFO -   Avg frequency: 40.1 transactions
2026-02-13 21:34:48,723 - retention_system - INFO -   Avg revenue: $580.42
2026-02-13 21:34:48,723 - retention_system - INFO - ================================================================================

2026-02-13 21:34:48,723 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:34:48,726 - retention_system - INFO - 
Processing snapshot 2/6: 2011-04-30
2026-02-13 21:34:48,726 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,726 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-04-30
2026-02-13 21:34:48,726 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,727 - retention_system - INFO - Observation window: 2010-11-01 to 2011-04-30
2026-02-13 21:34:48,727 - retention_system - INFO - Prediction window: 2011-04-30 to 2011-07-29
2026-02-13 21:34:48,745 - retention_system - INFO - Transactions in observation window: 46,202
2026-02-13 21:34:48,746 - retention_system - INFO - Transactions in prediction window: 43,190
2026-02-13 21:34:48,755 - retention_system - INFO - Customers in observation window: 1,388
2026-02-13 21:34:48,756 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:34:48,756 - retention_system - INFO -   Initial customers: 1,388
2026-02-13 21:34:48,757 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:34:48,757 - retention_system - INFO -   Removed (< 30 days tenure): 282
2026-02-13 21:34:48,757 - retention_system - INFO -   Eligible customers: 1,048
2026-02-13 21:34:48,757 - retention_system - INFO - Eligible customers (after filters): 1,048
2026-02-13 21:34:48,815 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:48,816 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:34:48,816 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,817 - retention_system - INFO - Total customers: 1,048
2026-02-13 21:34:48,818 - retention_system - INFO - Churned: 575 (54.87%)
2026-02-13 21:34:48,818 - retention_system - INFO - Active: 473 (45.13%)
2026-02-13 21:34:48,818 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:34:48,819 - retention_system - INFO -   Avg recency: 74.2 days
2026-02-13 21:34:48,819 - retention_system - INFO -   Avg frequency: 30.7 transactions
2026-02-13 21:34:48,819 - retention_system - INFO -   Avg revenue: $407.15
2026-02-13 21:34:48,819 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:34:48,820 - retention_system - INFO -   Avg recency: 62.6 days
2026-02-13 21:34:48,820 - retention_system - INFO -   Avg frequency: 42.9 transactions
2026-02-13 21:34:48,820 - retention_system - INFO -   Avg revenue: $635.35
2026-02-13 21:34:48,821 - retention_system - INFO - ================================================================================

2026-02-13 21:34:48,821 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:34:48,825 - retention_system - INFO - 
Processing snapshot 3/6: 2011-05-31
2026-02-13 21:34:48,825 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,826 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-05-31
2026-02-13 21:34:48,826 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,826 - retention_system - INFO - Observation window: 2010-12-02 to 2011-05-31
2026-02-13 21:34:48,827 - retention_system - INFO - Prediction window: 2011-05-31 to 2011-08-29
2026-02-13 21:34:48,856 - retention_system - INFO - Transactions in observation window: 59,214
2026-02-13 21:34:48,856 - retention_system - INFO - Transactions in prediction window: 43,787
2026-02-13 21:34:48,865 - retention_system - INFO - Customers in observation window: 1,630
2026-02-13 21:34:48,868 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:34:48,869 - retention_system - INFO -   Initial customers: 1,630
2026-02-13 21:34:48,869 - retention_system - INFO -   Removed (< 2 transactions): 52
2026-02-13 21:34:48,870 - retention_system - INFO -   Removed (< 30 days tenure): 234
2026-02-13 21:34:48,871 - retention_system - INFO -   Eligible customers: 1,344
2026-02-13 21:34:48,871 - retention_system - INFO - Eligible customers (after filters): 1,344
2026-02-13 21:34:48,939 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:48,939 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:34:48,939 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,940 - retention_system - INFO - Total customers: 1,344
2026-02-13 21:34:48,940 - retention_system - INFO - Churned: 750 (55.80%)
2026-02-13 21:34:48,940 - retention_system - INFO - Active: 594 (44.20%)
2026-02-13 21:34:48,940 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:34:48,941 - retention_system - INFO -   Avg recency: 85.3 days
2026-02-13 21:34:48,941 - retention_system - INFO -   Avg frequency: 33.0 transactions
2026-02-13 21:34:48,941 - retention_system - INFO -   Avg revenue: $418.85
2026-02-13 21:34:48,941 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:34:48,942 - retention_system - INFO -   Avg recency: 69.1 days
2026-02-13 21:34:48,942 - retention_system - INFO -   Avg frequency: 49.0 transactions
2026-02-13 21:34:48,942 - retention_system - INFO -   Avg revenue: $726.46
2026-02-13 21:34:48,942 - retention_system - INFO - ================================================================================

2026-02-13 21:34:48,942 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:34:48,945 - retention_system - INFO - 
Processing snapshot 4/6: 2011-06-30
2026-02-13 21:34:48,945 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,946 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-06-30
2026-02-13 21:34:48,946 - retention_system - INFO - ================================================================================
2026-02-13 21:34:48,946 - retention_system - INFO - Observation window: 2011-01-01 to 2011-06-30
2026-02-13 21:34:48,947 - retention_system - INFO - Prediction window: 2011-06-30 to 2011-09-28
2026-02-13 21:34:48,971 - retention_system - INFO - Transactions in observation window: 73,931
2026-02-13 21:34:48,972 - retention_system - INFO - Transactions in prediction window: 38,417
2026-02-13 21:34:48,983 - retention_system - INFO - Customers in observation window: 1,887
2026-02-13 21:34:48,988 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:34:48,988 - retention_system - INFO -   Initial customers: 1,887
2026-02-13 21:34:48,988 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:34:48,989 - retention_system - INFO -   Removed (< 30 days tenure): 263
2026-02-13 21:34:48,989 - retention_system - INFO -   Eligible customers: 1,571
2026-02-13 21:34:48,989 - retention_system - INFO - Eligible customers (after filters): 1,571
2026-02-13 21:34:49,057 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:49,058 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:34:49,058 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,058 - retention_system - INFO - Total customers: 1,571
2026-02-13 21:34:49,058 - retention_system - INFO - Churned: 945 (60.15%)
2026-02-13 21:34:49,059 - retention_system - INFO - Active: 626 (39.85%)
2026-02-13 21:34:49,059 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:34:49,059 - retention_system - INFO -   Avg recency: 91.6 days
2026-02-13 21:34:49,059 - retention_system - INFO -   Avg frequency: 32.7 transactions
2026-02-13 21:34:49,059 - retention_system - INFO -   Avg revenue: $430.26
2026-02-13 21:34:49,059 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:34:49,060 - retention_system - INFO -   Avg recency: 70.9 days
2026-02-13 21:34:49,060 - retention_system - INFO -   Avg frequency: 58.0 transactions
2026-02-13 21:34:49,060 - retention_system - INFO -   Avg revenue: $836.32
2026-02-13 21:34:49,060 - retention_system - INFO - ================================================================================

2026-02-13 21:34:49,060 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:34:49,063 - retention_system - INFO - 
Processing snapshot 5/6: 2011-07-31
2026-02-13 21:34:49,063 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,064 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-07-31
2026-02-13 21:34:49,064 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,064 - retention_system - INFO - Observation window: 2011-02-01 to 2011-07-31
2026-02-13 21:34:49,065 - retention_system - INFO - Prediction window: 2011-07-31 to 2011-10-29
2026-02-13 21:34:49,102 - retention_system - INFO - Transactions in observation window: 76,697
2026-02-13 21:34:49,103 - retention_system - INFO - Transactions in prediction window: 36,655
2026-02-13 21:34:49,124 - retention_system - INFO - Customers in observation window: 1,922
2026-02-13 21:34:49,127 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:34:49,127 - retention_system - INFO -   Initial customers: 1,922
2026-02-13 21:34:49,127 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:34:49,128 - retention_system - INFO -   Removed (< 30 days tenure): 228
2026-02-13 21:34:49,128 - retention_system - INFO -   Eligible customers: 1,641
2026-02-13 21:34:49,128 - retention_system - INFO - Eligible customers (after filters): 1,641
2026-02-13 21:34:49,227 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:49,227 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:34:49,227 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,228 - retention_system - INFO - Total customers: 1,641
2026-02-13 21:34:49,228 - retention_system - INFO - Churned: 1,010 (61.55%)
2026-02-13 21:34:49,228 - retention_system - INFO - Active: 631 (38.45%)
2026-02-13 21:34:49,228 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:34:49,229 - retention_system - INFO -   Avg recency: 87.2 days
2026-02-13 21:34:49,229 - retention_system - INFO -   Avg frequency: 34.2 transactions
2026-02-13 21:34:49,229 - retention_system - INFO -   Avg revenue: $432.45
2026-02-13 21:34:49,229 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:34:49,230 - retention_system - INFO -   Avg recency: 69.5 days
2026-02-13 21:34:49,230 - retention_system - INFO -   Avg frequency: 57.4 transactions
2026-02-13 21:34:49,230 - retention_system - INFO -   Avg revenue: $828.48
2026-02-13 21:34:49,230 - retention_system - INFO - ================================================================================

2026-02-13 21:34:49,231 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:34:49,235 - retention_system - INFO - 
Processing snapshot 6/6: 2011-08-31
2026-02-13 21:34:49,236 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,236 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-08-31
2026-02-13 21:34:49,236 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,237 - retention_system - INFO - Observation window: 2011-03-04 to 2011-08-31
2026-02-13 21:34:49,237 - retention_system - INFO - Prediction window: 2011-08-31 to 2011-11-29
2026-02-13 21:34:49,270 - retention_system - INFO - Transactions in observation window: 78,812
2026-02-13 21:34:49,271 - retention_system - INFO - Transactions in prediction window: 35,891
2026-02-13 21:34:49,284 - retention_system - INFO - Customers in observation window: 1,937
2026-02-13 21:34:49,287 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:34:49,289 - retention_system - INFO -   Initial customers: 1,937
2026-02-13 21:34:49,289 - retention_system - INFO -   Removed (< 2 transactions): 50
2026-02-13 21:34:49,289 - retention_system - INFO -   Removed (< 30 days tenure): 198
2026-02-13 21:34:49,290 - retention_system - INFO -   Eligible customers: 1,689
2026-02-13 21:34:49,290 - retention_system - INFO - Eligible customers (after filters): 1,689
2026-02-13 21:34:49,394 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:49,395 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:34:49,395 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,395 - retention_system - INFO - Total customers: 1,689
2026-02-13 21:34:49,396 - retention_system - INFO - Churned: 1,055 (62.46%)
2026-02-13 21:34:49,396 - retention_system - INFO - Active: 634 (37.54%)
2026-02-13 21:34:49,397 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:34:49,397 - retention_system - INFO -   Avg recency: 88.3 days
2026-02-13 21:34:49,398 - retention_system - INFO -   Avg frequency: 35.3 transactions
2026-02-13 21:34:49,398 - retention_system - INFO -   Avg revenue: $435.74
2026-02-13 21:34:49,398 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:34:49,398 - retention_system - INFO -   Avg recency: 70.5 days
2026-02-13 21:34:49,399 - retention_system - INFO -   Avg frequency: 58.1 transactions
2026-02-13 21:34:49,400 - retention_system - INFO -   Avg revenue: $825.98
2026-02-13 21:34:49,400 - retention_system - INFO - ================================================================================

2026-02-13 21:34:49,401 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:34:49,411 - retention_system - INFO - 
✓ Created labels for 6 snapshots
2026-02-13 21:34:49,412 - retention_system - INFO - Total label rows: 8,124
2026-02-13 21:34:49,412 - retention_system - INFO - 
✓ Created 8,124 labels across 6 snapshots
2026-02-13 21:34:49,413 - retention_system - INFO - Overall churn rate: 59.08%
2026-02-13 21:34:49,427 - retention_system - INFO - Saved labels to: outputs\churn_labels.parquet
2026-02-13 21:34:49,434 - retention_system - INFO - Saved statistics to: outputs\churn_label_statistics.csv
2026-02-13 21:34:49,436 - retention_system - INFO - Completed: Churn Label Creation in 0.89 seconds
2026-02-13 21:34:49,438 - retention_system - INFO - Starting: Data Preparation
2026-02-13 21:34:49,439 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,439 - retention_system - INFO - PREPARING DATA FOR CHURN PREDICTION
2026-02-13 21:34:49,439 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,470 - retention_system - INFO - Total samples: 56,052
2026-02-13 21:34:49,471 - retention_system - INFO - Features: 36
2026-02-13 21:34:49,524 - retention_system - INFO - Selected 33 features for training
2026-02-13 21:34:49,595 - retention_system - INFO - 
Class distribution:
2026-02-13 21:34:49,596 - retention_system - INFO -   Train: Churned=20,711 (51.3%), Active=19,646 (48.7%)
2026-02-13 21:34:49,597 - retention_system - WARNING -     ⚠️  Train has extreme churn rate (51.3%)
2026-02-13 21:34:49,598 - retention_system - INFO -   Val: Churned=2,519 (56.2%), Active=1,965 (43.8%)
2026-02-13 21:34:49,598 - retention_system - WARNING -     ⚠️  Val has extreme churn rate (56.2%)
2026-02-13 21:34:49,599 - retention_system - INFO -   Test: Churned=6,267 (55.9%), Active=4,944 (44.1%)
2026-02-13 21:34:49,600 - retention_system - WARNING -     ⚠️  Test has extreme churn rate (55.9%)
2026-02-13 21:34:49,600 - retention_system - INFO - 
Train set: 40,357 samples
2026-02-13 21:34:49,600 - retention_system - INFO - Validation set: 4,484 samples
2026-02-13 21:34:49,600 - retention_system - INFO - Test set: 11,211 samples
2026-02-13 21:34:49,602 - retention_system - INFO - 
✓ Data prepared successfully
2026-02-13 21:34:49,603 - retention_system - INFO - Train: 40,357, Val: 4,484, Test: 11,211
2026-02-13 21:34:49,603 - retention_system - INFO - Completed: Data Preparation in 0.17 seconds
2026-02-13 21:34:49,604 - retention_system - INFO - Starting: Model Training
2026-02-13 21:34:49,604 - retention_system - INFO - 
================================================================================
2026-02-13 21:34:49,605 - retention_system - INFO - TRAINING CHURN PREDICTION MODEL
2026-02-13 21:34:49,605 - retention_system - INFO - ================================================================================
2026-02-13 21:34:49,606 - retention_system - INFO - Using class weight: 0.95
2026-02-13 21:34:49,607 - retention_system - INFO - 
Model hyperparameters:
2026-02-13 21:34:49,607 - retention_system - INFO -   objective: binary
2026-02-13 21:34:49,607 - retention_system - INFO -   metric: auc
2026-02-13 21:34:49,608 - retention_system - INFO -   boosting_type: gbdt
2026-02-13 21:34:49,608 - retention_system - INFO -   num_leaves: 31
2026-02-13 21:34:49,608 - retention_system - INFO -   learning_rate: 0.05
2026-02-13 21:34:49,609 - retention_system - INFO -   feature_fraction: 0.8
2026-02-13 21:34:49,609 - retention_system - INFO -   bagging_fraction: 0.8
2026-02-13 21:34:49,609 - retention_system - INFO -   bagging_freq: 5
2026-02-13 21:34:49,609 - retention_system - INFO -   max_depth: 7
2026-02-13 21:34:49,609 - retention_system - INFO -   min_child_samples: 20
2026-02-13 21:34:49,610 - retention_system - INFO -   scale_pos_weight: 0.9485780503114287
2026-02-13 21:34:49,610 - retention_system - INFO -   verbose: -1
2026-02-13 21:34:49,610 - retention_system - INFO -   random_state: 42
2026-02-13 21:34:49,610 - retention_system - INFO - 
Training LightGBM model...
2026-02-13 21:34:49,611 - retention_system - INFO - Completed: Model Training in 0.01 seconds
2026-02-13 21:38:12,230 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:38:12,231 - retention_system - INFO - Starting: Churn Label Creation
2026-02-13 21:38:12,232 - retention_system - INFO - Loading cleaned data from: data/processed/cleaned_data.parquet
2026-02-13 21:38:12,342 - retention_system - INFO - Loaded 163,246 transactions
2026-02-13 21:38:12,343 - retention_system - INFO - Loading features from: data/features/customer_features.parquet
2026-02-13 21:38:12,352 - retention_system - INFO - Loaded 13,843 feature rows
2026-02-13 21:38:12,353 - retention_system - INFO - Found 14 snapshots in features
2026-02-13 21:38:12,353 - retention_system - INFO - Using last 6 snapshots for efficiency
2026-02-13 21:38:12,354 - retention_system - INFO - 
Processing snapshot 1/6: 2011-03-31
2026-02-13 21:38:12,354 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,354 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-03-31
2026-02-13 21:38:12,354 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,355 - retention_system - INFO - Observation window: 2010-10-02 to 2011-03-31
2026-02-13 21:38:12,355 - retention_system - INFO - Prediction window: 2011-03-31 to 2011-06-29
2026-02-13 21:38:12,375 - retention_system - INFO - Transactions in observation window: 33,255
2026-02-13 21:38:12,375 - retention_system - INFO - Transactions in prediction window: 43,444
2026-02-13 21:38:12,386 - retention_system - INFO - Customers in observation window: 1,121
2026-02-13 21:38:12,390 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:38:12,391 - retention_system - INFO -   Initial customers: 1,121
2026-02-13 21:38:12,391 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:38:12,391 - retention_system - INFO -   Removed (< 30 days tenure): 232
2026-02-13 21:38:12,391 - retention_system - INFO -   Eligible customers: 831
2026-02-13 21:38:12,391 - retention_system - INFO - Eligible customers (after filters): 831
2026-02-13 21:38:12,431 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:12,431 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:38:12,431 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,432 - retention_system - INFO - Total customers: 831
2026-02-13 21:38:12,432 - retention_system - INFO - Churned: 465 (55.96%)
2026-02-13 21:38:12,432 - retention_system - INFO - Active: 366 (44.04%)
2026-02-13 21:38:12,433 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:38:12,433 - retention_system - INFO -   Avg recency: 65.7 days
2026-02-13 21:38:12,433 - retention_system - INFO -   Avg frequency: 28.0 transactions
2026-02-13 21:38:12,434 - retention_system - INFO -   Avg revenue: $378.30
2026-02-13 21:38:12,434 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:38:12,434 - retention_system - INFO -   Avg recency: 58.1 days
2026-02-13 21:38:12,435 - retention_system - INFO -   Avg frequency: 40.1 transactions
2026-02-13 21:38:12,435 - retention_system - INFO -   Avg revenue: $580.42
2026-02-13 21:38:12,435 - retention_system - INFO - ================================================================================

2026-02-13 21:38:12,436 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:38:12,439 - retention_system - INFO - 
Processing snapshot 2/6: 2011-04-30
2026-02-13 21:38:12,440 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,440 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-04-30
2026-02-13 21:38:12,440 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,441 - retention_system - INFO - Observation window: 2010-11-01 to 2011-04-30
2026-02-13 21:38:12,441 - retention_system - INFO - Prediction window: 2011-04-30 to 2011-07-29
2026-02-13 21:38:12,460 - retention_system - INFO - Transactions in observation window: 46,202
2026-02-13 21:38:12,461 - retention_system - INFO - Transactions in prediction window: 43,190
2026-02-13 21:38:12,470 - retention_system - INFO - Customers in observation window: 1,388
2026-02-13 21:38:12,473 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:38:12,473 - retention_system - INFO -   Initial customers: 1,388
2026-02-13 21:38:12,473 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:38:12,474 - retention_system - INFO -   Removed (< 30 days tenure): 282
2026-02-13 21:38:12,474 - retention_system - INFO -   Eligible customers: 1,048
2026-02-13 21:38:12,474 - retention_system - INFO - Eligible customers (after filters): 1,048
2026-02-13 21:38:12,523 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:12,524 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:38:12,524 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,524 - retention_system - INFO - Total customers: 1,048
2026-02-13 21:38:12,524 - retention_system - INFO - Churned: 575 (54.87%)
2026-02-13 21:38:12,524 - retention_system - INFO - Active: 473 (45.13%)
2026-02-13 21:38:12,525 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:38:12,525 - retention_system - INFO -   Avg recency: 74.2 days
2026-02-13 21:38:12,525 - retention_system - INFO -   Avg frequency: 30.7 transactions
2026-02-13 21:38:12,525 - retention_system - INFO -   Avg revenue: $407.15
2026-02-13 21:38:12,525 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:38:12,526 - retention_system - INFO -   Avg recency: 62.6 days
2026-02-13 21:38:12,526 - retention_system - INFO -   Avg frequency: 42.9 transactions
2026-02-13 21:38:12,526 - retention_system - INFO -   Avg revenue: $635.35
2026-02-13 21:38:12,526 - retention_system - INFO - ================================================================================

2026-02-13 21:38:12,526 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:38:12,529 - retention_system - INFO - 
Processing snapshot 3/6: 2011-05-31
2026-02-13 21:38:12,529 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,529 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-05-31
2026-02-13 21:38:12,529 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,530 - retention_system - INFO - Observation window: 2010-12-02 to 2011-05-31
2026-02-13 21:38:12,530 - retention_system - INFO - Prediction window: 2011-05-31 to 2011-08-29
2026-02-13 21:38:12,552 - retention_system - INFO - Transactions in observation window: 59,214
2026-02-13 21:38:12,552 - retention_system - INFO - Transactions in prediction window: 43,787
2026-02-13 21:38:12,560 - retention_system - INFO - Customers in observation window: 1,630
2026-02-13 21:38:12,562 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:38:12,562 - retention_system - INFO -   Initial customers: 1,630
2026-02-13 21:38:12,562 - retention_system - INFO -   Removed (< 2 transactions): 52
2026-02-13 21:38:12,563 - retention_system - INFO -   Removed (< 30 days tenure): 234
2026-02-13 21:38:12,563 - retention_system - INFO -   Eligible customers: 1,344
2026-02-13 21:38:12,563 - retention_system - INFO - Eligible customers (after filters): 1,344
2026-02-13 21:38:12,626 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:12,626 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:38:12,626 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,626 - retention_system - INFO - Total customers: 1,344
2026-02-13 21:38:12,627 - retention_system - INFO - Churned: 750 (55.80%)
2026-02-13 21:38:12,627 - retention_system - INFO - Active: 594 (44.20%)
2026-02-13 21:38:12,627 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:38:12,627 - retention_system - INFO -   Avg recency: 85.3 days
2026-02-13 21:38:12,628 - retention_system - INFO -   Avg frequency: 33.0 transactions
2026-02-13 21:38:12,628 - retention_system - INFO -   Avg revenue: $418.85
2026-02-13 21:38:12,628 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:38:12,629 - retention_system - INFO -   Avg recency: 69.1 days
2026-02-13 21:38:12,629 - retention_system - INFO -   Avg frequency: 49.0 transactions
2026-02-13 21:38:12,629 - retention_system - INFO -   Avg revenue: $726.46
2026-02-13 21:38:12,629 - retention_system - INFO - ================================================================================

2026-02-13 21:38:12,629 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:38:12,634 - retention_system - INFO - 
Processing snapshot 4/6: 2011-06-30
2026-02-13 21:38:12,635 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,635 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-06-30
2026-02-13 21:38:12,635 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,636 - retention_system - INFO - Observation window: 2011-01-01 to 2011-06-30
2026-02-13 21:38:12,636 - retention_system - INFO - Prediction window: 2011-06-30 to 2011-09-28
2026-02-13 21:38:12,663 - retention_system - INFO - Transactions in observation window: 73,931
2026-02-13 21:38:12,664 - retention_system - INFO - Transactions in prediction window: 38,417
2026-02-13 21:38:12,674 - retention_system - INFO - Customers in observation window: 1,887
2026-02-13 21:38:12,676 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:38:12,676 - retention_system - INFO -   Initial customers: 1,887
2026-02-13 21:38:12,677 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:38:12,677 - retention_system - INFO -   Removed (< 30 days tenure): 263
2026-02-13 21:38:12,677 - retention_system - INFO -   Eligible customers: 1,571
2026-02-13 21:38:12,677 - retention_system - INFO - Eligible customers (after filters): 1,571
2026-02-13 21:38:12,773 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:12,774 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:38:12,774 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,774 - retention_system - INFO - Total customers: 1,571
2026-02-13 21:38:12,774 - retention_system - INFO - Churned: 945 (60.15%)
2026-02-13 21:38:12,775 - retention_system - INFO - Active: 626 (39.85%)
2026-02-13 21:38:12,775 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:38:12,775 - retention_system - INFO -   Avg recency: 91.6 days
2026-02-13 21:38:12,775 - retention_system - INFO -   Avg frequency: 32.7 transactions
2026-02-13 21:38:12,776 - retention_system - INFO -   Avg revenue: $430.26
2026-02-13 21:38:12,776 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:38:12,776 - retention_system - INFO -   Avg recency: 70.9 days
2026-02-13 21:38:12,776 - retention_system - INFO -   Avg frequency: 58.0 transactions
2026-02-13 21:38:12,776 - retention_system - INFO -   Avg revenue: $836.32
2026-02-13 21:38:12,777 - retention_system - INFO - ================================================================================

2026-02-13 21:38:12,777 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:38:12,783 - retention_system - INFO - 
Processing snapshot 5/6: 2011-07-31
2026-02-13 21:38:12,783 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,784 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-07-31
2026-02-13 21:38:12,785 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,787 - retention_system - INFO - Observation window: 2011-02-01 to 2011-07-31
2026-02-13 21:38:12,788 - retention_system - INFO - Prediction window: 2011-07-31 to 2011-10-29
2026-02-13 21:38:12,826 - retention_system - INFO - Transactions in observation window: 76,697
2026-02-13 21:38:12,827 - retention_system - INFO - Transactions in prediction window: 36,655
2026-02-13 21:38:12,840 - retention_system - INFO - Customers in observation window: 1,922
2026-02-13 21:38:12,842 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:38:12,842 - retention_system - INFO -   Initial customers: 1,922
2026-02-13 21:38:12,843 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:38:12,843 - retention_system - INFO -   Removed (< 30 days tenure): 228
2026-02-13 21:38:12,843 - retention_system - INFO -   Eligible customers: 1,641
2026-02-13 21:38:12,843 - retention_system - INFO - Eligible customers (after filters): 1,641
2026-02-13 21:38:12,941 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:12,942 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:38:12,942 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,943 - retention_system - INFO - Total customers: 1,641
2026-02-13 21:38:12,943 - retention_system - INFO - Churned: 1,010 (61.55%)
2026-02-13 21:38:12,943 - retention_system - INFO - Active: 631 (38.45%)
2026-02-13 21:38:12,943 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:38:12,943 - retention_system - INFO -   Avg recency: 87.2 days
2026-02-13 21:38:12,944 - retention_system - INFO -   Avg frequency: 34.2 transactions
2026-02-13 21:38:12,944 - retention_system - INFO -   Avg revenue: $432.45
2026-02-13 21:38:12,944 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:38:12,944 - retention_system - INFO -   Avg recency: 69.5 days
2026-02-13 21:38:12,944 - retention_system - INFO -   Avg frequency: 57.4 transactions
2026-02-13 21:38:12,944 - retention_system - INFO -   Avg revenue: $828.48
2026-02-13 21:38:12,945 - retention_system - INFO - ================================================================================

2026-02-13 21:38:12,945 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:38:12,948 - retention_system - INFO - 
Processing snapshot 6/6: 2011-08-31
2026-02-13 21:38:12,949 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,949 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-08-31
2026-02-13 21:38:12,949 - retention_system - INFO - ================================================================================
2026-02-13 21:38:12,950 - retention_system - INFO - Observation window: 2011-03-04 to 2011-08-31
2026-02-13 21:38:12,951 - retention_system - INFO - Prediction window: 2011-08-31 to 2011-11-29
2026-02-13 21:38:12,978 - retention_system - INFO - Transactions in observation window: 78,812
2026-02-13 21:38:12,979 - retention_system - INFO - Transactions in prediction window: 35,891
2026-02-13 21:38:12,992 - retention_system - INFO - Customers in observation window: 1,937
2026-02-13 21:38:12,994 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:38:12,994 - retention_system - INFO -   Initial customers: 1,937
2026-02-13 21:38:12,995 - retention_system - INFO -   Removed (< 2 transactions): 50
2026-02-13 21:38:12,995 - retention_system - INFO -   Removed (< 30 days tenure): 198
2026-02-13 21:38:12,995 - retention_system - INFO -   Eligible customers: 1,689
2026-02-13 21:38:12,995 - retention_system - INFO - Eligible customers (after filters): 1,689
2026-02-13 21:38:13,079 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:13,079 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:38:13,079 - retention_system - INFO - ================================================================================
2026-02-13 21:38:13,080 - retention_system - INFO - Total customers: 1,689
2026-02-13 21:38:13,080 - retention_system - INFO - Churned: 1,055 (62.46%)
2026-02-13 21:38:13,080 - retention_system - INFO - Active: 634 (37.54%)
2026-02-13 21:38:13,080 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:38:13,081 - retention_system - INFO -   Avg recency: 88.3 days
2026-02-13 21:38:13,082 - retention_system - INFO -   Avg frequency: 35.3 transactions
2026-02-13 21:38:13,083 - retention_system - INFO -   Avg revenue: $435.74
2026-02-13 21:38:13,083 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:38:13,083 - retention_system - INFO -   Avg recency: 70.5 days
2026-02-13 21:38:13,083 - retention_system - INFO -   Avg frequency: 58.1 transactions
2026-02-13 21:38:13,084 - retention_system - INFO -   Avg revenue: $825.98
2026-02-13 21:38:13,084 - retention_system - INFO - ================================================================================

2026-02-13 21:38:13,084 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:38:13,089 - retention_system - INFO - 
✓ Created labels for 6 snapshots
2026-02-13 21:38:13,090 - retention_system - INFO - Total label rows: 8,124
2026-02-13 21:38:13,090 - retention_system - INFO - 
✓ Created 8,124 labels across 6 snapshots
2026-02-13 21:38:13,090 - retention_system - INFO - Overall churn rate: 59.08%
2026-02-13 21:38:13,099 - retention_system - INFO - Saved labels to: outputs\churn_labels.parquet
2026-02-13 21:38:13,106 - retention_system - INFO - Saved statistics to: outputs\churn_label_statistics.csv
2026-02-13 21:38:13,106 - retention_system - INFO - Completed: Churn Label Creation in 0.87 seconds
2026-02-13 21:38:13,107 - retention_system - INFO - Starting: Data Preparation
2026-02-13 21:38:13,107 - retention_system - INFO - ================================================================================
2026-02-13 21:38:13,107 - retention_system - INFO - PREPARING DATA FOR CHURN PREDICTION
2026-02-13 21:38:13,108 - retention_system - INFO - ================================================================================
2026-02-13 21:38:13,132 - retention_system - INFO - Total samples: 56,052
2026-02-13 21:38:13,132 - retention_system - INFO - Features: 36
2026-02-13 21:38:13,203 - retention_system - INFO - Selected 33 features for training
2026-02-13 21:38:13,291 - retention_system - INFO - 
Class distribution:
2026-02-13 21:38:13,292 - retention_system - INFO -   Train: Churned=20,711 (51.3%), Active=19,646 (48.7%)
2026-02-13 21:38:13,293 - retention_system - WARNING -     ⚠️  Train has extreme churn rate (51.3%)
2026-02-13 21:38:13,294 - retention_system - INFO -   Val: Churned=2,519 (56.2%), Active=1,965 (43.8%)
2026-02-13 21:38:13,294 - retention_system - WARNING -     ⚠️  Val has extreme churn rate (56.2%)
2026-02-13 21:38:13,295 - retention_system - INFO -   Test: Churned=6,267 (55.9%), Active=4,944 (44.1%)
2026-02-13 21:38:13,295 - retention_system - WARNING -     ⚠️  Test has extreme churn rate (55.9%)
2026-02-13 21:38:13,311 - retention_system - INFO - 
Train set: 40,357 samples
2026-02-13 21:38:13,312 - retention_system - INFO - Validation set: 4,484 samples
2026-02-13 21:38:13,312 - retention_system - INFO - Test set: 11,211 samples
2026-02-13 21:38:13,314 - retention_system - INFO - 
✓ Data prepared successfully
2026-02-13 21:38:13,316 - retention_system - INFO - Train: 40,357, Val: 4,484, Test: 11,211
2026-02-13 21:38:13,316 - retention_system - INFO - Completed: Data Preparation in 0.21 seconds
2026-02-13 21:38:13,317 - retention_system - INFO - Starting: Model Training
2026-02-13 21:38:13,318 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:13,318 - retention_system - INFO - TRAINING CHURN PREDICTION MODEL
2026-02-13 21:38:13,319 - retention_system - INFO - ================================================================================
2026-02-13 21:38:13,321 - retention_system - INFO - Using class weight: 0.95
2026-02-13 21:38:13,321 - retention_system - INFO - 
Model hyperparameters:
2026-02-13 21:38:13,322 - retention_system - INFO -   objective: binary
2026-02-13 21:38:13,322 - retention_system - INFO -   metric: auc
2026-02-13 21:38:13,322 - retention_system - INFO -   boosting_type: gbdt
2026-02-13 21:38:13,322 - retention_system - INFO -   num_leaves: 31
2026-02-13 21:38:13,323 - retention_system - INFO -   learning_rate: 0.05
2026-02-13 21:38:13,323 - retention_system - INFO -   feature_fraction: 0.8
2026-02-13 21:38:13,323 - retention_system - INFO -   bagging_fraction: 0.8
2026-02-13 21:38:13,323 - retention_system - INFO -   bagging_freq: 5
2026-02-13 21:38:13,323 - retention_system - INFO -   max_depth: 7
2026-02-13 21:38:13,324 - retention_system - INFO -   min_child_samples: 20
2026-02-13 21:38:13,324 - retention_system - INFO -   scale_pos_weight: 0.9485780503114287
2026-02-13 21:38:13,324 - retention_system - INFO -   verbose: -1
2026-02-13 21:38:13,324 - retention_system - INFO -   random_state: 42
2026-02-13 21:38:13,324 - retention_system - INFO - 
Training LightGBM model...
2026-02-13 21:38:25,657 - retention_system - INFO - 
✓ Model trained successfully
2026-02-13 21:38:25,658 - retention_system - INFO - Best iteration: 994
2026-02-13 21:38:25,658 - retention_system - INFO - Best score (AUC): 0.8380
2026-02-13 21:38:25,659 - retention_system - INFO - 
Top 10 most important features:
2026-02-13 21:38:25,660 - retention_system - INFO -   customer_lifetime_days: 33088.31
2026-02-13 21:38:25,660 - retention_system - INFO -   avg_basket_size: 27479.96
2026-02-13 21:38:25,661 - retention_system - INFO -   rfm_monetary_std: 25413.13
2026-02-13 21:38:25,661 - retention_system - INFO -   engagement_score_normalized: 23876.92
2026-02-13 21:38:25,662 - retention_system - INFO -   rfm_monetary_avg: 23851.92
2026-02-13 21:38:25,662 - retention_system - INFO -   rfm_monetary_total: 21392.81
2026-02-13 21:38:25,663 - retention_system - INFO -   purchase_frequency_per_month: 13335.73
2026-02-13 21:38:25,663 - retention_system - INFO -   rfm_frequency_count: 11161.68
2026-02-13 21:38:25,664 - retention_system - INFO -   std_basket_size: 9653.80
2026-02-13 21:38:25,664 - retention_system - INFO -   engagement_score: 8834.38
2026-02-13 21:38:25,665 - retention_system - INFO - 
✓ Model trained successfully
2026-02-13 21:38:25,666 - retention_system - INFO - Completed: Model Training in 12.35 seconds
2026-02-13 21:38:25,667 - retention_system - INFO - Starting: Threshold Optimization
2026-02-13 21:38:25,667 - retention_system - INFO - 
================================================================================
2026-02-13 21:38:25,668 - retention_system - INFO - OPTIMIZING DECISION THRESHOLD
2026-02-13 21:38:25,668 - retention_system - INFO - ================================================================================
2026-02-13 21:38:25,889 - retention_system - INFO - Metric: f_beta (beta=2.0)
2026-02-13 21:38:25,889 - retention_system - INFO - Optimal threshold: 0.100
2026-02-13 21:38:25,890 - retention_system - INFO - Score at optimal threshold: 0.8791
2026-02-13 21:38:25,890 - retention_system - INFO - 
Performance at key thresholds:
2026-02-13 21:38:25,891 - retention_system - INFO - Completed: Threshold Optimization in 0.22 seconds
2026-02-13 21:43:23,623 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:43:23,624 - retention_system - INFO - Starting: Churn Label Creation
2026-02-13 21:43:23,624 - retention_system - INFO - Loading cleaned data from: data/processed/cleaned_data.parquet
2026-02-13 21:43:23,757 - retention_system - INFO - Loaded 163,246 transactions
2026-02-13 21:43:23,758 - retention_system - INFO - Loading features from: data/features/customer_features.parquet
2026-02-13 21:43:23,766 - retention_system - INFO - Loaded 13,843 feature rows
2026-02-13 21:43:23,767 - retention_system - INFO - Found 14 snapshots in features
2026-02-13 21:43:23,768 - retention_system - INFO - Using last 6 snapshots for efficiency
2026-02-13 21:43:23,768 - retention_system - INFO - 
Processing snapshot 1/6: 2011-03-31
2026-02-13 21:43:23,768 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,768 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-03-31
2026-02-13 21:43:23,769 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,769 - retention_system - INFO - Observation window: 2010-10-02 to 2011-03-31
2026-02-13 21:43:23,769 - retention_system - INFO - Prediction window: 2011-03-31 to 2011-06-29
2026-02-13 21:43:23,791 - retention_system - INFO - Transactions in observation window: 33,255
2026-02-13 21:43:23,791 - retention_system - INFO - Transactions in prediction window: 43,444
2026-02-13 21:43:23,799 - retention_system - INFO - Customers in observation window: 1,121
2026-02-13 21:43:23,801 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:43:23,801 - retention_system - INFO -   Initial customers: 1,121
2026-02-13 21:43:23,802 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:43:23,802 - retention_system - INFO -   Removed (< 30 days tenure): 232
2026-02-13 21:43:23,802 - retention_system - INFO -   Eligible customers: 831
2026-02-13 21:43:23,802 - retention_system - INFO - Eligible customers (after filters): 831
2026-02-13 21:43:23,842 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:23,842 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:43:23,842 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,842 - retention_system - INFO - Total customers: 831
2026-02-13 21:43:23,843 - retention_system - INFO - Churned: 465 (55.96%)
2026-02-13 21:43:23,843 - retention_system - INFO - Active: 366 (44.04%)
2026-02-13 21:43:23,843 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:43:23,843 - retention_system - INFO -   Avg recency: 65.7 days
2026-02-13 21:43:23,843 - retention_system - INFO -   Avg frequency: 28.0 transactions
2026-02-13 21:43:23,844 - retention_system - INFO -   Avg revenue: $378.30
2026-02-13 21:43:23,844 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:43:23,844 - retention_system - INFO -   Avg recency: 58.1 days
2026-02-13 21:43:23,845 - retention_system - INFO -   Avg frequency: 40.1 transactions
2026-02-13 21:43:23,845 - retention_system - INFO -   Avg revenue: $580.42
2026-02-13 21:43:23,845 - retention_system - INFO - ================================================================================

2026-02-13 21:43:23,845 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:43:23,849 - retention_system - INFO - 
Processing snapshot 2/6: 2011-04-30
2026-02-13 21:43:23,849 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,850 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-04-30
2026-02-13 21:43:23,850 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,850 - retention_system - INFO - Observation window: 2010-11-01 to 2011-04-30
2026-02-13 21:43:23,850 - retention_system - INFO - Prediction window: 2011-04-30 to 2011-07-29
2026-02-13 21:43:23,869 - retention_system - INFO - Transactions in observation window: 46,202
2026-02-13 21:43:23,869 - retention_system - INFO - Transactions in prediction window: 43,190
2026-02-13 21:43:23,875 - retention_system - INFO - Customers in observation window: 1,388
2026-02-13 21:43:23,877 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:43:23,877 - retention_system - INFO -   Initial customers: 1,388
2026-02-13 21:43:23,878 - retention_system - INFO -   Removed (< 2 transactions): 58
2026-02-13 21:43:23,878 - retention_system - INFO -   Removed (< 30 days tenure): 282
2026-02-13 21:43:23,878 - retention_system - INFO -   Eligible customers: 1,048
2026-02-13 21:43:23,878 - retention_system - INFO - Eligible customers (after filters): 1,048
2026-02-13 21:43:23,930 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:23,931 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:43:23,932 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,932 - retention_system - INFO - Total customers: 1,048
2026-02-13 21:43:23,932 - retention_system - INFO - Churned: 575 (54.87%)
2026-02-13 21:43:23,932 - retention_system - INFO - Active: 473 (45.13%)
2026-02-13 21:43:23,933 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:43:23,933 - retention_system - INFO -   Avg recency: 74.2 days
2026-02-13 21:43:23,933 - retention_system - INFO -   Avg frequency: 30.7 transactions
2026-02-13 21:43:23,933 - retention_system - INFO -   Avg revenue: $407.15
2026-02-13 21:43:23,933 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:43:23,933 - retention_system - INFO -   Avg recency: 62.6 days
2026-02-13 21:43:23,934 - retention_system - INFO -   Avg frequency: 42.9 transactions
2026-02-13 21:43:23,934 - retention_system - INFO -   Avg revenue: $635.35
2026-02-13 21:43:23,934 - retention_system - INFO - ================================================================================

2026-02-13 21:43:23,934 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:43:23,937 - retention_system - INFO - 
Processing snapshot 3/6: 2011-05-31
2026-02-13 21:43:23,937 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,937 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-05-31
2026-02-13 21:43:23,937 - retention_system - INFO - ================================================================================
2026-02-13 21:43:23,938 - retention_system - INFO - Observation window: 2010-12-02 to 2011-05-31
2026-02-13 21:43:23,938 - retention_system - INFO - Prediction window: 2011-05-31 to 2011-08-29
2026-02-13 21:43:23,959 - retention_system - INFO - Transactions in observation window: 59,214
2026-02-13 21:43:23,960 - retention_system - INFO - Transactions in prediction window: 43,787
2026-02-13 21:43:23,972 - retention_system - INFO - Customers in observation window: 1,630
2026-02-13 21:43:23,975 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:43:23,975 - retention_system - INFO -   Initial customers: 1,630
2026-02-13 21:43:23,975 - retention_system - INFO -   Removed (< 2 transactions): 52
2026-02-13 21:43:23,976 - retention_system - INFO -   Removed (< 30 days tenure): 234
2026-02-13 21:43:23,976 - retention_system - INFO -   Eligible customers: 1,344
2026-02-13 21:43:23,976 - retention_system - INFO - Eligible customers (after filters): 1,344
2026-02-13 21:43:24,042 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:24,043 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:43:24,043 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,043 - retention_system - INFO - Total customers: 1,344
2026-02-13 21:43:24,044 - retention_system - INFO - Churned: 750 (55.80%)
2026-02-13 21:43:24,044 - retention_system - INFO - Active: 594 (44.20%)
2026-02-13 21:43:24,044 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:43:24,045 - retention_system - INFO -   Avg recency: 85.3 days
2026-02-13 21:43:24,046 - retention_system - INFO -   Avg frequency: 33.0 transactions
2026-02-13 21:43:24,046 - retention_system - INFO -   Avg revenue: $418.85
2026-02-13 21:43:24,046 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:43:24,047 - retention_system - INFO -   Avg recency: 69.1 days
2026-02-13 21:43:24,047 - retention_system - INFO -   Avg frequency: 49.0 transactions
2026-02-13 21:43:24,047 - retention_system - INFO -   Avg revenue: $726.46
2026-02-13 21:43:24,047 - retention_system - INFO - ================================================================================

2026-02-13 21:43:24,048 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:43:24,051 - retention_system - INFO - 
Processing snapshot 4/6: 2011-06-30
2026-02-13 21:43:24,051 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,051 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-06-30
2026-02-13 21:43:24,051 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,052 - retention_system - INFO - Observation window: 2011-01-01 to 2011-06-30
2026-02-13 21:43:24,052 - retention_system - INFO - Prediction window: 2011-06-30 to 2011-09-28
2026-02-13 21:43:24,079 - retention_system - INFO - Transactions in observation window: 73,931
2026-02-13 21:43:24,080 - retention_system - INFO - Transactions in prediction window: 38,417
2026-02-13 21:43:24,100 - retention_system - INFO - Customers in observation window: 1,887
2026-02-13 21:43:24,104 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:43:24,105 - retention_system - INFO -   Initial customers: 1,887
2026-02-13 21:43:24,106 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:43:24,107 - retention_system - INFO -   Removed (< 30 days tenure): 263
2026-02-13 21:43:24,107 - retention_system - INFO -   Eligible customers: 1,571
2026-02-13 21:43:24,107 - retention_system - INFO - Eligible customers (after filters): 1,571
2026-02-13 21:43:24,199 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:24,199 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:43:24,200 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,200 - retention_system - INFO - Total customers: 1,571
2026-02-13 21:43:24,200 - retention_system - INFO - Churned: 945 (60.15%)
2026-02-13 21:43:24,200 - retention_system - INFO - Active: 626 (39.85%)
2026-02-13 21:43:24,200 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:43:24,201 - retention_system - INFO -   Avg recency: 91.6 days
2026-02-13 21:43:24,201 - retention_system - INFO -   Avg frequency: 32.7 transactions
2026-02-13 21:43:24,201 - retention_system - INFO -   Avg revenue: $430.26
2026-02-13 21:43:24,201 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:43:24,202 - retention_system - INFO -   Avg recency: 70.9 days
2026-02-13 21:43:24,202 - retention_system - INFO -   Avg frequency: 58.0 transactions
2026-02-13 21:43:24,202 - retention_system - INFO -   Avg revenue: $836.32
2026-02-13 21:43:24,202 - retention_system - INFO - ================================================================================

2026-02-13 21:43:24,202 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:43:24,206 - retention_system - INFO - 
Processing snapshot 5/6: 2011-07-31
2026-02-13 21:43:24,206 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,206 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-07-31
2026-02-13 21:43:24,206 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,207 - retention_system - INFO - Observation window: 2011-02-01 to 2011-07-31
2026-02-13 21:43:24,207 - retention_system - INFO - Prediction window: 2011-07-31 to 2011-10-29
2026-02-13 21:43:24,237 - retention_system - INFO - Transactions in observation window: 76,697
2026-02-13 21:43:24,238 - retention_system - INFO - Transactions in prediction window: 36,655
2026-02-13 21:43:24,248 - retention_system - INFO - Customers in observation window: 1,922
2026-02-13 21:43:24,249 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:43:24,250 - retention_system - INFO -   Initial customers: 1,922
2026-02-13 21:43:24,250 - retention_system - INFO -   Removed (< 2 transactions): 53
2026-02-13 21:43:24,250 - retention_system - INFO -   Removed (< 30 days tenure): 228
2026-02-13 21:43:24,250 - retention_system - INFO -   Eligible customers: 1,641
2026-02-13 21:43:24,250 - retention_system - INFO - Eligible customers (after filters): 1,641
2026-02-13 21:43:24,334 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:24,334 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:43:24,335 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,335 - retention_system - INFO - Total customers: 1,641
2026-02-13 21:43:24,335 - retention_system - INFO - Churned: 1,010 (61.55%)
2026-02-13 21:43:24,335 - retention_system - INFO - Active: 631 (38.45%)
2026-02-13 21:43:24,335 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:43:24,336 - retention_system - INFO -   Avg recency: 87.2 days
2026-02-13 21:43:24,336 - retention_system - INFO -   Avg frequency: 34.2 transactions
2026-02-13 21:43:24,336 - retention_system - INFO -   Avg revenue: $432.45
2026-02-13 21:43:24,336 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:43:24,336 - retention_system - INFO -   Avg recency: 69.5 days
2026-02-13 21:43:24,337 - retention_system - INFO -   Avg frequency: 57.4 transactions
2026-02-13 21:43:24,337 - retention_system - INFO -   Avg revenue: $828.48
2026-02-13 21:43:24,337 - retention_system - INFO - ================================================================================

2026-02-13 21:43:24,337 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:43:24,340 - retention_system - INFO - 
Processing snapshot 6/6: 2011-08-31
2026-02-13 21:43:24,341 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,341 - retention_system - INFO - CREATING CHURN LABELS FOR SNAPSHOT: 2011-08-31
2026-02-13 21:43:24,341 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,342 - retention_system - INFO - Observation window: 2011-03-04 to 2011-08-31
2026-02-13 21:43:24,342 - retention_system - INFO - Prediction window: 2011-08-31 to 2011-11-29
2026-02-13 21:43:24,371 - retention_system - INFO - Transactions in observation window: 78,812
2026-02-13 21:43:24,371 - retention_system - INFO - Transactions in prediction window: 35,891
2026-02-13 21:43:24,384 - retention_system - INFO - Customers in observation window: 1,937
2026-02-13 21:43:24,387 - retention_system - INFO - 
Eligibility filtering:
2026-02-13 21:43:24,387 - retention_system - INFO -   Initial customers: 1,937
2026-02-13 21:43:24,387 - retention_system - INFO -   Removed (< 2 transactions): 50
2026-02-13 21:43:24,387 - retention_system - INFO -   Removed (< 30 days tenure): 198
2026-02-13 21:43:24,388 - retention_system - INFO -   Eligible customers: 1,689
2026-02-13 21:43:24,388 - retention_system - INFO - Eligible customers (after filters): 1,689
2026-02-13 21:43:24,469 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:24,469 - retention_system - INFO - CHURN LABEL STATISTICS
2026-02-13 21:43:24,470 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,470 - retention_system - INFO - Total customers: 1,689
2026-02-13 21:43:24,470 - retention_system - INFO - Churned: 1,055 (62.46%)
2026-02-13 21:43:24,470 - retention_system - INFO - Active: 634 (37.54%)
2026-02-13 21:43:24,470 - retention_system - INFO - 
Churned customer profile:
2026-02-13 21:43:24,471 - retention_system - INFO -   Avg recency: 88.3 days
2026-02-13 21:43:24,471 - retention_system - INFO -   Avg frequency: 35.3 transactions
2026-02-13 21:43:24,471 - retention_system - INFO -   Avg revenue: $435.74
2026-02-13 21:43:24,471 - retention_system - INFO - 
Active customer profile:
2026-02-13 21:43:24,471 - retention_system - INFO -   Avg recency: 70.5 days
2026-02-13 21:43:24,471 - retention_system - INFO -   Avg frequency: 58.1 transactions
2026-02-13 21:43:24,472 - retention_system - INFO -   Avg revenue: $825.98
2026-02-13 21:43:24,472 - retention_system - INFO - ================================================================================

2026-02-13 21:43:24,472 - retention_system - INFO - 
✓ Churn labels created successfully
2026-02-13 21:43:24,479 - retention_system - INFO - 
✓ Created labels for 6 snapshots
2026-02-13 21:43:24,479 - retention_system - INFO - Total label rows: 8,124
2026-02-13 21:43:24,479 - retention_system - INFO - 
✓ Created 8,124 labels across 6 snapshots
2026-02-13 21:43:24,480 - retention_system - INFO - Overall churn rate: 59.08%
2026-02-13 21:43:24,489 - retention_system - INFO - Saved labels to: outputs\churn_labels.parquet
2026-02-13 21:43:24,494 - retention_system - INFO - Saved statistics to: outputs\churn_label_statistics.csv
2026-02-13 21:43:24,495 - retention_system - INFO - Completed: Churn Label Creation in 0.87 seconds
2026-02-13 21:43:24,496 - retention_system - INFO - Starting: Data Preparation
2026-02-13 21:43:24,497 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,497 - retention_system - INFO - PREPARING DATA FOR CHURN PREDICTION
2026-02-13 21:43:24,499 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,520 - retention_system - INFO - Total samples: 56,052
2026-02-13 21:43:24,520 - retention_system - INFO - Features: 36
2026-02-13 21:43:24,560 - retention_system - INFO - Selected 33 features for training
2026-02-13 21:43:24,608 - retention_system - INFO - 
Class distribution:
2026-02-13 21:43:24,609 - retention_system - INFO -   Train: Churned=20,711 (51.3%), Active=19,646 (48.7%)
2026-02-13 21:43:24,609 - retention_system - WARNING -     ⚠️  Train has extreme churn rate (51.3%)
2026-02-13 21:43:24,610 - retention_system - INFO -   Val: Churned=2,519 (56.2%), Active=1,965 (43.8%)
2026-02-13 21:43:24,611 - retention_system - WARNING -     ⚠️  Val has extreme churn rate (56.2%)
2026-02-13 21:43:24,612 - retention_system - INFO -   Test: Churned=6,267 (55.9%), Active=4,944 (44.1%)
2026-02-13 21:43:24,612 - retention_system - WARNING -     ⚠️  Test has extreme churn rate (55.9%)
2026-02-13 21:43:24,613 - retention_system - INFO - 
Train set: 40,357 samples
2026-02-13 21:43:24,613 - retention_system - INFO - Validation set: 4,484 samples
2026-02-13 21:43:24,614 - retention_system - INFO - Test set: 11,211 samples
2026-02-13 21:43:24,615 - retention_system - INFO - 
✓ Data prepared successfully
2026-02-13 21:43:24,616 - retention_system - INFO - Train: 40,357, Val: 4,484, Test: 11,211
2026-02-13 21:43:24,616 - retention_system - INFO - Completed: Data Preparation in 0.12 seconds
2026-02-13 21:43:24,617 - retention_system - INFO - Starting: Model Training
2026-02-13 21:43:24,617 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:24,618 - retention_system - INFO - TRAINING CHURN PREDICTION MODEL
2026-02-13 21:43:24,618 - retention_system - INFO - ================================================================================
2026-02-13 21:43:24,619 - retention_system - INFO - Using class weight: 0.95
2026-02-13 21:43:24,619 - retention_system - INFO - 
Model hyperparameters:
2026-02-13 21:43:24,620 - retention_system - INFO -   objective: binary
2026-02-13 21:43:24,620 - retention_system - INFO -   metric: auc
2026-02-13 21:43:24,620 - retention_system - INFO -   boosting_type: gbdt
2026-02-13 21:43:24,621 - retention_system - INFO -   num_leaves: 31
2026-02-13 21:43:24,621 - retention_system - INFO -   learning_rate: 0.05
2026-02-13 21:43:24,621 - retention_system - INFO -   feature_fraction: 0.8
2026-02-13 21:43:24,621 - retention_system - INFO -   bagging_fraction: 0.8
2026-02-13 21:43:24,622 - retention_system - INFO -   bagging_freq: 5
2026-02-13 21:43:24,622 - retention_system - INFO -   max_depth: 7
2026-02-13 21:43:24,622 - retention_system - INFO -   min_child_samples: 20
2026-02-13 21:43:24,622 - retention_system - INFO -   scale_pos_weight: 0.9485780503114287
2026-02-13 21:43:24,623 - retention_system - INFO -   verbose: -1
2026-02-13 21:43:24,623 - retention_system - INFO -   random_state: 42
2026-02-13 21:43:24,623 - retention_system - INFO - 
Training LightGBM model...
2026-02-13 21:43:35,764 - retention_system - INFO - 
✓ Model trained successfully
2026-02-13 21:43:35,766 - retention_system - INFO - Best iteration: 994
2026-02-13 21:43:35,766 - retention_system - INFO - Best score (AUC): 0.8380
2026-02-13 21:43:35,767 - retention_system - INFO - 
Top 10 most important features:
2026-02-13 21:43:35,768 - retention_system - INFO -   customer_lifetime_days: 33088.31
2026-02-13 21:43:35,769 - retention_system - INFO -   avg_basket_size: 27479.96
2026-02-13 21:43:35,770 - retention_system - INFO -   rfm_monetary_std: 25413.13
2026-02-13 21:43:35,771 - retention_system - INFO -   engagement_score_normalized: 23876.92
2026-02-13 21:43:35,772 - retention_system - INFO -   rfm_monetary_avg: 23851.92
2026-02-13 21:43:35,773 - retention_system - INFO -   rfm_monetary_total: 21392.81
2026-02-13 21:43:35,773 - retention_system - INFO -   purchase_frequency_per_month: 13335.73
2026-02-13 21:43:35,774 - retention_system - INFO -   rfm_frequency_count: 11161.68
2026-02-13 21:43:35,774 - retention_system - INFO -   std_basket_size: 9653.80
2026-02-13 21:43:35,774 - retention_system - INFO -   engagement_score: 8834.38
2026-02-13 21:43:35,775 - retention_system - INFO - 
✓ Model trained successfully
2026-02-13 21:43:35,775 - retention_system - INFO - Completed: Model Training in 11.16 seconds
2026-02-13 21:43:35,777 - retention_system - INFO - Starting: Threshold Optimization
2026-02-13 21:43:35,777 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:35,778 - retention_system - INFO - OPTIMIZING DECISION THRESHOLD
2026-02-13 21:43:35,778 - retention_system - INFO - ================================================================================
2026-02-13 21:43:35,987 - retention_system - INFO - Metric: f_beta (beta=2.0)
2026-02-13 21:43:35,988 - retention_system - INFO - Optimal threshold: 0.100
2026-02-13 21:43:35,988 - retention_system - INFO - Score at optimal threshold: 0.8791
2026-02-13 21:43:35,989 - retention_system - INFO - 
Performance at key thresholds:
2026-02-13 21:43:36,007 - retention_system - INFO -   Threshold 0.30: Precision=0.732, Recall=0.862, F-beta=0.832
2026-02-13 21:43:36,020 - retention_system - INFO -   Threshold 0.50: Precision=0.810, Recall=0.715, F-beta=0.733
2026-02-13 21:43:36,048 - retention_system - INFO -   Threshold 0.10: Precision=0.644, Recall=0.967, F-beta=0.879
2026-02-13 21:43:36,071 - retention_system - INFO -   Threshold 0.70: Precision=0.884, Recall=0.570, F-beta=0.614
2026-02-13 21:43:36,072 - retention_system - INFO - 
✓ Optimal threshold: 0.100
2026-02-13 21:43:36,072 - retention_system - INFO - Completed: Threshold Optimization in 0.30 seconds
2026-02-13 21:43:36,073 - retention_system - INFO - Starting: Model Evaluation
2026-02-13 21:43:36,074 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:36,074 - retention_system - INFO - EVALUATING CHURN PREDICTION MODEL
2026-02-13 21:43:36,074 - retention_system - INFO - ================================================================================
2026-02-13 21:43:36,559 - retention_system - INFO - Decision threshold: 0.100
2026-02-13 21:43:36,560 - retention_system - INFO - 
Classification metrics:
2026-02-13 21:43:36,560 - retention_system - INFO -   Accuracy: 0.6602
2026-02-13 21:43:36,561 - retention_system - INFO -   Precision: 0.6309
2026-02-13 21:43:36,561 - retention_system - INFO -   Recall: 0.9451
2026-02-13 21:43:36,562 - retention_system - INFO -   F1 Score: 0.7567
2026-02-13 21:43:36,562 - retention_system - INFO -   F2 Score (beta=2): 0.8595
2026-02-13 21:43:36,563 - retention_system - INFO -   ROC AUC: 0.7666
2026-02-13 21:43:36,563 - retention_system - INFO - 
Confusion matrix:
2026-02-13 21:43:36,564 - retention_system - INFO -   True Negatives: 1,479
2026-02-13 21:43:36,564 - retention_system - INFO -   False Positives: 3,465
2026-02-13 21:43:36,565 - retention_system - INFO -   False Negatives: 344
2026-02-13 21:43:36,566 - retention_system - INFO -   True Positives: 5,923
2026-02-13 21:43:36,566 - retention_system - INFO - 
Business metrics:
2026-02-13 21:43:36,567 - retention_system - INFO -   Churn capture rate: 94.51%
2026-02-13 21:43:36,567 - retention_system - INFO -   Predicted churners: 9,388 (83.7%)
2026-02-13 21:43:36,568 - retention_system - INFO -   Lift vs random: 1.13x
2026-02-13 21:43:36,568 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:36,568 - retention_system - INFO - CLASSIFICATION REPORT
2026-02-13 21:43:36,569 - retention_system - INFO - ================================================================================
2026-02-13 21:43:36,592 - retention_system - INFO - 
              precision    recall  f1-score   support

      Active       0.81      0.30      0.44      4944
     Churned       0.63      0.95      0.76      6267

    accuracy                           0.66     11211
   macro avg       0.72      0.62      0.60     11211
weighted avg       0.71      0.66      0.62     11211

2026-02-13 21:43:36,594 - retention_system - INFO - 
Metrics saved to: outputs\churn_model_metrics.json
2026-02-13 21:43:36,595 - retention_system - INFO - Completed: Model Evaluation in 0.52 seconds
2026-02-13 21:43:36,596 - retention_system - INFO - Starting: Prediction Generation
2026-02-13 21:43:36,599 - retention_system - INFO - Generating predictions for 1,937 customers
2026-02-13 21:43:36,764 - retention_system - INFO - Predictions saved to: outputs\churn_predictions.parquet
2026-02-13 21:43:36,766 - retention_system - INFO - 
Churn risk distribution:
2026-02-13 21:43:36,767 - retention_system - INFO -   Low: 544 (28.1%)
2026-02-13 21:43:36,768 - retention_system - INFO -   Medium: 274 (14.1%)
2026-02-13 21:43:36,768 - retention_system - INFO -   High: 342 (17.7%)
2026-02-13 21:43:36,768 - retention_system - INFO -   Very High: 777 (40.1%)
2026-02-13 21:43:36,769 - retention_system - INFO - Completed: Prediction Generation in 0.17 seconds
2026-02-13 21:43:36,770 - retention_system - INFO - Starting: Feature Importance
2026-02-13 21:43:36,771 - retention_system - INFO - 
Top 20 most important features:
2026-02-13 21:43:36,772 - retention_system - INFO -   customer_lifetime_days: 33088.31
2026-02-13 21:43:36,774 - retention_system - INFO -   avg_basket_size: 27479.96
2026-02-13 21:43:36,776 - retention_system - INFO -   rfm_monetary_std: 25413.13
2026-02-13 21:43:36,778 - retention_system - INFO -   engagement_score_normalized: 23876.92
2026-02-13 21:43:36,778 - retention_system - INFO -   rfm_monetary_avg: 23851.92
2026-02-13 21:43:36,779 - retention_system - INFO -   rfm_monetary_total: 21392.81
2026-02-13 21:43:36,779 - retention_system - INFO -   purchase_frequency_per_month: 13335.73
2026-02-13 21:43:36,780 - retention_system - INFO -   rfm_frequency_count: 11161.68
2026-02-13 21:43:36,780 - retention_system - INFO -   std_basket_size: 9653.80
2026-02-13 21:43:36,780 - retention_system - INFO -   engagement_score: 8834.38
2026-02-13 21:43:36,781 - retention_system - INFO -   rfm_recency_days: 8413.93
2026-02-13 21:43:36,781 - retention_system - INFO -   product_diversity_hhi: 8106.53
2026-02-13 21:43:36,782 - retention_system - INFO -   days_since_first_purchase: 6206.81
2026-02-13 21:43:36,783 - retention_system - INFO -   revenue_very_long_180d: 5853.08
2026-02-13 21:43:36,784 - retention_system - INFO -   unique_products_count: 5445.27
2026-02-13 21:43:36,785 - retention_system - INFO -   revenue_trend_slope: 4923.03
2026-02-13 21:43:36,786 - retention_system - INFO -   transaction_trend_slope: 4693.52
2026-02-13 21:43:36,786 - retention_system - INFO -   return_rate: 4619.93
2026-02-13 21:43:36,787 - retention_system - INFO -   revenue_long_90d: 4418.70
2026-02-13 21:43:36,788 - retention_system - INFO -   revenue_medium_60d: 2310.69
2026-02-13 21:43:36,790 - retention_system - INFO - 
Feature importance saved to: outputs\churn_feature_importance.csv
2026-02-13 21:43:36,791 - retention_system - INFO - Completed: Feature Importance in 0.02 seconds
2026-02-13 21:43:36,792 - retention_system - INFO - Starting: Model Saving
2026-02-13 21:43:36,946 - retention_system - INFO - Model saved to: models\churn_predictor.pkl
2026-02-13 21:43:36,946 - retention_system - INFO - ✓ Model saved to: models\churn_predictor.pkl
2026-02-13 21:43:36,946 - retention_system - INFO - Completed: Model Saving in 0.15 seconds
2026-02-13 21:43:36,948 - retention_system - INFO - ✓ Task 2.1: Churn Label Creation - COMPLETE
2026-02-13 21:43:36,948 - retention_system - INFO - ✓ Task 2.2: Data Preparation - COMPLETE
2026-02-13 21:43:36,948 - retention_system - INFO - ✓ Task 2.3: Model Training - COMPLETE
2026-02-13 21:43:36,948 - retention_system - INFO - ✓ Task 2.4: Threshold Optimization - COMPLETE
2026-02-13 21:43:36,949 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:36,949 - retention_system - INFO - PILLAR 2 STATUS: 4/4 TASKS COMPLETE ✓
2026-02-13 21:43:36,949 - retention_system - INFO - ================================================================================
2026-02-13 21:43:36,950 - retention_system - INFO - 
Key Results:
2026-02-13 21:43:36,951 - retention_system - INFO -   - Labels created: 8,124
2026-02-13 21:43:36,952 - retention_system - INFO -   - Overall churn rate: 59.08%
2026-02-13 21:43:36,952 - retention_system - INFO -   - Test ROC AUC: 0.7666
2026-02-13 21:43:36,953 - retention_system - INFO -   - Test F2 Score: 0.8595
2026-02-13 21:43:36,954 - retention_system - INFO -   - Optimal threshold: 0.100
2026-02-13 21:43:36,954 - retention_system - INFO -   - Precision: 0.6309
2026-02-13 21:43:36,955 - retention_system - INFO -   - Recall: 0.9451
2026-02-13 21:43:36,955 - retention_system - INFO - 
Risk distribution:
2026-02-13 21:43:36,956 - retention_system - INFO -   Low: 544 (28.1%)
2026-02-13 21:43:36,956 - retention_system - INFO -   Medium: 274 (14.1%)
2026-02-13 21:43:36,957 - retention_system - INFO -   High: 342 (17.7%)
2026-02-13 21:43:36,958 - retention_system - INFO -   Very High: 777 (40.1%)
2026-02-13 21:43:36,959 - retention_system - INFO - 
Output files created:
2026-02-13 21:43:36,960 - retention_system - INFO -   1. Churn labels: outputs\churn_labels.parquet
2026-02-13 21:43:36,961 - retention_system - INFO -   2. Label statistics: outputs\churn_label_statistics.csv
2026-02-13 21:43:36,961 - retention_system - INFO -   3. Model metrics: outputs\churn_model_metrics.json
2026-02-13 21:43:36,962 - retention_system - INFO -   4. Predictions: outputs\churn_predictions.parquet
2026-02-13 21:43:36,962 - retention_system - INFO -   5. Feature importance: outputs\churn_feature_importance.csv
2026-02-13 21:43:36,962 - retention_system - INFO -   6. Trained model: models\churn_predictor.pkl
2026-02-13 21:43:36,963 - retention_system - INFO - 
Top 3 predictive features:
2026-02-13 21:43:36,964 - retention_system - INFO -   customer_lifetime_days: 33088.31
2026-02-13 21:43:36,964 - retention_system - INFO -   avg_basket_size: 27479.96
2026-02-13 21:43:36,965 - retention_system - INFO -   rfm_monetary_std: 25413.13
2026-02-13 21:43:36,965 - retention_system - INFO - 
================================================================================
2026-02-13 21:43:36,966 - retention_system - INFO - OVERALL PROGRESS: 14/18 TASKS COMPLETE (78%)
2026-02-13 21:43:36,966 - retention_system - INFO - ================================================================================
2026-02-13 21:43:36,966 - retention_system - INFO - Pillar 0: ✓ Complete (6/6 tasks)
2026-02-13 21:43:36,967 - retention_system - INFO - Pillar 1: ✓ Complete (4/4 tasks)
2026-02-13 21:43:36,967 - retention_system - INFO - Pillar 2: ✓ Complete (4/4 tasks)
2026-02-13 21:43:36,968 - retention_system - INFO - Pillar 3: ⏳ Pending (0/3 tasks) - CLV Prediction
2026-02-13 21:43:36,968 - retention_system - INFO - Pillar 4: ⏳ Pending (0/3 tasks) - Revenue Optimization
2026-02-13 21:43:36,970 - retention_system - INFO - 
Next steps:
2026-02-13 21:43:36,971 - retention_system - INFO -   → Proceed to Pillar 3: CLV Prediction
2026-02-13 21:43:36,972 - retention_system - INFO -   → Run: python pillar_3_clv.py
2026-02-13 21:43:36,973 - retention_system - INFO - 
Business Actions:
2026-02-13 21:43:36,974 - retention_system - INFO -   → Target 'High' and 'Very High' risk customers with retention campaigns
2026-02-13 21:43:36,974 - retention_system - INFO -   → Expected churn reduction: 15-25%
2026-02-13 21:43:36,975 - retention_system - INFO -   → Use predictions in Pillar 4 for optimal budget allocation
2026-02-13 21:45:49,177 - retention_system - INFO - Configuration loaded successfully
2026-02-13 21:45:49,178 - retention_system - INFO - Starting: CLV Target Creation
2026-02-13 21:45:49,179 - retention_system - INFO - Loading cleaned data from: data/processed/cleaned_data.parquet
2026-02-13 21:45:49,288 - retention_system - INFO - Loaded 163,246 transactions
2026-02-13 21:45:49,289 - retention_system - INFO - Loading features from: data/features/customer_features.parquet
2026-02-13 21:45:49,299 - retention_system - INFO - Loaded 13,843 feature rows
2026-02-13 21:45:49,299 - retention_system - INFO - ================================================================================
2026-02-13 21:45:49,299 - retention_system - INFO - CREATING CLV TARGETS
2026-02-13 21:45:49,300 - retention_system - INFO - ================================================================================
2026-02-13 21:45:49,300 - retention_system - INFO - Prediction horizon: 180 days
2026-02-13 21:45:49,301 - retention_system - INFO - Processing 14 snapshots
2026-02-13 21:45:49,592 - retention_system - INFO - 
CLV Target Statistics:
2026-02-13 21:45:49,593 - retention_system - INFO -   Total samples: 13,843
2026-02-13 21:45:49,593 - retention_system - INFO -   Mean CLV: $353.67
2026-02-13 21:45:49,594 - retention_system - INFO -   Median CLV: $0.00
2026-02-13 21:45:49,595 - retention_system - INFO -   Std CLV: $903.56
2026-02-13 21:45:49,595 - retention_system - INFO -   Max CLV: $23906.56
2026-02-13 21:45:49,595 - retention_system - INFO -   Customers with $0 CLV: 6,448 (46.6%)
2026-02-13 21:45:49,597 - retention_system - INFO - 
CLV Distribution (quartiles):
2026-02-13 21:45:49,597 - retention_system - INFO -   25th percentile: $0.00
2026-02-13 21:45:49,597 - retention_system - INFO -   50th percentile: $0.00
2026-02-13 21:45:49,598 - retention_system - INFO -   75th percentile: $426.71
2026-02-13 21:45:49,598 - retention_system - INFO -   90th percentile: $990.00
2026-02-13 21:45:49,598 - retention_system - INFO -   95th percentile: $1502.57
2026-02-13 21:45:49,598 - retention_system - INFO -   99th percentile: $3369.48
2026-02-13 21:45:49,600 - retention_system - INFO - 
✓ Created 13,843 CLV targets
2026-02-13 21:45:49,611 - retention_system - INFO - Saved targets to: outputs\clv_targets.parquet
2026-02-13 21:45:49,611 - retention_system - INFO - Completed: CLV Target Creation in 0.43 seconds
2026-02-13 21:45:49,612 - retention_system - INFO - Starting: Model Training
2026-02-13 21:45:49,612 - retention_system - INFO - 
================================================================================
2026-02-13 21:45:49,613 - retention_system - INFO - PREPARING DATA FOR CLV PREDICTION
2026-02-13 21:45:49,613 - retention_system - INFO - ================================================================================
2026-02-13 21:45:49,660 - retention_system - INFO - Total samples: 99,805
2026-02-13 21:45:49,711 - retention_system - INFO - Selected 33 features for training
2026-02-13 21:45:49,831 - retention_system - INFO - Applied log transformation to target: log(1 + revenue)
2026-02-13 21:45:49,832 - retention_system - INFO - 
Train set: 71,860 samples
2026-02-13 21:45:49,833 - retention_system - INFO - Validation set: 7,984 samples
2026-02-13 21:45:49,834 - retention_system - INFO - Test set: 19,961 samples
2026-02-13 21:45:49,839 - retention_system - INFO - 
================================================================================
2026-02-13 21:45:49,839 - retention_system - INFO - TRAINING CLV PREDICTION MODEL
2026-02-13 21:45:49,840 - retention_system - INFO - ================================================================================
2026-02-13 21:45:49,840 - retention_system - INFO - 
Model hyperparameters:
2026-02-13 21:45:49,841 - retention_system - INFO -   objective: regression
2026-02-13 21:45:49,841 - retention_system - INFO -   metric: rmse
2026-02-13 21:45:49,843 - retention_system - INFO -   boosting_type: gbdt
2026-02-13 21:45:49,843 - retention_system - INFO -   num_leaves: 31
2026-02-13 21:45:49,844 - retention_system - INFO -   learning_rate: 0.05
2026-02-13 21:45:49,845 - retention_system - INFO -   feature_fraction: 0.8
2026-02-13 21:45:49,846 - retention_system - INFO -   bagging_fraction: 0.8
2026-02-13 21:45:49,846 - retention_system - INFO -   bagging_freq: 5
2026-02-13 21:45:49,847 - retention_system - INFO -   max_depth: 7
2026-02-13 21:45:49,847 - retention_system - INFO -   min_child_samples: 20
2026-02-13 21:45:49,847 - retention_system - INFO -   verbose: -1
2026-02-13 21:45:49,848 - retention_system - INFO -   random_state: 42
2026-02-13 21:45:49,848 - retention_system - INFO - 
Training LightGBM model...
2026-02-13 21:45:54,345 - retention_system - INFO - 
✓ Model trained successfully
2026-02-13 21:45:54,346 - retention_system - INFO - Best iteration: 998
2026-02-13 21:45:54,346 - retention_system - INFO - Best score (RMSE): 2.3925
2026-02-13 21:45:54,346 - retention_system - INFO - 
Top 10 most important features:
2026-02-13 21:45:54,347 - retention_system - INFO -   customer_lifetime_days: 600343.38
2026-02-13 21:45:54,347 - retention_system - INFO -   avg_basket_size: 450576.24
2026-02-13 21:45:54,348 - retention_system - INFO -   rfm_monetary_total: 413675.92
2026-02-13 21:45:54,348 - retention_system - INFO -   rfm_monetary_std: 413665.49
2026-02-13 21:45:54,349 - retention_system - INFO -   rfm_monetary_avg: 345372.72
2026-02-13 21:45:54,349 - retention_system - INFO -   std_basket_size: 324040.79
2026-02-13 21:45:54,349 - retention_system - INFO -   engagement_score_normalized: 267553.25
2026-02-13 21:45:54,350 - retention_system - INFO -   rfm_frequency_count: 170121.48
2026-02-13 21:45:54,350 - retention_system - INFO -   purchase_frequency_per_month: 163294.81
2026-02-13 21:45:54,350 - retention_system - INFO -   product_diversity_hhi: 129591.64
2026-02-13 21:45:54,352 - retention_system - INFO - 
✓ Main CLV model trained successfully
2026-02-13 21:45:54,353 - retention_system - INFO - Completed: Model Training in 4.74 seconds
2026-02-13 21:45:54,353 - retention_system - INFO - Starting: Quantile Model Training
2026-02-13 21:45:54,354 - retention_system - INFO - 
================================================================================
2026-02-13 21:45:54,354 - retention_system - INFO - TRAINING QUANTILE REGRESSION MODELS
2026-02-13 21:45:54,354 - retention_system - INFO - ================================================================================
2026-02-13 21:45:54,354 - retention_system - INFO - 
Training 10th percentile model (lower bound)...
2026-02-13 21:45:54,754 - retention_system - INFO - 
Training 90th percentile model (upper bound)...
2026-02-13 21:45:59,705 - retention_system - INFO - 
✓ Quantile models trained successfully
2026-02-13 21:45:59,708 - retention_system - INFO - 
✓ Quantile models trained successfully
2026-02-13 21:45:59,708 - retention_system - INFO - Completed: Quantile Model Training in 5.36 seconds
2026-02-13 21:45:59,709 - retention_system - INFO - Starting: Model Evaluation
2026-02-13 21:45:59,709 - retention_system - INFO - 
================================================================================
2026-02-13 21:45:59,710 - retention_system - INFO - EVALUATING CLV PREDICTION MODEL
2026-02-13 21:45:59,710 - retention_system - INFO - ================================================================================
2026-02-13 21:46:00,043 - retention_system - INFO - Completed: Model Evaluation in 0.33 seconds
2026-02-13 22:03:04,105 - retention_system - INFO - Configuration loaded successfully
2026-02-13 22:03:04,107 - retention_system - INFO - Starting: CLV Target Creation
2026-02-13 22:03:04,108 - retention_system - INFO - Loading cleaned data from: data/processed/cleaned_data.parquet
2026-02-13 22:03:04,214 - retention_system - INFO - Loaded 163,246 transactions
2026-02-13 22:03:04,215 - retention_system - INFO - Loading features from: data/features/customer_features.parquet
2026-02-13 22:03:04,226 - retention_system - INFO - Loaded 13,843 feature rows
2026-02-13 22:03:04,227 - retention_system - INFO - ================================================================================
2026-02-13 22:03:04,227 - retention_system - INFO - CREATING CLV TARGETS
2026-02-13 22:03:04,228 - retention_system - INFO - ================================================================================
2026-02-13 22:03:04,229 - retention_system - INFO - Prediction horizon: 180 days
2026-02-13 22:03:04,232 - retention_system - INFO - Processing 14 snapshots
2026-02-13 22:03:04,497 - retention_system - INFO - 
CLV Target Statistics:
2026-02-13 22:03:04,497 - retention_system - INFO -   Total samples: 13,843
2026-02-13 22:03:04,498 - retention_system - INFO -   Mean CLV: $353.67
2026-02-13 22:03:04,499 - retention_system - INFO -   Median CLV: $0.00
2026-02-13 22:03:04,499 - retention_system - INFO -   Std CLV: $903.56
2026-02-13 22:03:04,500 - retention_system - INFO -   Max CLV: $23906.56
2026-02-13 22:03:04,500 - retention_system - INFO -   Customers with $0 CLV: 6,448 (46.6%)
2026-02-13 22:03:04,502 - retention_system - INFO - 
CLV Distribution (quartiles):
2026-02-13 22:03:04,502 - retention_system - INFO -   25th percentile: $0.00
2026-02-13 22:03:04,503 - retention_system - INFO -   50th percentile: $0.00
2026-02-13 22:03:04,504 - retention_system - INFO -   75th percentile: $426.71
2026-02-13 22:03:04,504 - retention_system - INFO -   90th percentile: $990.00
2026-02-13 22:03:04,504 - retention_system - INFO -   95th percentile: $1502.57
2026-02-13 22:03:04,504 - retention_system - INFO -   99th percentile: $3369.48
2026-02-13 22:03:04,506 - retention_system - INFO - 
✓ Created 13,843 CLV targets
2026-02-13 22:03:04,516 - retention_system - INFO - Saved targets to: outputs\clv_targets.parquet
2026-02-13 22:03:04,517 - retention_system - INFO - Completed: CLV Target Creation in 0.41 seconds
2026-02-13 22:03:04,518 - retention_system - INFO - Starting: Model Training
2026-02-13 22:03:04,519 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:04,520 - retention_system - INFO - PREPARING DATA FOR CLV PREDICTION
2026-02-13 22:03:04,520 - retention_system - INFO - ================================================================================
2026-02-13 22:03:04,574 - retention_system - INFO - Total samples: 99,805
2026-02-13 22:03:04,624 - retention_system - INFO - Selected 33 features for training
2026-02-13 22:03:04,696 - retention_system - INFO - Applied log transformation to target: log(1 + revenue)
2026-02-13 22:03:04,697 - retention_system - INFO - 
Train set: 71,860 samples
2026-02-13 22:03:04,697 - retention_system - INFO - Validation set: 7,984 samples
2026-02-13 22:03:04,698 - retention_system - INFO - Test set: 19,961 samples
2026-02-13 22:03:04,701 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:04,701 - retention_system - INFO - TRAINING CLV PREDICTION MODEL
2026-02-13 22:03:04,701 - retention_system - INFO - ================================================================================
2026-02-13 22:03:04,701 - retention_system - INFO - 
Model hyperparameters:
2026-02-13 22:03:04,702 - retention_system - INFO -   objective: regression
2026-02-13 22:03:04,702 - retention_system - INFO -   metric: rmse
2026-02-13 22:03:04,702 - retention_system - INFO -   boosting_type: gbdt
2026-02-13 22:03:04,702 - retention_system - INFO -   num_leaves: 31
2026-02-13 22:03:04,703 - retention_system - INFO -   learning_rate: 0.05
2026-02-13 22:03:04,703 - retention_system - INFO -   feature_fraction: 0.8
2026-02-13 22:03:04,703 - retention_system - INFO -   bagging_fraction: 0.8
2026-02-13 22:03:04,703 - retention_system - INFO -   bagging_freq: 5
2026-02-13 22:03:04,703 - retention_system - INFO -   max_depth: 7
2026-02-13 22:03:04,704 - retention_system - INFO -   min_child_samples: 20
2026-02-13 22:03:04,704 - retention_system - INFO -   verbose: -1
2026-02-13 22:03:04,704 - retention_system - INFO -   random_state: 42
2026-02-13 22:03:04,704 - retention_system - INFO - 
Training LightGBM model...
2026-02-13 22:03:09,871 - retention_system - INFO - 
✓ Model trained successfully
2026-02-13 22:03:09,871 - retention_system - INFO - Best iteration: 998
2026-02-13 22:03:09,872 - retention_system - INFO - Best score (RMSE): 2.3925
2026-02-13 22:03:09,872 - retention_system - INFO - 
Top 10 most important features:
2026-02-13 22:03:09,872 - retention_system - INFO -   customer_lifetime_days: 600343.38
2026-02-13 22:03:09,873 - retention_system - INFO -   avg_basket_size: 450576.24
2026-02-13 22:03:09,873 - retention_system - INFO -   rfm_monetary_total: 413675.92
2026-02-13 22:03:09,873 - retention_system - INFO -   rfm_monetary_std: 413665.49
2026-02-13 22:03:09,874 - retention_system - INFO -   rfm_monetary_avg: 345372.72
2026-02-13 22:03:09,874 - retention_system - INFO -   std_basket_size: 324040.79
2026-02-13 22:03:09,874 - retention_system - INFO -   engagement_score_normalized: 267553.25
2026-02-13 22:03:09,875 - retention_system - INFO -   rfm_frequency_count: 170121.48
2026-02-13 22:03:09,875 - retention_system - INFO -   purchase_frequency_per_month: 163294.81
2026-02-13 22:03:09,876 - retention_system - INFO -   product_diversity_hhi: 129591.64
2026-02-13 22:03:09,876 - retention_system - INFO - 
✓ Main CLV model trained successfully
2026-02-13 22:03:09,876 - retention_system - INFO - Completed: Model Training in 5.36 seconds
2026-02-13 22:03:09,877 - retention_system - INFO - Starting: Quantile Model Training
2026-02-13 22:03:09,878 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:09,878 - retention_system - INFO - TRAINING QUANTILE REGRESSION MODELS
2026-02-13 22:03:09,878 - retention_system - INFO - ================================================================================
2026-02-13 22:03:09,879 - retention_system - INFO - 
Training 10th percentile model (lower bound)...
2026-02-13 22:03:10,418 - retention_system - INFO - 
Training 90th percentile model (upper bound)...
2026-02-13 22:03:15,604 - retention_system - INFO - 
✓ Quantile models trained successfully
2026-02-13 22:03:15,605 - retention_system - INFO - 
✓ Quantile models trained successfully
2026-02-13 22:03:15,605 - retention_system - INFO - Completed: Quantile Model Training in 5.73 seconds
2026-02-13 22:03:15,606 - retention_system - INFO - Starting: Model Evaluation
2026-02-13 22:03:15,606 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:15,606 - retention_system - INFO - EVALUATING CLV PREDICTION MODEL
2026-02-13 22:03:15,607 - retention_system - INFO - ================================================================================
2026-02-13 22:03:15,905 - retention_system - WARNING - Removing 1198 samples with NaN values
2026-02-13 22:03:15,908 - retention_system - INFO - Regression metrics (original scale):
2026-02-13 22:03:15,909 - retention_system - INFO -   RMSE: $576.39
2026-02-13 22:03:15,909 - retention_system - INFO -   MAE: $271.85
2026-02-13 22:03:15,909 - retention_system - INFO -   R² Score: 0.4907
2026-02-13 22:03:15,910 - retention_system - INFO -   MAPE: 80.01%
2026-02-13 22:03:15,910 - retention_system - INFO - 
Portfolio-level metrics:
2026-02-13 22:03:15,910 - retention_system - INFO -   Total actual CLV: $6,600,281.25
2026-02-13 22:03:15,910 - retention_system - INFO -   Total predicted CLV: $4,322,164.34
2026-02-13 22:03:15,911 - retention_system - INFO -   Portfolio error: 34.52%
2026-02-13 22:03:15,911 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:15,912 - retention_system - INFO - DECILE ANALYSIS
2026-02-13 22:03:15,912 - retention_system - INFO - ================================================================================
2026-02-13 22:03:15,928 - retention_system - INFO - 
Decile analysis (top decile = highest predicted CLV):
2026-02-13 22:03:15,928 - retention_system - INFO -   Decile 1: Actual=$2,660,776 (40.3%), Predicted=$2,644,390, Count=1877
2026-02-13 22:03:15,929 - retention_system - INFO -   Decile 2: Actual=$957,302 (14.5%), Predicted=$784,540, Count=1876
2026-02-13 22:03:15,929 - retention_system - INFO -   Decile 3: Actual=$664,885 (10.1%), Predicted=$428,645, Count=1876
2026-02-13 22:03:15,930 - retention_system - INFO -   Decile 4: Actual=$597,638 (9.1%), Predicted=$230,710, Count=1876
2026-02-13 22:03:15,930 - retention_system - INFO -   Decile 5: Actual=$594,950 (9.0%), Predicted=$122,997, Count=1877
2026-02-13 22:03:15,931 - retention_system - INFO -   Decile 6: Actual=$478,238 (7.2%), Predicted=$63,140, Count=1876
2026-02-13 22:03:15,932 - retention_system - INFO -   Decile 7: Actual=$298,937 (4.5%), Predicted=$28,127, Count=1876
2026-02-13 22:03:15,933 - retention_system - INFO -   Decile 8: Actual=$201,455 (3.1%), Predicted=$12,711, Count=1876
2026-02-13 22:03:15,933 - retention_system - INFO -   Decile 9: Actual=$94,266 (1.4%), Predicted=$5,435, Count=1876
2026-02-13 22:03:15,934 - retention_system - INFO -   Decile 10: Actual=$51,834 (0.8%), Predicted=$1,470, Count=1877
2026-02-13 22:03:15,935 - retention_system - INFO - 
Metrics saved to: outputs\clv_model_metrics.json
2026-02-13 22:03:15,942 - retention_system - INFO - Decile analysis saved to: outputs\clv_decile_analysis.csv
2026-02-13 22:03:15,942 - retention_system - INFO - Completed: Model Evaluation in 0.34 seconds
2026-02-13 22:03:15,944 - retention_system - INFO - Starting: Prediction Generation
2026-02-13 22:03:15,946 - retention_system - INFO - Generating predictions for 1,937 customers
2026-02-13 22:03:16,072 - retention_system - INFO - Predictions saved to: outputs\clv_predictions.parquet
2026-02-13 22:03:16,073 - retention_system - INFO - 
CLV prediction statistics:
2026-02-13 22:03:16,073 - retention_system - INFO -   Mean: $181.58
2026-02-13 22:03:16,074 - retention_system - INFO -   Median: $23.53
2026-02-13 22:03:16,074 - retention_system - INFO -   Std: $510.94
2026-02-13 22:03:16,074 - retention_system - INFO -   Min: $0.00
2026-02-13 22:03:16,075 - retention_system - INFO -   Max: $11841.03
2026-02-13 22:03:16,076 - retention_system - INFO - 
CLV segments:
2026-02-13 22:03:16,078 - retention_system - INFO -   Low: 1,322 (68.2%)
2026-02-13 22:03:16,078 - retention_system - INFO -   Medium: 271 (14.0%)
2026-02-13 22:03:16,078 - retention_system - INFO -   High: 142 (7.3%)
2026-02-13 22:03:16,079 - retention_system - INFO -   Very High: 182 (9.4%)
2026-02-13 22:03:16,079 - retention_system - INFO - Completed: Prediction Generation in 0.13 seconds
2026-02-13 22:03:16,080 - retention_system - INFO - Starting: Risk-Adjusted CLV
2026-02-13 22:03:16,080 - retention_system - INFO - Loading churn predictions...
2026-02-13 22:03:16,103 - retention_system - INFO - Risk-adjusted predictions saved to: outputs\clv_predictions_risk_adjusted.parquet
2026-02-13 22:03:16,104 - retention_system - INFO - 
Risk-adjusted CLV statistics:
2026-02-13 22:03:16,104 - retention_system - INFO -   Mean base CLV: $181.58
2026-02-13 22:03:16,105 - retention_system - INFO -   Mean risk-adjusted CLV: $154.55
2026-02-13 22:03:16,105 - retention_system - INFO -   Mean expected loss: $27.03
2026-02-13 22:03:16,106 - retention_system - INFO -   Total expected loss: $52,354.39
2026-02-13 22:03:16,106 - retention_system - INFO - 
Top 10 customers by risk-adjusted CLV:
2026-02-13 22:03:16,109 - retention_system - INFO -   14911.0: CLV=$11841.03, Churn=0.2%, Risk-adjusted=$11815.86
2026-02-13 22:03:16,110 - retention_system - INFO -   13089.0: CLV=$7983.87, Churn=0.0%, Risk-adjusted=$7983.20
2026-02-13 22:03:16,111 - retention_system - INFO -   17841.0: CLV=$4376.15, Churn=0.1%, Risk-adjusted=$4373.93
2026-02-13 22:03:16,111 - retention_system - INFO -   15311.0: CLV=$4196.12, Churn=0.0%, Risk-adjusted=$4195.46
2026-02-13 22:03:16,112 - retention_system - INFO -   15159.0: CLV=$3673.36, Churn=0.3%, Risk-adjusted=$3664.16
2026-02-13 22:03:16,112 - retention_system - INFO -   14646.0: CLV=$3589.28, Churn=0.5%, Risk-adjusted=$3571.06
2026-02-13 22:03:16,112 - retention_system - INFO -   14096.0: CLV=$4729.96, Churn=31.6%, Risk-adjusted=$3236.75
2026-02-13 22:03:16,114 - retention_system - INFO -   13098.0: CLV=$3232.51, Churn=0.6%, Risk-adjusted=$3213.76
2026-02-13 22:03:16,116 - retention_system - INFO -   12471.0: CLV=$2965.41, Churn=0.3%, Risk-adjusted=$2956.02
2026-02-13 22:03:16,116 - retention_system - INFO -   15189.0: CLV=$2931.98, Churn=0.0%, Risk-adjusted=$2931.65
2026-02-13 22:03:16,117 - retention_system - INFO - Completed: Risk-Adjusted CLV in 0.04 seconds
2026-02-13 22:03:16,118 - retention_system - INFO - Starting: Feature Importance
2026-02-13 22:03:16,118 - retention_system - INFO - 
Top 20 most important features for CLV prediction:
2026-02-13 22:03:16,119 - retention_system - INFO -   customer_lifetime_days: 600343.38
2026-02-13 22:03:16,119 - retention_system - INFO -   avg_basket_size: 450576.24
2026-02-13 22:03:16,119 - retention_system - INFO -   rfm_monetary_total: 413675.92
2026-02-13 22:03:16,120 - retention_system - INFO -   rfm_monetary_std: 413665.49
2026-02-13 22:03:16,120 - retention_system - INFO -   rfm_monetary_avg: 345372.72
2026-02-13 22:03:16,121 - retention_system - INFO -   std_basket_size: 324040.79
2026-02-13 22:03:16,121 - retention_system - INFO -   engagement_score_normalized: 267553.25
2026-02-13 22:03:16,122 - retention_system - INFO -   rfm_frequency_count: 170121.48
2026-02-13 22:03:16,122 - retention_system - INFO -   purchase_frequency_per_month: 163294.81
2026-02-13 22:03:16,123 - retention_system - INFO -   product_diversity_hhi: 129591.64
2026-02-13 22:03:16,123 - retention_system - INFO -   revenue_long_90d: 126172.54
2026-02-13 22:03:16,124 - retention_system - INFO -   engagement_score: 123142.77
2026-02-13 22:03:16,124 - retention_system - INFO -   revenue_very_long_180d: 105554.57
2026-02-13 22:03:16,125 - retention_system - INFO -   unique_products_count: 66240.69
2026-02-13 22:03:16,125 - retention_system - INFO -   revenue_trend_slope: 46068.48
2026-02-13 22:03:16,126 - retention_system - INFO -   return_rate: 44297.22
2026-02-13 22:03:16,126 - retention_system - INFO -   rfm_recency_days: 39206.80
2026-02-13 22:03:16,127 - retention_system - INFO -   transaction_trend_slope: 34678.55
2026-02-13 22:03:16,127 - retention_system - INFO -   days_since_first_purchase: 33661.35
2026-02-13 22:03:16,128 - retention_system - INFO -   txn_count_very_long_180d: 26894.17
2026-02-13 22:03:16,131 - retention_system - INFO - 
Feature importance saved to: outputs\clv_feature_importance.csv
2026-02-13 22:03:16,132 - retention_system - INFO - Completed: Feature Importance in 0.01 seconds
2026-02-13 22:03:16,134 - retention_system - INFO - Starting: Model Saving
2026-02-13 22:03:16,327 - retention_system - INFO - Model saved to: models\clv_predictor.pkl
2026-02-13 22:03:16,327 - retention_system - INFO - ✓ Model saved to: models\clv_predictor.pkl
2026-02-13 22:03:16,328 - retention_system - INFO - Completed: Model Saving in 0.19 seconds
2026-02-13 22:03:16,329 - retention_system - INFO - ✓ Task 3.1: CLV Target Creation - COMPLETE
2026-02-13 22:03:16,329 - retention_system - INFO - ✓ Task 3.2: Model Training - COMPLETE
2026-02-13 22:03:16,329 - retention_system - INFO - ✓ Task 3.3: Quantile Models - COMPLETE
2026-02-13 22:03:16,329 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:16,330 - retention_system - INFO - PILLAR 3 STATUS: 3/3 TASKS COMPLETE ✓
2026-02-13 22:03:16,330 - retention_system - INFO - ================================================================================
2026-02-13 22:03:16,330 - retention_system - INFO - 
Key Results:
2026-02-13 22:03:16,330 - retention_system - INFO -   - Targets created: 13,843
2026-02-13 22:03:16,331 - retention_system - INFO -   - Test RMSE: $576.39
2026-02-13 22:03:16,331 - retention_system - INFO -   - Test R² Score: 0.4907
2026-02-13 22:03:16,331 - retention_system - INFO -   - Test MAPE: 80.01%
2026-02-13 22:03:16,331 - retention_system - INFO -   - Portfolio error: 34.52%
2026-02-13 22:03:16,332 - retention_system - INFO - 
CLV Distribution:
2026-02-13 22:03:16,333 - retention_system - INFO -   25th percentile: $4.37
2026-02-13 22:03:16,333 - retention_system - INFO -   50th percentile: $23.53
2026-02-13 22:03:16,334 - retention_system - INFO -   75th percentile: $161.03
2026-02-13 22:03:16,334 - retention_system - INFO -   90th percentile: $474.30
2026-02-13 22:03:16,334 - retention_system - INFO - 
Output files created:
2026-02-13 22:03:16,335 - retention_system - INFO -   1. CLV targets: outputs\clv_targets.parquet
2026-02-13 22:03:16,335 - retention_system - INFO -   2. Model metrics: outputs\clv_model_metrics.json
2026-02-13 22:03:16,335 - retention_system - INFO -   3. Decile analysis: outputs\clv_decile_analysis.csv
2026-02-13 22:03:16,335 - retention_system - INFO -   4. CLV predictions: outputs\clv_predictions.parquet
2026-02-13 22:03:16,336 - retention_system - INFO -   5. Risk-adjusted CLV: outputs\clv_predictions_risk_adjusted.parquet
2026-02-13 22:03:16,336 - retention_system - INFO -   6. Feature importance: outputs\clv_feature_importance.csv
2026-02-13 22:03:16,336 - retention_system - INFO -   7. Trained model: models\clv_predictor.pkl
2026-02-13 22:03:16,336 - retention_system - INFO - 
Top 3 predictive features:
2026-02-13 22:03:16,337 - retention_system - INFO -   customer_lifetime_days: 600343.38
2026-02-13 22:03:16,337 - retention_system - INFO -   avg_basket_size: 450576.24
2026-02-13 22:03:16,338 - retention_system - INFO -   rfm_monetary_total: 413675.92
2026-02-13 22:03:16,338 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:16,339 - retention_system - INFO - OVERALL PROGRESS: 17/18 TASKS COMPLETE (94%)
2026-02-13 22:03:16,339 - retention_system - INFO - ================================================================================
2026-02-13 22:03:16,339 - retention_system - INFO - Pillar 0: ✓ Complete (6/6 tasks)
2026-02-13 22:03:16,340 - retention_system - INFO - Pillar 1: ✓ Complete (4/4 tasks)
2026-02-13 22:03:16,340 - retention_system - INFO - Pillar 2: ✓ Complete (4/4 tasks)
2026-02-13 22:03:16,341 - retention_system - INFO - Pillar 3: ✓ Complete (3/3 tasks)
2026-02-13 22:03:16,341 - retention_system - INFO - Pillar 4: ⏳ Pending (0/3 tasks) - Revenue Optimization
2026-02-13 22:03:16,341 - retention_system - INFO - 
Next steps:
2026-02-13 22:03:16,341 - retention_system - INFO -   → Proceed to Pillar 4: Revenue Optimization
2026-02-13 22:03:16,342 - retention_system - INFO -   → Combine churn probability + CLV for optimal targeting
2026-02-13 22:03:16,342 - retention_system - INFO -   → Run: python pillar_4_optimization.py
2026-02-13 22:03:16,342 - retention_system - INFO - 
Business Actions:
2026-02-13 22:03:16,342 - retention_system - INFO -   → Focus retention efforts on high CLV customers
2026-02-13 22:03:16,343 - retention_system - INFO -   → Use risk-adjusted CLV for budget allocation
2026-02-13 22:03:16,343 - retention_system - INFO -   → Target high (CLV × churn_risk) customers first
2026-02-13 22:03:29,817 - retention_system - INFO - Configuration loaded successfully
2026-02-13 22:03:29,818 - retention_system - INFO - ================================================================================
2026-02-13 22:03:29,818 - retention_system - INFO - THIS IS THE FINAL PILLAR - COMPLETING THE ENTIRE SYSTEM!
2026-02-13 22:03:29,818 - retention_system - INFO - ================================================================================
2026-02-13 22:03:29,819 - retention_system - INFO - Starting: Data Loading
2026-02-13 22:03:29,820 - retention_system - INFO - Loading CLV predictions...
2026-02-13 22:03:29,891 - retention_system - INFO - ✓ Loaded CLV predictions: 1,937 customers
2026-02-13 22:03:29,892 - retention_system - INFO - Loading churn predictions...
2026-02-13 22:03:29,907 - retention_system - INFO - ✓ Loaded churn predictions: 1,937 customers
2026-02-13 22:03:29,907 - retention_system - INFO - Loading segment assignments...
2026-02-13 22:03:29,922 - retention_system - INFO - ✓ Loaded segment assignments: 1,937 customers
2026-02-13 22:03:29,922 - retention_system - INFO - 
✓ All predictions loaded successfully
2026-02-13 22:03:29,923 - retention_system - INFO - Completed: Data Loading in 0.10 seconds
2026-02-13 22:03:29,924 - retention_system - INFO - Starting: Expected Value Calculation
2026-02-13 22:03:29,924 - retention_system - INFO - Campaign definitions:
2026-02-13 22:03:29,924 - retention_system - INFO -   Premium Retention: Cost=$50.0, Retention=60%
2026-02-13 22:03:29,924 - retention_system - INFO -   Standard Retention: Cost=$25.0, Retention=40%
2026-02-13 22:03:29,925 - retention_system - INFO -   Light Touch: Cost=$10.0, Retention=20%
2026-02-13 22:03:29,925 - retention_system - INFO -   No Intervention: Cost=$0.0, Retention=0%
2026-02-13 22:03:29,928 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:29,929 - retention_system - INFO - BASELINE ANALYSIS (No Intervention)
2026-02-13 22:03:29,929 - retention_system - INFO - ================================================================================
2026-02-13 22:03:29,929 - retention_system - INFO - Total customers: 1,937
2026-02-13 22:03:29,930 - retention_system - INFO - Total potential CLV: $351,718.07
2026-02-13 22:03:29,931 - retention_system - INFO - Expected churn loss (no action): $52,354.39
2026-02-13 22:03:29,931 - retention_system - INFO - Average churn probability: 53.9%
2026-02-13 22:03:29,931 - retention_system - INFO - 
Expected loss by risk level:
2026-02-13 22:03:29,933 - retention_system - INFO -   Low: 544 customers, $17,301.96 expected loss (33.0%)
2026-02-13 22:03:29,934 - retention_system - INFO -   Medium: 274 customers, $15,769.04 expected loss (30.1%)
2026-02-13 22:03:29,935 - retention_system - INFO -   High: 342 customers, $11,038.93 expected loss (21.1%)
2026-02-13 22:03:29,937 - retention_system - INFO -   Very High: 777 customers, $8,244.46 expected loss (15.7%)
2026-02-13 22:03:29,937 - retention_system - INFO - 
✓ Expected value framework established
2026-02-13 22:03:29,938 - retention_system - INFO - Completed: Expected Value Calculation in 0.01 seconds
2026-02-13 22:03:29,940 - retention_system - INFO - Starting: Budget Optimization
2026-02-13 22:03:29,940 - retention_system - INFO - 
Optimizing for budget: $50,000.00
2026-02-13 22:03:29,940 - retention_system - INFO - Minimum ROI threshold: 0%
2026-02-13 22:03:29,940 - retention_system - INFO - ================================================================================
2026-02-13 22:03:29,941 - retention_system - INFO - OPTIMIZING BUDGET ALLOCATION
2026-02-13 22:03:29,941 - retention_system - INFO - ================================================================================
2026-02-13 22:03:29,941 - retention_system - INFO - Total budget: $50,000.00
2026-02-13 22:03:29,942 - retention_system - INFO - Minimum ROI threshold: 0.0%
2026-02-13 22:03:29,961 - retention_system - INFO - 
Customers with ROI >= 0%: 273
2026-02-13 22:03:30,000 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,000 - retention_system - INFO - ALLOCATION RESULTS
2026-02-13 22:03:30,000 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,001 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,001 - retention_system - INFO - Budget used: $6,580.00 (13.2%)
2026-02-13 22:03:30,001 - retention_system - INFO - Budget remaining: $43,420.00
2026-02-13 22:03:30,001 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,001 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,002 - retention_system - INFO - Expected ROI: 120.3%
2026-02-13 22:03:30,011 - retention_system - INFO - 
Campaign distribution:
2026-02-13 22:03:30,015 - retention_system - INFO -   light: 118 customers, $1,180.00 cost, $1,438.44 expected revenue
2026-02-13 22:03:30,018 - retention_system - INFO -   standard: 94 customers, $2,350.00 cost, $3,669.69 expected revenue
2026-02-13 22:03:30,022 - retention_system - INFO -   premium: 61 customers, $3,050.00 cost, $9,390.71 expected revenue
2026-02-13 22:03:30,037 - retention_system - INFO - 
✓ Optimal allocation saved to: outputs\optimal_campaign_allocation.parquet
2026-02-13 22:03:30,039 - retention_system - INFO - Completed: Budget Optimization in 0.10 seconds
2026-02-13 22:03:30,043 - retention_system - INFO - Starting: Portfolio Metrics
2026-02-13 22:03:30,044 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,045 - retention_system - INFO - PORTFOLIO METRICS
2026-02-13 22:03:30,046 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,055 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,056 - retention_system - INFO - Total cost: $6,580.00
2026-02-13 22:03:30,057 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,057 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,058 - retention_system - INFO - Portfolio ROI: 120.3%
2026-02-13 22:03:30,059 - retention_system - INFO - Expected customers saved: 41
2026-02-13 22:03:30,059 - retention_system - INFO - Cost per customer saved: $161.46
2026-02-13 22:03:30,063 - retention_system - INFO - 
✓ Metrics saved to: outputs\optimization_metrics.json
2026-02-13 22:03:30,067 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,068 - retention_system - INFO - IMPACT ANALYSIS
2026-02-13 22:03:30,068 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,069 - retention_system - INFO - Baseline (no intervention):
2026-02-13 22:03:30,070 - retention_system - INFO -   Expected churn loss: $32,017.62
2026-02-13 22:03:30,071 - retention_system - INFO - 
With optimized campaigns:
2026-02-13 22:03:30,072 - retention_system - INFO -   Campaign cost: $6,580.00
2026-02-13 22:03:30,073 - retention_system - INFO -   Revenue saved: $14,498.84
2026-02-13 22:03:30,074 - retention_system - INFO -   Net value: $7,918.84
2026-02-13 22:03:30,075 - retention_system - INFO -   ROI: 120.3%
2026-02-13 22:03:30,076 - retention_system - INFO -   Lift vs baseline: 45.3%
2026-02-13 22:03:30,077 - retention_system - INFO -   Customers saved: 41
2026-02-13 22:03:30,077 - retention_system - INFO - Completed: Portfolio Metrics in 0.03 seconds
2026-02-13 22:03:30,080 - retention_system - INFO - Starting: Sensitivity Analysis
2026-02-13 22:03:30,081 - retention_system - INFO - 
Testing 5 budget scenarios...
2026-02-13 22:03:30,082 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,082 - retention_system - INFO - OPTIMIZING BUDGET ALLOCATION
2026-02-13 22:03:30,083 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,084 - retention_system - INFO - Total budget: $25,000.00
2026-02-13 22:03:30,085 - retention_system - INFO - Minimum ROI threshold: 0.0%
2026-02-13 22:03:30,123 - retention_system - INFO - 
Customers with ROI >= 0%: 273
2026-02-13 22:03:30,192 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,193 - retention_system - INFO - ALLOCATION RESULTS
2026-02-13 22:03:30,193 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,194 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,194 - retention_system - INFO - Budget used: $6,580.00 (26.3%)
2026-02-13 22:03:30,194 - retention_system - INFO - Budget remaining: $18,420.00
2026-02-13 22:03:30,195 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,195 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,196 - retention_system - INFO - Expected ROI: 120.3%
2026-02-13 22:03:30,197 - retention_system - INFO - 
Campaign distribution:
2026-02-13 22:03:30,199 - retention_system - INFO -   light: 118 customers, $1,180.00 cost, $1,438.44 expected revenue
2026-02-13 22:03:30,201 - retention_system - INFO -   standard: 94 customers, $2,350.00 cost, $3,669.69 expected revenue
2026-02-13 22:03:30,203 - retention_system - INFO -   premium: 61 customers, $3,050.00 cost, $9,390.71 expected revenue
2026-02-13 22:03:30,204 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,204 - retention_system - INFO - PORTFOLIO METRICS
2026-02-13 22:03:30,205 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,208 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,209 - retention_system - INFO - Total cost: $6,580.00
2026-02-13 22:03:30,209 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,210 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,210 - retention_system - INFO - Portfolio ROI: 120.3%
2026-02-13 22:03:30,210 - retention_system - INFO - Expected customers saved: 41
2026-02-13 22:03:30,211 - retention_system - INFO - Cost per customer saved: $161.46
2026-02-13 22:03:30,211 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,212 - retention_system - INFO - OPTIMIZING BUDGET ALLOCATION
2026-02-13 22:03:30,212 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,213 - retention_system - INFO - Total budget: $37,500.00
2026-02-13 22:03:30,213 - retention_system - INFO - Minimum ROI threshold: 0.0%
2026-02-13 22:03:30,236 - retention_system - INFO - 
Customers with ROI >= 0%: 273
2026-02-13 22:03:30,303 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,303 - retention_system - INFO - ALLOCATION RESULTS
2026-02-13 22:03:30,303 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,304 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,304 - retention_system - INFO - Budget used: $6,580.00 (17.5%)
2026-02-13 22:03:30,304 - retention_system - INFO - Budget remaining: $30,920.00
2026-02-13 22:03:30,304 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,305 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,305 - retention_system - INFO - Expected ROI: 120.3%
2026-02-13 22:03:30,306 - retention_system - INFO - 
Campaign distribution:
2026-02-13 22:03:30,307 - retention_system - INFO -   light: 118 customers, $1,180.00 cost, $1,438.44 expected revenue
2026-02-13 22:03:30,308 - retention_system - INFO -   standard: 94 customers, $2,350.00 cost, $3,669.69 expected revenue
2026-02-13 22:03:30,309 - retention_system - INFO -   premium: 61 customers, $3,050.00 cost, $9,390.71 expected revenue
2026-02-13 22:03:30,309 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,310 - retention_system - INFO - PORTFOLIO METRICS
2026-02-13 22:03:30,310 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,312 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,312 - retention_system - INFO - Total cost: $6,580.00
2026-02-13 22:03:30,312 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,313 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,313 - retention_system - INFO - Portfolio ROI: 120.3%
2026-02-13 22:03:30,313 - retention_system - INFO - Expected customers saved: 41
2026-02-13 22:03:30,313 - retention_system - INFO - Cost per customer saved: $161.46
2026-02-13 22:03:30,314 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,314 - retention_system - INFO - OPTIMIZING BUDGET ALLOCATION
2026-02-13 22:03:30,314 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,314 - retention_system - INFO - Total budget: $50,000.00
2026-02-13 22:03:30,315 - retention_system - INFO - Minimum ROI threshold: 0.0%
2026-02-13 22:03:30,328 - retention_system - INFO - 
Customers with ROI >= 0%: 273
2026-02-13 22:03:30,363 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,364 - retention_system - INFO - ALLOCATION RESULTS
2026-02-13 22:03:30,364 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,365 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,365 - retention_system - INFO - Budget used: $6,580.00 (13.2%)
2026-02-13 22:03:30,365 - retention_system - INFO - Budget remaining: $43,420.00
2026-02-13 22:03:30,366 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,366 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,366 - retention_system - INFO - Expected ROI: 120.3%
2026-02-13 22:03:30,367 - retention_system - INFO - 
Campaign distribution:
2026-02-13 22:03:30,368 - retention_system - INFO -   light: 118 customers, $1,180.00 cost, $1,438.44 expected revenue
2026-02-13 22:03:30,369 - retention_system - INFO -   standard: 94 customers, $2,350.00 cost, $3,669.69 expected revenue
2026-02-13 22:03:30,370 - retention_system - INFO -   premium: 61 customers, $3,050.00 cost, $9,390.71 expected revenue
2026-02-13 22:03:30,371 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,371 - retention_system - INFO - PORTFOLIO METRICS
2026-02-13 22:03:30,371 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,373 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,374 - retention_system - INFO - Total cost: $6,580.00
2026-02-13 22:03:30,374 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,374 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,374 - retention_system - INFO - Portfolio ROI: 120.3%
2026-02-13 22:03:30,375 - retention_system - INFO - Expected customers saved: 41
2026-02-13 22:03:30,375 - retention_system - INFO - Cost per customer saved: $161.46
2026-02-13 22:03:30,375 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,375 - retention_system - INFO - OPTIMIZING BUDGET ALLOCATION
2026-02-13 22:03:30,376 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,376 - retention_system - INFO - Total budget: $75,000.00
2026-02-13 22:03:30,376 - retention_system - INFO - Minimum ROI threshold: 0.0%
2026-02-13 22:03:30,389 - retention_system - INFO - 
Customers with ROI >= 0%: 273
2026-02-13 22:03:30,424 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,424 - retention_system - INFO - ALLOCATION RESULTS
2026-02-13 22:03:30,424 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,425 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,425 - retention_system - INFO - Budget used: $6,580.00 (8.8%)
2026-02-13 22:03:30,425 - retention_system - INFO - Budget remaining: $68,420.00
2026-02-13 22:03:30,426 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,426 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,426 - retention_system - INFO - Expected ROI: 120.3%
2026-02-13 22:03:30,427 - retention_system - INFO - 
Campaign distribution:
2026-02-13 22:03:30,428 - retention_system - INFO -   light: 118 customers, $1,180.00 cost, $1,438.44 expected revenue
2026-02-13 22:03:30,429 - retention_system - INFO -   standard: 94 customers, $2,350.00 cost, $3,669.69 expected revenue
2026-02-13 22:03:30,430 - retention_system - INFO -   premium: 61 customers, $3,050.00 cost, $9,390.71 expected revenue
2026-02-13 22:03:30,431 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,432 - retention_system - INFO - PORTFOLIO METRICS
2026-02-13 22:03:30,432 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,435 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,435 - retention_system - INFO - Total cost: $6,580.00
2026-02-13 22:03:30,435 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,436 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,436 - retention_system - INFO - Portfolio ROI: 120.3%
2026-02-13 22:03:30,436 - retention_system - INFO - Expected customers saved: 41
2026-02-13 22:03:30,436 - retention_system - INFO - Cost per customer saved: $161.46
2026-02-13 22:03:30,437 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,437 - retention_system - INFO - OPTIMIZING BUDGET ALLOCATION
2026-02-13 22:03:30,437 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,437 - retention_system - INFO - Total budget: $100,000.00
2026-02-13 22:03:30,438 - retention_system - INFO - Minimum ROI threshold: 0.0%
2026-02-13 22:03:30,453 - retention_system - INFO - 
Customers with ROI >= 0%: 273
2026-02-13 22:03:30,509 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,510 - retention_system - INFO - ALLOCATION RESULTS
2026-02-13 22:03:30,510 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,510 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,510 - retention_system - INFO - Budget used: $6,580.00 (6.6%)
2026-02-13 22:03:30,511 - retention_system - INFO - Budget remaining: $93,420.00
2026-02-13 22:03:30,511 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,511 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,512 - retention_system - INFO - Expected ROI: 120.3%
2026-02-13 22:03:30,513 - retention_system - INFO - 
Campaign distribution:
2026-02-13 22:03:30,514 - retention_system - INFO -   light: 118 customers, $1,180.00 cost, $1,438.44 expected revenue
2026-02-13 22:03:30,515 - retention_system - INFO -   standard: 94 customers, $2,350.00 cost, $3,669.69 expected revenue
2026-02-13 22:03:30,517 - retention_system - INFO -   premium: 61 customers, $3,050.00 cost, $9,390.71 expected revenue
2026-02-13 22:03:30,518 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,519 - retention_system - INFO - PORTFOLIO METRICS
2026-02-13 22:03:30,519 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,522 - retention_system - INFO - Customers targeted: 273
2026-02-13 22:03:30,522 - retention_system - INFO - Total cost: $6,580.00
2026-02-13 22:03:30,522 - retention_system - INFO - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,523 - retention_system - INFO - Expected net value: $7,918.84
2026-02-13 22:03:30,523 - retention_system - INFO - Portfolio ROI: 120.3%
2026-02-13 22:03:30,523 - retention_system - INFO - Expected customers saved: 41
2026-02-13 22:03:30,524 - retention_system - INFO - Cost per customer saved: $161.46
2026-02-13 22:03:30,529 - retention_system - INFO - 
✓ Sensitivity analysis saved to: outputs\budget_sensitivity.csv
2026-02-13 22:03:30,530 - retention_system - INFO - 
Budget sensitivity results:
2026-02-13 22:03:30,531 - retention_system - INFO -   $25,000: 273.0 customers, $7,918.84 value, 120.3% ROI
2026-02-13 22:03:30,532 - retention_system - INFO -   $37,500: 273.0 customers, $7,918.84 value, 120.3% ROI
2026-02-13 22:03:30,532 - retention_system - INFO -   $50,000: 273.0 customers, $7,918.84 value, 120.3% ROI
2026-02-13 22:03:30,532 - retention_system - INFO -   $75,000: 273.0 customers, $7,918.84 value, 120.3% ROI
2026-02-13 22:03:30,533 - retention_system - INFO -   $100,000: 273.0 customers, $7,918.84 value, 120.3% ROI
2026-02-13 22:03:30,534 - retention_system - INFO - Completed: Sensitivity Analysis in 0.45 seconds
2026-02-13 22:03:30,535 - retention_system - INFO - Starting: Execution Plan
2026-02-13 22:03:30,543 - retention_system - INFO - ✓ Execution plan saved to: outputs\campaign_execution_plan.csv
2026-02-13 22:03:30,544 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,544 - retention_system - INFO - CAMPAIGN EXECUTION SUMMARY
2026-02-13 22:03:30,545 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,546 - retention_system - INFO - 
PREMIUM Campaign:
2026-02-13 22:03:30,547 - retention_system - INFO -   Customers: 61
2026-02-13 22:03:30,547 - retention_system - INFO -   Total cost: $3,050.00
2026-02-13 22:03:30,548 - retention_system - INFO -   Expected revenue: $9,390.71
2026-02-13 22:03:30,548 - retention_system - INFO -   Expected value: $6,340.71
2026-02-13 22:03:30,549 - retention_system - INFO -   Avg churn probability: 47.7%
2026-02-13 22:03:30,550 - retention_system - INFO -   Avg CLV: $659.83
2026-02-13 22:03:30,550 - retention_system - INFO -   Top 5 priorities:
2026-02-13 22:03:30,551 - retention_system - INFO -     1. Customer 14096.0: CLV=$4729.96, Churn=31.6%, Value=$845.93
2026-02-13 22:03:30,551 - retention_system - INFO -     2. Customer 13209.0: CLV=$1481.21, Churn=65.1%, Value=$528.34
2026-02-13 22:03:30,552 - retention_system - INFO -     3. Customer 14415.0: CLV=$1759.64, Churn=41.5%, Value=$387.84
2026-02-13 22:03:30,552 - retention_system - INFO -     4. Customer 15856.0: CLV=$1598.02, Churn=33.8%, Value=$273.85
2026-02-13 22:03:30,553 - retention_system - INFO -     5. Customer 15358.0: CLV=$544.13, Churn=72.3%, Value=$185.90
2026-02-13 22:03:30,554 - retention_system - INFO - 
STANDARD Campaign:
2026-02-13 22:03:30,554 - retention_system - INFO -   Customers: 94
2026-02-13 22:03:30,555 - retention_system - INFO -   Total cost: $2,350.00
2026-02-13 22:03:30,555 - retention_system - INFO -   Expected revenue: $3,669.69
2026-02-13 22:03:30,556 - retention_system - INFO -   Expected value: $1,319.69
2026-02-13 22:03:30,556 - retention_system - INFO -   Avg churn probability: 40.1%
2026-02-13 22:03:30,557 - retention_system - INFO -   Avg CLV: $320.41
2026-02-13 22:03:30,557 - retention_system - INFO -   Top 5 priorities:
2026-02-13 22:03:30,558 - retention_system - INFO -     1. Customer 17920.0: CLV=$304.80, Churn=40.2%, Value=$24.03
2026-02-13 22:03:30,558 - retention_system - INFO -     2. Customer 13571.0: CLV=$558.04, Churn=21.9%, Value=$23.95
2026-02-13 22:03:30,559 - retention_system - INFO -     3. Customer 14688.0: CLV=$635.47, Churn=19.2%, Value=$23.88
2026-02-13 22:03:30,559 - retention_system - INFO -     4. Customer 14626.0: CLV=$319.96, Churn=37.8%, Value=$23.43
2026-02-13 22:03:30,559 - retention_system - INFO -     5. Customer 17191.0: CLV=$383.31, Churn=31.5%, Value=$23.34
2026-02-13 22:03:30,560 - retention_system - INFO - 
LIGHT Campaign:
2026-02-13 22:03:30,561 - retention_system - INFO -   Customers: 118
2026-02-13 22:03:30,561 - retention_system - INFO -   Total cost: $1,180.00
2026-02-13 22:03:30,562 - retention_system - INFO -   Expected revenue: $1,438.44
2026-02-13 22:03:30,563 - retention_system - INFO -   Expected value: $258.44
2026-02-13 22:03:30,564 - retention_system - INFO -   Avg churn probability: 34.9%
2026-02-13 22:03:30,564 - retention_system - INFO -   Avg CLV: $318.95
2026-02-13 22:03:30,565 - retention_system - INFO -   Top 5 priorities:
2026-02-13 22:03:30,567 - retention_system - INFO -     1. Customer 17068.0: CLV=$230.14, Churn=32.5%, Value=$4.95
2026-02-13 22:03:30,568 - retention_system - INFO -     2. Customer 13458.0: CLV=$2781.01, Churn=2.7%, Value=$4.83
2026-02-13 22:03:30,568 - retention_system - INFO -     3. Customer 17220.0: CLV=$243.63, Churn=30.2%, Value=$4.73
2026-02-13 22:03:30,568 - retention_system - INFO -     4. Customer 15187.0: CLV=$344.97, Churn=21.2%, Value=$4.63
2026-02-13 22:03:30,569 - retention_system - INFO -     5. Customer 14051.0: CLV=$1601.28, Churn=4.5%, Value=$4.54
2026-02-13 22:03:30,569 - retention_system - INFO - Completed: Execution Plan in 0.03 seconds
2026-02-13 22:03:30,570 - retention_system - INFO - ✓ Task 4.1: Load Predictions - COMPLETE
2026-02-13 22:03:30,571 - retention_system - INFO - ✓ Task 4.2: Expected Value Calculation - COMPLETE
2026-02-13 22:03:30,571 - retention_system - INFO - ✓ Task 4.3: Budget Optimization - COMPLETE
2026-02-13 22:03:30,571 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,571 - retention_system - INFO - PILLAR 4 STATUS: 3/3 TASKS COMPLETE ✓
2026-02-13 22:03:30,572 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,572 - retention_system - INFO - 
🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉
2026-02-13 22:03:30,572 - retention_system - INFO - ENTIRE SYSTEM COMPLETE - ALL 18 TASKS DONE!
2026-02-13 22:03:30,573 - retention_system - INFO - 🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉🎉
2026-02-13 22:03:30,573 - retention_system - INFO - 
Key Results:
2026-02-13 22:03:30,573 - retention_system - INFO -   - Budget: $50,000.00
2026-02-13 22:03:30,573 - retention_system - INFO -   - Customers targeted: 273
2026-02-13 22:03:30,574 - retention_system - INFO -   - Expected revenue saved: $14,498.84
2026-02-13 22:03:30,574 - retention_system - INFO -   - Expected net value: $7,918.84
2026-02-13 22:03:30,574 - retention_system - INFO -   - Portfolio ROI: 120.3%
2026-02-13 22:03:30,575 - retention_system - INFO -   - Customers saved: 41
2026-02-13 22:03:30,575 - retention_system - INFO - 
Campaign breakdown:
2026-02-13 22:03:30,575 - retention_system - INFO -   Premium: 61 customers, $3,050.00 cost, $6,340.71 value
2026-02-13 22:03:30,575 - retention_system - INFO -   Standard: 94 customers, $2,350.00 cost, $1,319.69 value
2026-02-13 22:03:30,576 - retention_system - INFO -   Light: 118 customers, $1,180.00 cost, $258.44 value
2026-02-13 22:03:30,576 - retention_system - INFO - 
Output files created:
2026-02-13 22:03:30,576 - retention_system - INFO -   1. Optimal allocation: outputs\optimal_campaign_allocation.parquet
2026-02-13 22:03:30,577 - retention_system - INFO -   2. Portfolio metrics: outputs\optimization_metrics.json
2026-02-13 22:03:30,577 - retention_system - INFO -   3. Sensitivity analysis: outputs\budget_sensitivity.csv
2026-02-13 22:03:30,577 - retention_system - INFO -   4. Execution plan: outputs\campaign_execution_plan.csv
2026-02-13 22:03:30,577 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,578 - retention_system - INFO - OVERALL PROGRESS: 18/18 TASKS COMPLETE (100%)
2026-02-13 22:03:30,578 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,578 - retention_system - INFO - Pillar 0: ✓ Complete (6/6 tasks) - Data Engineering
2026-02-13 22:03:30,579 - retention_system - INFO - Pillar 1: ✓ Complete (4/4 tasks) - RFM Segmentation
2026-02-13 22:03:30,579 - retention_system - INFO - Pillar 2: ✓ Complete (4/4 tasks) - Churn Prediction
2026-02-13 22:03:30,580 - retention_system - INFO - Pillar 3: ✓ Complete (3/3 tasks) - CLV Prediction
2026-02-13 22:03:30,580 - retention_system - INFO - Pillar 4: ✓ Complete (3/3 tasks) - Revenue Optimization
2026-02-13 22:03:30,581 - retention_system - INFO - 
================================================================================
2026-02-13 22:03:30,581 - retention_system - INFO - SYSTEM READY FOR PRODUCTION!
2026-02-13 22:03:30,582 - retention_system - INFO - ================================================================================
2026-02-13 22:03:30,582 - retention_system - INFO - 
Business Impact:
2026-02-13 22:03:30,583 - retention_system - INFO -   → Baseline churn loss: $52,354.39
2026-02-13 22:03:30,583 - retention_system - INFO -   → With optimization: $7,918.84 net value
2026-02-13 22:03:30,583 - retention_system - INFO -   → ROI: 120.3%
2026-02-13 22:03:30,583 - retention_system - INFO -   → 41 customers saved
2026-02-13 22:03:30,584 - retention_system - INFO - 
Next steps:
2026-02-13 22:03:30,584 - retention_system - INFO -   → Execute campaigns according to execution plan
2026-02-13 22:03:30,584 - retention_system - INFO -   → Monitor actual retention rates vs predicted
2026-02-13 22:03:30,584 - retention_system - INFO -   → A/B test different campaign tiers
2026-02-13 22:03:30,584 - retention_system - INFO -   → Retrain models quarterly with new data
2026-02-13 22:03:30,585 - retention_system - INFO -   → Deploy to production (API, dashboard, automation)
2026-02-13 22:03:30,585 - retention_system - INFO - 
🚀 CONGRATULATIONS! PRODUCTION-GRADE RETENTION SYSTEM COMPLETE! 🚀
